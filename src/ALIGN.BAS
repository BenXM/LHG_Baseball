'$INCLUDE: 'KeyInput.BI'
'$INCLUDE: 'QPProEqu.BI'

_Title "Full Count Baseball - Align Stats"
''$ExeIcon:'./lhg_fcbase.ico'
'_Icon	
_AllowFullScreen

3 CLS

4 DIM B$(23), P$(22), B0%(23, 22), P0%(22, 42), T(22), T1(23)

5 DIM P%(22), B%(23)

6 DIM BR$(23), PR$(22), B0R%(23, 22), P0R%(22, 42), TR(22), TR1(23)

7 DIM PR%(22), BR%(23), S0R%(22, 6), S0N%(22, 6), S0%(22, 6)

8 DIM BN$(23), PN$(22), B0N%(23, 22), P0N%(22, 42), TN(22), TN1(23)

9 DIM PN%(22), BN%(23)

12 COLOR 12, 0: CLS : LOCATE 2, 5: PRINT "ENTER COMPLETE PATH FOR TEAM STATS TO ALIGN"

13 COLOR 15: LOCATE 4, 5: PRINT "EXAMPLE - A:"

14 LOCATE , 5: PRINT "          C:\HAFFNER"

15 LOCATE , 5: PRINT "          C:\HAFFNER\1960"

16 LOCATE , 5: PRINT "          D:\BASEBALL"

20 FOR J = 10 TO 13: LOCATE J

21 PRINT "                                                              ": NEXT

25 COLOR 10: LOCATE 10, 5: LINE INPUT "ROAD STATS:     "; PR$

26 LOCATE , 5: LINE INPUT "CURRENT STATS:  "; PC$

27 COLOR 14: LOCATE 13, 5: PRINT "ANY CHANGE (Y/N)"
28 I$ = GetKeyPress$

29 IF UCASE$(I$) = "Y" THEN 20

45 LOCATE 15, 5: PRINT "                                                       "

46 LOCATE 16, 5: PRINT "                                                       "

47 COLOR 11: LOCATE 15, 5: INPUT "ENTER NAME OF STAT FILE (EX.- MINNESOT.61)"; Z$

50 LOCATE , 5: PRINT "ANY CHANGE (YN)"
60 I$ = GetKeyPress$

70 IF UCASE$(I$) = "Y" THEN 45
	IF LEN(Z$) > 11 THEN Z$ = LEFT$(Z$, 8) + RIGHT$(Z$, 3)

80 LOCATE 18, 5: COLOR 12: PRINT "SEARCHING FOR FILES . . ."

110 IF NOT _FILEEXISTS(PR$ + "\" + Z$) THEN 950

111 CLS
	COLOR 15

120 OPEN PR$ + "\" + Z$ FOR INPUT AS #1

121 INPUT #1, AR$: INPUT #1, W2R%: INPUT #1, L2R%

122 FOR I = 0 TO 22: INPUT #1, BR$(I): INPUT #1, BR%(I): NEXT I

123 FOR I = 0 TO 21: INPUT #1, PR$(I): INPUT #1, PR%(I): NEXT I

124 FOR I = 0 TO 22: FOR I1 = 0 TO 21: INPUT #1, B0R%(I, I1): NEXT I1: NEXT I

125 FOR I = 0 TO 21: FOR I1 = 0 TO 41: INPUT #1, P0R%(I, I1): NEXT I1: NEXT I

126 INPUT #1, DR0%: INPUT #1, DR1%
	FOR I = 0 TO 21: INPUT #1, TR(I): NEXT I
	FOR I = 0 TO 22: INPUT #1, TR1(I): NEXT I

160 CLOSE #1
	IF NOT _FILEEXISTS(PR$ + "\" + Z$ + "R") THEN 210
OPEN PR$ + "\" + Z$ + "R" FOR INPUT AS #1
	FOR I = 0 TO 22
	FOR I1 = 0 TO 6
	INPUT #1, S0R%(I, I1)
	NEXT: NEXT
CLOSE #1

210 IF NOT _FILEEXISTS(PC$ + "\" + Z$) THEN 950

220 OPEN PC$ + "\" + Z$ FOR INPUT AS #1

221 INPUT #1, A$: INPUT #1, W2%: INPUT #1, L2%

222 FOR I = 0 TO 22: INPUT #1, B$(I): INPUT #1, B%(I): NEXT I

223 FOR I = 0 TO 21: INPUT #1, P$(I): INPUT #1, P%(I): NEXT I

224 FOR I = 0 TO 22: FOR I1 = 0 TO 21: INPUT #1, B0%(I, I1): NEXT I1: NEXT I

225 FOR I = 0 TO 21: FOR I1 = 0 TO 41: INPUT #1, P0%(I, I1): NEXT I1: NEXT I

226 INPUT #1, D0%: INPUT #1, D1%
	FOR I = 0 TO 21: INPUT #1, T(I): NEXT I
	FOR I = 0 TO 22: INPUT #1, T1(I): NEXT I

260 CLOSE #1
	IF NOT _FILEEXISTS(PC$ + "\" + Z$ + "R") THEN 400
OPEN PC$ + "\" + Z$ + "R" FOR INPUT AS #1
	FOR I = 0 TO 22
	FOR I1 = 0 TO 6
	INPUT #1, S0%(I, I1)
	NEXT: NEXT
CLOSE #1

400 GOTO 1000

404 N = 0

405 FOR J = 0 TO 22

410 IF UCASE$(B$(N)) = UCASE$(BR$(J)) THEN 420 ELSE 423

420 BN$(N) = BR$(J): BN%(N) = BR%(J)

421 FOR K = 0 TO 21
	B0N%(N, K) = B0R%(J, K)

422 NEXT K
	FOR K = 0 TO 6
	S0N%(N, K) = S0R%(J, K)
	NEXT K

423 NEXT J

424 N = N + 1

425 IF N = 23 GOTO 500 ELSE 405

500 N = 0

505 FOR J = 0 TO 21

510 IF UCASE$(P$(N)) = UCASE$(PR$(J)) THEN 520 ELSE 523

520 PN$(N) = PR$(J): PN%(N) = PR%(J)

521 FOR K = 0 TO 41: P0N%(N, K) = P0R%(J, K)

522 NEXT K

523 NEXT J

524 N = N + 1

525 IF N = 22 GOTO 820 ELSE 505

820 KKK = 1: GOTO 1300

824 OPEN PR$ + "\" + Z$ FOR OUTPUT AS #1

825 WRITE #1, AR$: WRITE #1, W2R%: WRITE #1, L2R%

832 FOR I = 0 TO 22: WRITE #1, BN$(I): WRITE #1, BN%(I): NEXT I

833 FOR I = 0 TO 21: WRITE #1, PN$(I): WRITE #1, PN%(I): NEXT I

834 FOR I = 0 TO 22: FOR I1 = 0 TO 21: WRITE #1, B0N%(I, I1): NEXT I1: NEXT I

835 FOR I = 0 TO 21: FOR I1 = 0 TO 41: WRITE #1, P0N%(I, I1): NEXT I1: NEXT I

836 WRITE #1, DR0%: WRITE #1, DR1%
	FOR I = 0 TO 21: WRITE #1, TR(I): NEXT I
	FOR I = 0 TO 22: WRITE #1, TR1(I): NEXT I

837 CLOSE #1
OPEN PR$ + "\" + Z$ + "R" FOR OUTPUT AS #1
	FOR I = 0 TO 22
	FOR I1 = 0 TO 6
	PRINT #1, S0N%(I, I1)
	NEXT
	NEXT
CLOSE 1

880 CLS : LOCATE 8, 20: PRINT "RE-ALIGNMENT COMPLETED"

881 PRINT : LOCATE 12, 20: COLOR 12: LINE INPUT "HIT ENTER TO CONTINUE"; DUMMY$

900 CLS

910 RUN "MERGE.EXE"

950 CLS : COLOR 15: LOCATE 2, 10: COLOR 7
	PRINT "NON-EXISTANT PATH OR INCORRECT FILE NAME"

951 PRINT
	LOCATE , 10
	PRINT "TRY AGAIN (YN) ";
952 I$ = GetKeyPress$
	IF UCASE$(I$) <> "Y" THEN 900
	PRINT "HIT ENTER TO RE-ENTER INFORMATION"
955 I$ = GetKeyPress$
	GOTO 12

1000 CLS : LOCATE 1, 34: COLOR 12: PRINT "STAT ROSTERS"

1001 LOCATE , 33: COLOR 15: PRINT "CURRENT  "; : COLOR 7: PRINT " ROAD"

1002 FOR I = 0 TO 22: COLOR 12: LOCATE I + 1, 1: PRINT USING "##"; I; : PRINT " "; : COLOR 15: PRINT LEFT$(B$(I), 10); : COLOR 12: PRINT TAB(17); USING "##"; I; : PRINT " "; : COLOR 7: PRINT LEFT$(BR$(I), 10); : NEXT
	FOR I = 0 TO 21: COLOR 12: LOCATE I + 1, 48: PRINT USING "##"; I; : PRINT " "; : COLOR 15: PRINT LEFT$(P$(I), 10); : COLOR 12: PRINT TAB(62); USING "##"; I; : PRINT " "; : COLOR 7: PRINT LEFT$(PR$(I), 10); : NEXT

1003 COLOR 11: LOCATE 7, 33: PRINT "HIT ANY KEY TO"

1004 LOCATE 8, 37: PRINT "ALIGN"
1005 I$ = GetKeyPress$

1006 GOTO 1209

1010 CLS : LOCATE 1, 34: COLOR 12: PRINT "STAT ROSTERS"

1011 LOCATE , 33: COLOR 15: PRINT "CURRENT  "; : COLOR 7: PRINT " ROAD"

1012 FOR I = 0 TO 22: COLOR 12: LOCATE I + 1, 1: PRINT USING "##"; I; : PRINT " "; : COLOR 15: PRINT LEFT$(B$(I), 10); : COLOR 12: PRINT TAB(17); USING "##"; I; : PRINT " "; : COLOR 7: PRINT LEFT$(BN$(I), 10); : NEXT
	FOR I = 0 TO 21: COLOR 12: LOCATE I + 1, 48: PRINT USING "##"; I; : PRINT " "; : COLOR 15: PRINT LEFT$(P$(I), 10); : COLOR 12: PRINT TAB(62); USING "##"; I; : PRINT " "; : COLOR 7: PRINT LEFT$(PN$(I), 10); : NEXT

1013 COLOR 11: LOCATE 7, 33: PRINT "HIT ANY KEY TO"

1014 LOCATE 8, 36: PRINT "CONTINUE"
1015 I$ = GetKeyPress$

1016 GOTO 822

1209 COLOR 11: LOCATE 7, 33: PRINT "ALIGNING FILES"

1210 LOCATE 8, 37: PRINT "       "

1211 GOTO 404

1300 SEQ = 0

1301 FOR J = 0 TO 22

1303 IF UCASE$(BN$(J)) = UCASE$(B$(J)) THEN 1309 ELSE 1304

1304 SEQ = SEQ + 1

1309 NEXT J

1310 FOR J = 0 TO 21

1312 IF UCASE$(PN$(J)) = UCASE$(P$(J)) THEN 1319 ELSE 1314

1314 SEQ = SEQ + 1

1319 NEXT J

1320 IF SEQ = 0 THEN 1010 ELSE 1400

1400 CLS : LOCATE 5: COLOR 14: PRINT "WARNING !! - - ROAD STAT FILE CONTAINS PLAYERS NOT IN EXISTING STATS.  YOU MUST"

1402 PRINT "CHANGE ROAD STAT FILE USING OPTION #6 ON GAME MENU BEFORE ATTEMPTING STAT MERGE."

1405 LOCATE 23, 30: COLOR 13: LINE INPUT "HIT ENTER TO CONTINUE"; DUMMY$

1406 GOTO 900

'$INCLUDE: 'KeyInput.BM'
'$INCLUDE: 'QPProEqu.BM'
