'------------------------------
'       SOURCE Subroutine
'------------------------------
' ...explanation...
Sub SOURCE ()

    'Declare all variables for the modules
    Dim F1$(10)
    Dim CZ%(0 To 1), PH%(0 To 22, 0 To 1)

    Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)
    If usingGfx = 1 Then Call LOADSCREEN

    15000 '
    F% = 0
    PQ = 0

    For I = 0 To 1: O%(I) = 0: Next I

    L0%(P) = L0%(P) + MO
    MO = 0
    H0% = 0

    For I = 1 To 3
        For I1 = 0 To 1
            B0%(I, I1) = 0: B1%(I, I1) = 0
        Next I1
        B0%(I, 2) = 0
    Next I

    S4% = 0

    If P = 1 Then INNING% = INNING% + 1: CZ%(0) = 0: CZ%(1) = 0

    P = 1 - P: D = 1 - P

    If INNING% = 7 And L%(1, 13) = 8 And P = 1 And Val(Left$(A$(1), 2)) > 75 Then
        Call WINDEX
        Call PBP("ALL RIGHT..."): Call PBP("LEMME HEAR YA..."): Call PBP("A ONE, A TWO...")
    End If

    15004 If INNING% > 9 And D = 1 And S6%(1, 0) <> S6%(0, 0) Or INNING% = 28 Or INNING% >= 9 And P = 1 And S6%(P, 0) - S6%(D, 0) > 0 Then 18500
    If RD = 1 And INNING% >= RE And RE >= 6 And (S6%(1, 0) > S6%(0, 0) And P = 1 Or S6%(0, 0) > S6%(1, 0) And P = 0) Then
        Cls
        If usingGfx = 0 Then Screen 0
        Print "THIS GAME HAS BEEN CALLED ON ACCOUNT OF RAIN!!!"
        Print "ALL RECORDS ARE OFFICIAL!!"
        Locate 24, 1: Print "HIT ANY KEY TO CONTINUE";
        I$ = GetKeyPress$
        GoTo 18500
    End If

    If RD = 1 And P = 0 And INNING% = 4 Then
        Call PBP("THE RAIN IS FALLING A LITTLE MORE STEADILY")
        Call PBP("THIS GAME MAY NOT GO 9!")
        I$ = GetKeyPress$
    End If

    If usingGfx = 1 Then
        Call FLDDISP_G(BC%, P, U%, D)
    Else
        Call FLDDISP(BC%, P, U%, D)
    End If

    For IJ0% = 0 To 22

        If B%(D, IJ0%, 21) > 39 And B%(D, IJ0%, 21) <= 49 Then

            14950 I1 = IJ0%
            I2 = B%(D, IJ0%, 21) - 40

            '14952
            B%(D, I1, 21) = 1
            B3%(D, I2) = I1
            B9%(D, B7%(D, I2)) = I1

            D0%(D) = D0%(D) + 1: X0%(D, 0, D0%(D)) = B3%(D, I2)
            X0%(D, 1, D0%(D)) = B7%(D, I2): X0%(D, 2, D0%(D)) = (I2 * 10) + (D0%(D) - 9)
            W5 = D: W6 = D: VV(D) = I2: VV1(D) = I2

            For xx = 22 To 25
                If B7%(D, I2) = B%(D, I1, xx) Then B%(D, I1, 15) = B%(D, I1, 33 + (xx - 22) * 2): B%(D, I1, 17) = B%(D, I1, 34 + (xx - 22) * 2): B%(D, I1, 19) = B%(D, I1, xx + 4): Exit For
            Next

            '14955  ---> this is it's own routine used often
            Call HITTINGLINES '(l%(), p%(), P1%(), B7%(), b%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)

            If usingGfx = 1 Then
                Call FLDDISP_G(BC%, P, U%, D)
                Call MAINSCREEN_G(D, P, BC%, U%, MO)
            Else
                Call FLDDISP(BC%, P, U%, D)
                Call MAINSCREEN(D, P, BC%, U%, MO)
            End If

            VV(D) = 1
            VV1(D) = 9

        End If

    Next

    A1 = S6%(D, 0) - S6%(P, 0)

    If MG%(D, 560) <> 999 Or INNING% < 8 Or U6 = 0 Or U6 = 1 And P = U9 Then 15025

    For IJ0% = 1 To 4

        If MG%(D, 560 + IJ0%) = -1 Or B%(D, MG%(D, 564 + IJ0%), 21) <> 0 Then 15010

        Call d100(RN)

        If B9%(D, MG%(D, 576 + IJ0%)) = MG%(D, 560 + IJ0%) And RN <= MG%(D, 568 + IJ0%) And A1 >= MG%(D, 572 + IJ0%) Then

            I1 = MG%(D, 564 + IJ0%)

            For I2 = 1 To 9
                If B7%(D, I2) = MG%(D, 576 + IJ0%) Then Exit For
            Next

            '14952
            B%(D, I1, 21) = 1
            B3%(D, I2) = I1
            B9%(D, B7%(D, I2)) = I1

            D0%(D) = D0%(D) + 1: X0%(D, 0, D0%(D)) = B3%(D, I2)
            X0%(D, 1, D0%(D)) = B7%(D, I2): X0%(D, 2, D0%(D)) = (I2 * 10) + (D0%(D) - 9)
            W5 = D: W6 = D: VV(D) = I2: VV1(D) = I2

            For xx = 22 To 25
                If B7%(D, I2) = B%(D, I1, xx) Then B%(D, I1, 15) = B%(D, I1, 33 + (xx - 22) * 2): B%(D, I1, 17) = B%(D, I1, 34 + (xx - 22) * 2): B%(D, I1, 19) = B%(D, I1, xx + 4): Exit For
            Next

            '14955
            Call HITTINGLINES '(l%(), p%(), P1%(), B7%(), b%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)

            If usingGfx = 1 Then
                Call FLDDISP_G(BC%, P, U%, D)
                Call MAINSCREEN_G(D, P, BC%, U%, MO)
            Else
                Call FLDDISP(BC%, P, U%, D)
                Call MAINSCREEN(D, P, BC%, U%, MO)
            End If

            VV(D) = 1
            VV1(D) = 9

        End If

    15010 Next

    15025 If B9%(D, 1) = 99 And U6 = 0 Or B9%(D, 1) = 99 And U6 = 1 And U9 = 1 - D Then 14900

    15050 SH = 0: F% = 0: PQ = 0: SO = 0
    B1!(P) = B1!(P) + 1: INFPOS% = 0: U% = 0
    If B1!(P) = 10 Then B1!(P) = 1

    '--- Start of a new sub
    15051 Call WHOSON1ST(S4%)
    Call PLAYERNAME(P)
    If usingGfx = 1 Then
        Call MAINSCREEN_G(D, P, BC%, U%, MO)
    Else
        Call MAINSCREEN(D, P, BC%, U%, MO)
    End If

    P2 = 0
    D2 = 0

    If INNING% >= 9 And P = 1 And S6%(P, 0) - S6%(D, 0) > 0 Then 18500

    15052 '
    If usingGfx = 1 Then
        _PutImage (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 128), backupScreen&, imageScreen&, (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 128)
    Else
        Color 14, 0
    End If

    I2 = INNING%

    '-- This is the variable "I" that is used
    '-- later for my crashing code???
    '-- it essentially should be 0/1 to represent
    '-- home / visitor team, respectively
    I = P

    If S%(P, INNING%) > 0 Then
        If usingGfx = 1 Then
            Call INNDISP_G(I2, I)
        Else
            Call INNDISP(I2, I)
        End If
    End If

    If usingGfx = 1 Then

        'Print #9, "Calling gfx print from ~15052; usingGfx = "; Str$(usingGfx)

        FORMATTED$ = FUsing$(Str$(S6%(I, 0)), "##", 1)
        PrintOnGfx 53, I + 28, FORMATTED$, imageScreen&

        FORMATTED$ = FUsing$(Str$(S6%(D, 2)), "##", 1)
        PrintOnGfx 59, 1 - I + 28, FORMATTED$, imageScreen&

    Else

        Locate , 40
        Print Using "##"; S6%(I, 0);: Locate D + 2
        Locate , 46: Print Using "##"; S6%(D, 2);
        Color 15, 0

    End If

    Z2% = B0%(2, 0)
    F% = 0
    PQ = 0

    15080 If U6 = 2 Or U6 = 1 And P <> U9 Then 18700
    If S4% = 1 Or S4% = 5 Then
        H0% = 1
        If usingGfx = 1 Then
            Call HOLDSTATUS_G(H0%)
        Else
            Call HOLDSTATUS(H0%)
        End If
    End If

    15081
    F$ = PadRight$(Left$(A$(D), 3) + NN$(D), 8)

    Call WINDEX

    If usingGfx = 1 Then

        'Printing black on background
        _PrintMode _KeepBackground , imageScreen&
        Color 4278190080

        'Print #9, "Calling gfx print from ~15081; usingGfx = "; Str$(usingGfx)
        PrintOnGfx 1, 19, F$, imageScreen&

        F1$(1) = "1-PITCH       "
        F1$(2) = "2-INT WALK    "
        F1$(3) = "3-INF IN      "
        F1$(4) = "4-CORNERS IN  "
        F1$(5) = "5-INF NORMAL  "
        F1$(6) = "6-PERSONNEL   "
        F1$(7) = "8-PITCH AROUND"
        F1$(8) = "G-GUARD LINES "
        F1$(9) = "H-HOLD RUNNER "
        F1$(10) = "S/D/B/P STATS "

        For I = 21 To 30
            PrintOnGfx 1, I - 1, F1$(I - 20), imageScreen&
        Next

    Else

        Color 14, 0: Print F$

        Print " 1-PITCH          D-DETAILED STATS      "
        Print " 2-INTENTIONAL BB S-BATTER/PITCHER STATS"
        Print " 3-INFIELD IN     H-HOLD RUNNER"
        Print " 4-CORNERS IN     Q-QUIT GAME"
        Print " 5-INFIELD NORMAL W-WEATHER CONDITIONS"
        Print " 6-PERSONNEL      G-GUARD LINES"
        Print " 7-PITCH/HIT AWAY O-GAME OPTIONS"
        Print " 8-PITCH AROUND"
        Color 15, 0

    End If

    15090 I$ = GetKeyPress$

    If usingGfx = 1 Then _PutImage (1 * FontColAdj%, 304)-Step(14 * FontColAdj%, 176), backupScreen&, imageScreen&, (1 * FontColAdj%, 304)-Step(14 * FontColAdj%, 176)

    If UCase$(I$) = "D" Then Call VIEWTEAM: GoTo 15580
    If UCase$(I$) = "G" Then

        INFPOS% = 3

        If usingGfx = 1 Then
            F$ = "INF:GUARD LINE"
            _PutImage (52 * FontColAdj%, 416)-Step(14 * FontColAdj%, 16), backupScreen&, imageScreen&, (52 * FontColAdj%, 416)-Step(14 * FontColAdj%, 16)

            'Printing black on background
            _PrintMode _KeepBackground , imageScreen&
            Color 4278190080

            'Print #9, "Calling gfx print from ~15090; usingGfx = "; Str$(usingGfx)
            PrintOnGfx 52, 26, F$, imageScreen&

            'Printing white on black
            Color 4294967295
            _PrintMode _FillBackground , imageScreen&
        Else
            Color 15, 2
            Locate 23, 46: Print "GUARD LINE"
        End If

        GoTo 15052

    End If

    If UCase$(I$) = "L" Then Call POPUP: GoTo 15580
    If UCase$(I$) = "O" Then
        Call OPTIONS
        GoTo 15580
    End If
    If UCase$(I$) = "Q" Then
        If usingGfx = 0 Then Cls
        Call EndOfGame
        End
    End If
    If UCase$(I$) = "S" Then Call POPUPSTATS: GoTo 15580
    If UCase$(I$) = "W" Then
        Call WEATHER
        GoTo 15580
    End If

    If UCase$(I$) = "H" Then
        H0% = 1 - H0%
        If usingGfx = 1 Then
            Call HOLDSTATUS_G(H0%)
        Else
            Call HOLDSTATUS(H0%)
        End If
        GoTo 15081
    End If
    If Val(I$) = 7 Then P2 = 1: D2 = 1: GoTo 13050

    15054 D2 = Val(I$)
    If D2 < 1 Or D2 > 9 Then 15052

    15055 '
    If D2 = 3 Then INFPOS% = 2: infStatus$ = "INF:INFIELD IN"
    If D2 = 4 Then INFPOS% = 1: infStatus$ = "INF:CORNERS IN"
    If D2 = 5 Then INFPOS% = 0: infStatus$ = "INF:NORMAL    "

    'This is only here because we've assigned the text,
    'now we have to print it on the screen
    If D2 = 3 Or D2 = 4 Or D2 = 5 Then

        If usingGfx = 1 Then
            _PutImage (51 * FontColAdj%, 416)-Step(14 * FontColAdj%, 16), backupScreen&, imageScreen&, (51 * FontColAdj%, 416)-Step(14 * FontColAdj%, 16)

            'Printing black on background
            _PrintMode _KeepBackground , imageScreen&
            Color 4278190080

            'Print #9, "Calling gfx print from ~15055; usingGfx = "; Str$(usingGfx)
            'Print infield status
            PrintOnGfx 52, 26, infStatus$, imageScreen&

            'Printing white on black
            Color 4294967295
            _PrintMode _FillBackground , imageScreen&
        Else
            Color 15, 2
            Locate 23, 46: Print infStatus$
        End If

        GoTo 15052

    End If

    15058 If D2 = 2 Then
        Call WINDEX
        '13240 / *** base on balls ***
        Call BASEONBALLS(S2%, D2, D, P)
        GoTo 13201
    End If

    If D2 = 6 Then P9 = D: W5 = -1: W6 = -1: GoTo 15500

    15085 If U6 = 2 Or U6 = 1 And P = U9 Then 18900
    Call WINDEX

    F$ = PadRight$(Left$(A$(P), 3) + NN$(P), 8)

    If usingGfx = 1 Then
        'Printing black on background
        _PrintMode _KeepBackground , imageScreen&
        Color 4278190080

        'Print #9, "Calling gfx print from ~15085; usingGfx = "; Str$(usingGfx)
        PrintOnGfx 1, 19, F$, imageScreen&

        F1$(1) = "1-HIT AWAY    "
        F1$(2) = "2-HIT AND RUN "
        F1$(3) = "3-STEAL       "
        F1$(4) = "4-BUNT        "
        F1$(5) = "5-PERSONNEL   "
        F1$(6) = "O-GAME OPTIONS"
        F1$(7) = "D/S/P/B STATS "
        F1$(8) = "W-WEATHER COND"
        F1$(9) = "L-SHOW LINEUPS"
        F1$(10) = "Q-QUIT GAME   "

        For I = 21 To 30
            PrintOnGfx 1, I - 1, F1$(I - 20), imageScreen&
        Next

        'Printing white on black
        Color 4294967295
        _PrintMode _FillBackground , imageScreen&
    Else
        Color 14, 0: Print A$(P); " SELECT:"
        Print " 1- HIT AWAY      D-DETAILED STATS"
        Print " 2- HIT AND RUN   S-BATTER/PITCHER STATS"
        Print " 3- STEAL         L-DISPLAY LINEUPS"
        Print " 4- BUNT          Q-QUIT GAME"
        Print " 5- PERSONNEL     W-WEATHER CONDITIONS"
        Color 15, 0
    End If

    15061 I$ = GetKeyPress$

    _PutImage (1 * FontColAdj%, 304)-Step(14 * FontColAdj%, 176), backupScreen&, imageScreen&, (1 * FontColAdj%, 304)-Step(14 * FontColAdj%, 176)

    If UCase$(I$) = "D" Then Call VIEWTEAM: GoTo 15580
    If UCase$(I$) = "L" Then Call POPUP: GoTo 15580
    If UCase$(I$) = "O" Then
        Call OPTIONS
        GoTo 15580
    End If
    If UCase$(I$) = "Q" Then
        If usingGfx = 0 Then Cls
        Call EndOfGame
        End
    End If
    If UCase$(I$) = "S" Then Call POPUPSTATS: GoTo 15580
    If UCase$(I$) = "W" Then
        Call WEATHER
        GoTo 15580
    End If

    P2 = Val(I$)
    If P2 < 1 Or P2 > 5 Then 15085

    15064 If P2 = 5 Then P9 = P: W5 = -1: W6 = -1: GoTo 15500
    If P2 = 3 Then 14800
    If P2 = 2 And O%(0) = 2 Or P2 = 2 And S4% <> 1 And S4% <> 4 And S4% <> 5 Then 15051

    15067 '
    If P2 <> 2 Then
        If D2 <> 8 Then 13050
        Call WINDEX
        Call d100(RN)
        If P2 = 4 Or RN <= 50 And P2 = 1 Then 13050
        '13240 / *** base on balls ***
        Call BASEONBALLS(S2%, D2, D, P)
        GoTo 13201
    End If

    If S4% = 4 Then I = 3 Else I = 2
    I3 = Int(Rnd(1) * 100) + 1
    If I3 >= 6 Then 15068
    Call PICKEDOFF(D, I)

    PO = 1
    A5%(I - 1) = 10
    O%(0) = O%(0) + 1
    O%(1) = O%(1) + 1
    W% = 1

    Call CREDITASSIST(W%, D)
    Call ADVANCEMENT(P, D, S2%, F%, I3)
    Call CREDITPUTOUT(I3, FB2P%, AST%, D)

    I5 = P1%(D)
    I6 = 0
    Call ADDPIT(D, I5, I6)

    If O%(0) >= 3 Then B1!(P) = B1!(P) - 1: PO = 0: GoTo 13900

    15068 If PO = 1 Then PO = 0: GoTo 15051
    Call WINDEX

    I3 = Int(Rnd(1) * 1000) + 1
    I9 = Int(Rnd(1) * 1000) + 1

    If I3 > 350 Then
        Call PBP("Runner(s) going")
    Else
        Call PBP("Count not favorable...hit away")
        P2 = 1
    End If

    Call DELAY

    If I3 <= 350 Then 13050
    If I9 <= (B4%(P, 4, B1!(P)) * 2 * .33) Then U% = U% + 1: Call PBP(Q$(0) + " swings and misses"): Call DELAY: If U% = 3 Then GoTo 13601 Else GoTo 14800
    If I9 <= B4%(P, 4, B1!(P)) * 2 Then Call PBP(Q$(0) + " fouls off the pitch...hit away"): Call DELAY: P2 = 1
    GoTo 13050


    '--- end of a new sub


    12000 ' BRANCH FOR RARE PLAYS
    Call RAREPLAYS(H6%, H7%, IP%)

    If IP% = 1 Then IP% = 0: Call RELIEVERS

    If H6% <= 4 Or H6% > 5 And H6% < 9 Or H6% >= 10 And H6% <= 24 Then
        GoSub 12002
        GoTo 15052
    End If

    'what is the reason for sub 12002???

    If H6% = 5 Or H6% >= 25 And H6% <= 29 Then GoSub 12002: GoTo 13900

    If H6% = 9 Then
        GoSub 12002
        '13240 / *** base on balls ***
        Call BASEONBALLS(S2%, D2, D, P)
        GoTo 13201
    End If

    If H6% = 45 Then GoSub 12002: GoTo 13201

    GoSub 12002

    GoTo 15052

    '    Print "RARE PLAY "; H6%; " NO PLACE TO GO"

    '-----


    12002 Call HITTINGLINES '(l%(), p%(), P1%(), B7%(), b%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)

    If usingGfx = 1 Then
        Call FLDDISP_G(BC%, P, U%, D)
        Call MAINSCREEN_G(D, P, BC%, U%, MO)
    Else
        Call FLDDISP(BC%, P, U%, D)
        Call MAINSCREEN(D, P, BC%, U%, MO)
    End If

    Return


    '================================================================================
    ' Below are all the different GoTo branches for the gameplay
    ' These have not yet been worked out into a different flow
    ' yet for the game's logic.
    '================================================================================


    13050 Call d100(RN)

    If (((PC% = 1 Or PC% = 2 Or PC% = 3) And RN = 2) Or (RD = 1 And RN <= 5)) And INNING% >= 2 And RD% = 0 Then
        H7% = 20
        H6% = 21
        GoTo 12000
    Else
        H6% = Int(Rnd(1) * 11000) + 1
    End If

    If H6% <= 3 And IJ% = 0 Then 12000

    SN = 0
    H6% = Int(Rnd(1) * 1000) + 1

    If O%(0) = 0 And S4% = 4 And INFPOS% < 2 And H6% = 768 Or O%(0) = 0 And S4% = 4 And INFPOS% < 2 And H6% = 123 Or O%(0) = 0 And S4% = 7 And INFPOS% < 2 And H6% = 245 Or O%(0) = 0 And S4% = 7 And INFPOS% < 2 And H6% = 381 Then Call TRIPLEPLAY(D): GoTo 13900

    H7% = Int(Rnd(1) * 7500) + 1

    Call WINDEX

    If H6% <= 4 Then
        13200 ' *** hit by pitch ***
        Call HITBYPITCH(S2%, D)

        13201 A5%(0) = 1: A5%(1) = 0: A5%(2) = 0: A5%(3) = 0
        If B0%(1, 0) > 0 Then A5%(1) = 1
        If B0%(1, 0) > 0 And B0%(2, 0) > 0 Then A5%(2) = 1
        If B0%(1, 0) > 0 And B0%(2, 0) > 0 And B0%(3, 0) > 0 Then A5%(3) = 1: If W% = 2 And S2% > 2 Then A5%(3) = 11
        Call ADVANCEMENT(P, D, S2%, F%, I3)
        GoTo 15050
    End If

    If H6% <= 6 Then
        13210 ' *** balk ***
        If S4% = 0 Then
            '13100 / *** fouled out of play ***
            Call FOULBALL
            GoTo 15052
        End If

        S2% = 4

        Call WINDEX

        Call d100(RN)
        UN = Int(Rnd(1) * 4) + 1
        If RN <= 33 Then F$ = "a balk has been called"
        If RN > 33 And RN <= 66 Then Call PBP("and a BALK is called"): F$ = P$(D, P1%(D)) + " dropped the ball"
        If RN > 66 Then F$ = U$(UN) + " calls a balk on " + P$(D, P1%(D))
        Call PBP(F$)

        GoTo 13223
    End If

    If H6% <= 11 Or H6% <= 200 And B%(D, B9%(D, 2), 22) <> 2 And B%(D, B9%(D, 2), 23) <> 2 And B%(D, B9%(D, 2), 24) <> 2 And B%(D, B9%(D, 2), 25) <> 2 Then
        13220 ' *** passed ball ***
        If S4% = 0 And SO <> 1 Then
            '13100 / *** fouled out of play ***
            Call FOULBALL
            GoTo 15052
        End If

        S2% = 5
        Call WINDEX
        Call DELIVERY(D)
        Call d100(RN)
        If RN <= 50 Then Call PBP("pitch gets by " + B$(D, B9%(D, 2)))
        If RN > 50 Then Call PBP("off " + B$(D, B9%(D, 2)) + "'s glove"): Call PBP("it gets away from him")
        Call PBP("It's ruled a passed ball")
        If B0%(1, 0) = 0 And I = 9 And SO = 1 Or O%(0) > 1 And I = 9 And SO = 1 Then O%(1) = O%(1) + 1

        13222 I8 = Int(Rnd(1) * 10) + 1
        If S4% = 1 And P2 = 2 And I8 < B%(P, B3%(P, B0%(1, 0)), 16) Or S4% = 5 And P2 = 2 And I8 < B%(P, B3%(P, B0%(1, 0)), 16) Then
            A5%(1) = 2
            A5%(3) = 1
            A5%(0) = 0
            A5%(2) = 2
            Call ADVANCEMENT(P, D, S2%, F%, I3)
            GoTo 15051
        End If

        13223 If B0%(1, 0) = 0 And I = 9 And SO = 1 Or O%(0) > 1 And I = 9 And SO = 1 Then
            A5%(0) = 1
            A5%(1) = 1
            A5%(2) = 1
            A5%(3) = 1
            Call ADVANCEMENT(P, D, S2%, F%, I3)
            GoTo 13900
        End If

        A5%(1) = 1
        A5%(2) = 1
        A5%(3) = 1
        A5%(0) = 0
        Call ADVANCEMENT(P, D, S2%, F%, I3)
        GoTo 15051

    End If

    If H6% <= 19 Then
        '13230 / *** wild pitch ***
        If S4% = 0 And SO <> 1 Then
            '13100 / *** fouled out of play ***
            Call FOULBALL
            GoTo 15052
        End If

        Call WILDPITCH(S2%, D)

        GoTo 13222
    End If

    If H7% = 27 Then
        13244 '
        S2% = 2
        Call WINDEX
        Call PBP(B$(D, B9%(D, 2)) + " is called for interference!!")
        Call PBP(Q$(0) + " trots to first base")
        GoTo 13201
    End If

    If H7% = 28 Then

        Call WINDEX
        Call PBP(Q$(0) + " is out for obstruction!")
        W% = 2
        Call CREDITREGPO(W%, D)
        O%(0) = O%(0) + 1
        O%(1) = O%(1) + 1

        If B7%(P, B1!(P)) <> 1 Then
            I5 = B3%(P, B1!(P))
            I6 = 0
            Call INCBATOFF(P, I5, I6)
        Else
            I5 = P1%(P)
            I6 = 23
            Call INCPITOFF(P, I5, I6)
        End If

        13248 '
        I5 = P1%(D)
        I6 = 0

        Call ADDPIT(D, I5, I6)

        GoTo 13900
    End If

    If H6% <= B4%(P, 5, B1!(P)) + 25 Then
        S2% = 2
        '13240 / *** base on balls ***
        Call BASEONBALLS(S2%, D2, D, P)
        GoTo 13201
    End If

    If P2 = 4 Then 14100

    13056 '
    H6% = Int(Rnd(1) * 1000) + 1
    H7% = Int(Rnd(1) * 1000) + 1
    I4 = 0

    If P2 = 2 Then I4 = -5
    If INFPOS% = 2 Then SN = 70: I4 = I4 + 15
    If U% = 2 Then I4 = I4 - 15
    If INFPOS% = 1 Then SN = 20
    If INNING% > 5 And S8%(D, 0) <= P8%(D, P1%(D), 4) + P8%(D, P1%(D), 1) And S8%(D, 1) <= P8%(D, P1%(D), 2) Then I4 = I4 + 40

    If P = 0 Then I4 = I4 - 2
    If P = 1 Then I4 = I4 + 2

    'Why do we not do blank lines here???

    If H7% <= SN Then Call PBP("It gets through the drawn-in infield!"): Call DELAY: GoTo 13063
    If H6% > B4%(P, 0, B1!(P)) + I4 Then 13600

    H6% = Int(Rnd(1) * 1000) + 1

    If H6% <= B4%(P, 1, B1!(P)) And P2 <> 2 Or H6% <= B4%(P, 1, B1!(P)) * .5 And P2 = 2 Then
        S2% = 8

        13500 ' *** double s2%=8 ***
        Call GETOUTFIELDER(W%, P, I1, D)

        I5 = P1%(D)
        I6 = 1

        Call ADDPIT(D, I5, I6)
        Call WINDEX
        Call DELIVERY(D)

        If B7%(P, B1!(P)) <> 1 Then
            I5 = B3%(P, B1!(P)): I6 = 0
            Call INCBATOFF(P, I5, I6)
            I6 = 1
            Call INCBATOFF(P, I5, I6)
            I6 = 4
            Call INCBATOFF(P, I5, I6)
        Else
            I5 = P1%(P): I6 = 23
            Call INCPITOFF(P, I5, I6)
            I6 = 24
            Call INCPITOFF(P, I5, I6)
            I6 = 27
            Call INCPITOFF(P, I5, I6)
        End If

        Call d100(RN)
        If RN <= 40 And W% = 7 Then
            Y% = Int(Rnd(1) * 40) + 2900
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)

            Y% = Int(Rnd(1) * 30) + 3020
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)
            GoTo 13502
        End If

        If RN <= 40 And W% = 9 Then
            Y% = Int(Rnd(1) * 40) + 2940
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)

            Y% = Int(Rnd(1) * 30) + 3020
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)
            GoTo 13502
        End If

        If RN <= 40 And W% = 8 Then
            Y% = Int(Rnd(1) * 40) + 2980
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)

            Y% = Int(Rnd(1) * 30) + 3020
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)
            GoTo 13502
        End If

        Call d100(RN)
        If RN <= 25 Then
            Call LONGFLY(D, W%)
            HW% = 1
            Call WALLDOUBLE(HW%, W%)
            GoTo 13502
        End If
        If RN > 25 And RN <= 50 Then
            Call LDRIVE
            Call PBP(Q$(0) + "one to the gap in " + OUTFLDLOCATION$(W%))
            GoTo 13502
        End If
        If RN > 50 And RN <= 60 Then
            Call PBP(Q$(0) + " hits a sinking liner into " + OUTFLDLOCATION$(W%))
            Call PBP("It goes to the wall")
            GoTo 13502
        End If
        If RN > 60 And RN <= 75 Then
            Call PBP(Q$(0) + " lines one to the alley in " + OUTFLDLOCATION$(W%))
            GoTo 13502
        End If
        If RN > 75 And RN <= 85 And (W% = 7 Or W% = 9) Then
            Call LDRIVE
            Call PBP(Q$(0) + "one down the " + C$(W%) + " line")
            Call PBP("It rolls into the corner")
            GoTo 13502
        End If
        If RN > 75 And RN <= 85 And W% = 8 Then
            Call LDRIVE
            Call PBP(Q$(0) + "one between the fielders")
            Call PBP(Q$(4) + " cuts it off...")
            GoTo 13502
        End If
        If RN > 85 And RN <= 92 Then
            Call LDRIVE
            Call PBP(Q$(0) + "a blue darter into " + C$(W%))
            GoTo 13502
        End If
        If RN > 92 Then
            Call PBP(Q$(0) + " lines one to " + OUTFLDLOCATION$(W%))
            Call PBP("It's down and to the wall!")
        End If

        13502 HW% = 0
        If Int(Rnd(1) * 100) + 1 <= 80 Then
            F$ = "Double!!"
        Else
            F$ = "2-Bagger!!"
        End If

        Call PBP(F$)

        For I = 0 To 3: A5%(I) = 2: Next I

        A5%(3) = 1

        If B0%(1, 0) <> 0 Then

            H6% = Int(Rnd(1) * 100) + 1
            BR% = B%(P, B3%(P, B0%(1, 0)), 16)

            If B7%(P, B0%(1, 0)) = 1 Then BR% = P%(P, P1%(P), 31)

            I3 = 0
            If O%(0) = 0 And W% = 7 Then I3 = 18 + BR% * 3
            If O%(0) = 1 And W% = 7 Then I3 = 16 + BR% * 3
            If O%(0) = 2 And W% = 7 Then I3 = 34 + BR% * 3
            If O%(0) = 0 And W% = 8 Then I3 = 37 + BR% * 3
            If O%(0) = 1 And W% = 8 Then I3 = 44 + BR% * 3
            If O%(0) = 2 And W% = 8 Then I3 = 65 + BR% * 3
            If O%(0) = 0 And W% = 9 Then I3 = 12 + BR% * 3
            If O%(0) = 1 And W% = 9 Then I3 = 18 + BR% * 3
            If O%(0) = 2 And W% = 9 Then I3 = 40 + BR% * 3
            If H6% <= I3 Or P2 = 2 Then A5%(1) = 3

        End If

        13511 Call ADVANCEMENT(P, D, S2%, F%, I3)
        F% = 0
        Call FLDERR(F%, W%, D, I3, SB%, S2%, P)

        If F% = 0 Then Call TRYFOREXTRABASE(LN%, S2%, P2, Z2%, D, W%, SAH%, SB%, I8, I9)
        Call SCOREBOARD

        GoTo 13900

    End If

    If H6% <= B4%(P, 1, B1!(P)) + B4%(P, 2, B1!(P)) And P2 <> 2 Or H6% <= B4%(P, 1, B1!(P)) * .5 + B4%(P, 2, B1!(P)) * .5 And P2 = 2 Then

        S2% = 9

        13520 ' *** TRIPLE S2%=9 ***
        Call OUTFLDNAME(W%, D)
        Call DELIVERY(D)
        Call WINDEX

        If B7%(P, B1!(P)) <> 1 Then
            I5 = B3%(P, B1!(P))
            I6 = 0
            Call INCBATOFF(P, I5, I6)
            I6 = 1
            Call INCBATOFF(P, I5, I6)
            I6 = 5
            Call INCBATOFF(P, I5, I6)
        Else
            I5 = P1%(P)
            I6 = 23
            Call INCPITOFF(P, I5, I6)
            I6 = 24
            Call INCPITOFF(P, I5, I6)
            I6 = 28
            Call INCPITOFF(P, I5, I6)
        End If

        13522 '
        I5 = P1%(D)
        I6 = 1

        Call ADDPIT(D, I5, I6)

        Call d100(RN)
        If RN <= 30 And W% = 7 Then
            Y% = Int(Rnd(1) * 40) + 2900
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)

            Y% = Int(Rnd(1) * 40) + 3050
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)
            GoTo 13524
        End If

        If RN <= 30 And W% = 9 Then
            Y% = Int(Rnd(1) * 40) + 2940
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)

            Y% = Int(Rnd(1) * 40) + 3050
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)
            GoTo 13524
        End If

        If RN <= 30 And W% = 8 Then
            Y% = Int(Rnd(1) * 40) + 2980
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)

            Y% = Int(Rnd(1) * 40) + 3050
            'Print #9, "Calling PBP from SOURCE, index "; Y%
            Call GETRPBP(Y%, Y$, D)
            Call STRIPRPBP(Y$, Y%, D)
            Call PBP(Y$)
            GoTo 13524
        End If

        Call d100(RN)

        If RN <= 10 And W% <> 8 Then
            13570 '
            Call d100(RN)
            X$ = "1st"
            If W% = 7 Then X$ = "3rd"

            If RN <= 50 Then
                Call PBP(Q$(0) + " hits a hot smash")
            Else
                Call PBP(Q$(0) + " lines one")
            End If

            Call PBP("Fair past " + X$ + "!!")
            Call PBP("It rolls into the " + C$(W%) + " corner")
            Call PBP("It's a triple!!")

            GoTo 13525
            'If we replace this with code at 13525 we need to make sure to go to 13900

        End If

        Call LONGFLY(D, W%)
        ad$ = "wall"
        If W% = 7 And L%(1, 13) = 27 Then ad$ = "screen"
        bv = Int(Rnd(1) * 100) + 1

        Call d100(RN)
        If RN <= 20 Then F$ = "It one-hops the " + ad$ + "..."
        If RN <= 40 And RN > 20 Then F$ = "It's off the top of the " + ad$ + "..."
        If RN <= 60 And RN > 40 Then Call PBP("It bounces fair"): F$ = "down into the corner..."
        If RN <= 80 And RN > 60 Then Call PBP("It's in the gap"): F$ = "It rolls to the " + ad$
        If RN <= 99 And RN > 80 Then F$ = "It hits at the base of the " + ad$ + "..."
        If RN > 99 Then F$ = "The outfielders cross"
        Call PBP(F$)

        13524 Call d100(RN)
        If RN <= 90 Then
            F$ = "Triple!!"
        Else
            F$ = "3-Bagger!"
        End If
        Call PBP(F$)

        13525 '
        A5%(0) = 3
        A5%(1) = 3
        A5%(2) = 2
        A5%(3) = 1

        Call ADVANCEMENT(P, D, S2%, F%, I3)

        F% = 0

        Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
        If F% = 0 Then Call TRYFOREXTRABASE(LN%, S2%, P2, Z2%, D, W%, SAH%, SB%, I8, I9)
        Call SCOREBOARD
        GoTo 13900

    End If

    Call HITS2GAP(W%, P, I1, D)
    I3 = B4%(P, 1, B1!(P)) + B4%(P, 2, B1!(P))

    E2% = I3 + B4%(P, 3, B1!(P))
    If W% = 8 And H6% <= E2% And P2 <> 2 Or W% = 8 And H6% <= E2% * .5 And P2 = 2 Then S2% = 10: GoTo 13530

    E2% = I3 + B4%(P, 6, B1!(P))
    If W% = 7 And H6% <= E2% And P2 <> 2 Or W% = 7 And H6% <= E2% * .5 And P2 = 2 Then S2% = 10: GoTo 13530

    E2% = I3 + B4%(P, 7, B1!(P))
    If W% = 9 And H6% <= E2% And P2 <> 2 Or W% = 9 And H6% <= E2% * .5 And P2 = 2 Then S2% = 10: GoTo 13530

    13063 '
    H6% = Int(Rnd(1) * 100) + 1
    S2% = 7

    If B7%(P, B1!(P)) <> 1 And H7% > SN Then
        If H6% <= (B%(P, B3%(P, B1!(1)), 16) * 2.5) Then
            S2% = 12
            Call GETINFIELDER(W%, P, I1, D, S2%, P2)
            Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
            If F% = 1 Then 13900
        End If
    End If

    13065 '/ *** single ***
    Call SINGLEROUTINE(W%, P, I1, D, S2%, P2)

    If S2% = 12 Then
        Call SCOREBOARD
        GoTo 15050
    End If

    F% = 0
    PQ = 0

    Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
    If F% = 0 Then Call TRYFOREXTRABASE(LN%, S2%, P2, Z2%, D, W%, SAH%, SB%, I8, I9)
    Call SCOREBOARD
    GoTo 13900


    '-----


    13530 ' *** HOME RUN S2%=10 ***

    Call WINDEX

    If B7%(P, B1!(P)) <> 1 Then I5 = B3%(P, B1!(P)): I6 = 0: Call INCBATOFF(P, I5, I6): I6 = 1: Call INCBATOFF(P, I5, I6): I6 = 6: Call INCBATOFF(P, I5, I6)

    I5 = P1%(D)
    I6 = 1

    Call ADDPIT(D, I5, I6)

    If B7%(P, B1!(P)) = 1 Then I5 = P1%(P): I6 = 23: Call INCPITOFF(P, I5, I6): I6 = 24: Call INCPITOFF(P, I5, I6): I6 = 29: Call INCPITOFF(P, I5, I6)

    Call d100(RN)

    If RN <= 80 Then
        Call LONGFLY(D, W%)
    Else
        Call d100(RN)

        If RN <= 20 And (W% = 7 Or W% = 9) Then
            F$ = Q$(0) + " hits it down the " + C$(W%) + " line"
            Call PBP(F$)
            Call PBP("It's long enough if it's fair...")
        Else
            Call PBP(Q$(0) + " swings...")
            If RN > 20 And RN <= 40 Then Call PBP("NO DOUBT ABOUT THAT ONE!!"): F$ = "IT'S WAY OUT OF HERE!!"
            If RN > 40 And RN <= 60 Then F$ = Q$(4) + " CAN ONLY LOOK UP!!"
            If RN > 60 And RN <= 80 Then F$ = P$(D, P1%(D)) + " WATCHES IT SAIL OUT!!"
            If RN > 80 And RN <= 90 Then F$ = "GONE!!!"
            If RN > 90 Then F$ = "SAINTS AND HAYRAKES, LOOK AT 'ER SAIL!!"
            Call PBP(F$)
        End If

        '3536 / modified
        F$ = "HOME RUN!!"
        GoTo 13543

    End If

    13535 '
    Call d100(RN)

    If RN <= 5 And L%(1, 13) = 8 And W% = 7 Then Call PBP("THAT'S OUT OF THE PARK"): Call PBP("ON WAVELAND AVENUE!!!"): F$ = "HOME RUN...HOLY COW!!!": GoTo 13543
    If RN <= 15 And L%(1, 13) = 8 And W% = 7 Then Call PBP("IT'S GONE"): F$ = "LAST SEEN BOUNCING DOWN WAVELAND AVENUE!!!": GoTo 13543
    If RN <= 25 Then
        '13580
        If L%(1, 13) = 21 And W% = 7 Then Call PBP("IT CLEARS THE GREEN MONSTER!!"): F$ = "HOME RUN!!!": GoTo 13543
        If L%(1, 13) = 27 And W% = 7 Then Call PBP("IT CLEARS THE SCREEN!!"): F$ = "HOME RUN!!!": GoTo 13543
        If L%(1, 13) = 33 And P = 1 Then Call PBP("ADIOS!! THAT'S A HOME RUN!!"): F$ = "THE BUSCH EAGLE FLAPS ITS WINGS": GoTo 13543
        If L%(1, 13) = 25 And P = 1 Then Call PBP("IT'S OUT OF HERE FOR A HOMER!!!"): F$ = "THERE GOES THE EXPLODING SCOREBOARD!": GoTo 13543
        If L%(1, 13) = 7 And W% = 9 Then Call PBP("IT CLEARS THE WAGON GATE!!"): F$ = "THAT'S A HOME RUN!!": GoTo 13543
        If L%(1, 13) = 7 And P = 1 Then Call PBP("ADIOS!! THAT'S A HOME RUN!!"): F$ = "THERE GO THE CANNONS!!": GoTo 13543
        If L%(1, 13) = 8 Or L%(1, 13) = 40 Then F$ = "IT CLEARS THE IVY FOR A HOME RUN!!": GoTo 13543
        If L%(1, 13) = 23 And (W% = 7 Or W% = 9) Then Call PBP("IT'S LONG, IT'S LONG, IT'S GONE!!"): F$ = "THAT ONE'S IN THE UPPER DECK": GoTo 13543
        'GOTO 13545

        13545 '
        Call d100(RN)
        If RN <= 7 Then F$ = "GOODBYE!! IT'S A HOME RUN!!"
        If RN > 7 And RN <= 14 Then F$ = "ADIOS!! IT'S A HOME RUN !!!"
        If RN > 14 And RN <= 21 Then F$ = "SAY GOOD-BYE TO THAT ONE!!!"
        If RN > 21 And RN <= 28 Then F$ = "TOUCH 'EM ALL!!"
        If RN > 28 And RN <= 35 Then F$ = "SEE YOU LATER!!"
        If RN > 35 And RN <= 42 Then F$ = "GOOD-BYE MR. SPALDING!! HOME RUN!!!"
        If RN > 42 And RN <= 49 Then F$ = "HOME RUN!! MY OH MY!!"
        If RN > 49 And RN <= 56 Then F$ = "IT'S OVER THE WALL...OH DOCTOR!!!"
        If RN > 56 And RN <= 63 Then F$ = "LONG, LONG, AND GONE!!"
        If RN > 63 And RN <= 70 Then F$ = "HEY! HEY!...IT'S A HOME RUN !!!"
        If RN > 70 And RN <= 77 Then F$ = "IT'S LONG, IT'S LONG, IT'S GONE!!!"
        If RN > 77 And RN <= 84 Then F$ = "HOLY COW!! IT'S A HOME RUN!!!"
        If RN > 84 And RN <= 89 Then F$ = "OPEN THE WINDOW AUNT MINNIE...HERE SHE COMES"
        If RN > 89 And RN <= 95 Then Call PBP("WAAYYY BACK..."): F$ = "YOU CAN PUT IT ON THE BOARD, YYESSS!!"
        If RN > 95 Then Call PBP("IT'S WAY OUT OF HERE!! HOME RUN!!!"): F$ = "HOW 'BOUT THAT!!!"

    End If

    13543 '
    Call PBP(F$)
    Call DELAY

    '13544
    A5%(3) = 1
    A5%(2) = 2
    A5%(1) = 3
    A5%(0) = 4
    I5 = P1%(D)
    I6 = 14

    Call ADDPIT(D, I5, I6)
    Call ADVANCEMENT(P, D, S2%, F%, I3)
    Call SCOREBOARD

    GoTo 13900


    '-----


    13600 ' *** strikeout ***
    H6% = Int(Rnd(1) * 1000) + 1

    If H6% > B4%(P, 4, B1!(P)) Then
        13610 ' *** ground ball for out ***
        H6% = Int(Rnd(1) * 100) + 1
        E2% = B%(P, B3%(P, B1!(P)), 18) + P%(D, P1%(D), 12) - 52
        E3% = 23 + P%(D, P1%(D), 12)
        E4% = 0

        If H6% > E2% And B7%(P, B1!(P)) <> 1 Then E4% = 1
        If H6% > E3% And B7%(P, B1!(P)) = 1 Then E4% = 1
        If E4% = 1 Then 14000

        S2% = 13

        Call GETINFIELDER(W%, P, I1, D, S2%, P2)
        Call WINDEX

        S2% = 13

        Call DELIVERY(D)
        Call GROUNDERPBP(W%, D)

        Call d100(RN)

        13612 '
        If (S4% = 1 Or S4% = 4 Or ((S4% = 7 Or S4% = 5) And INFPOS% < 2)) And O%(0) <= 1 And RN <= 50 Then
            DPC% = 1
            Call DPPBP
        End If

        If B7%(P, B1!(P)) <> 1 Then
            I5 = B3%(P, B1!(P)): I6 = 0
            Call INCBATOFF(P, I5, I6)
        Else
            I5 = P1%(P): I6 = 23
            Call INCPITOFF(P, I5, I6)
        End If

        Call FLDERR(F%, W%, D, I3, SB%, S2%, P)

        If F% = 1 Then 13900

        ' *** 2 outs, bases empty, runner 2nd, runner 3rd, or 2nd&3rd ***
        If O%(0) = 2 Or S4% = 0 Or S4% = 2 Or S4% = 3 Or S4% = 6 Then 13650

        H6% = Int(Rnd(1) * 1000) + 1
        E2% = ((L%(D, 5) - 80) * 4)
        E3% = ((5 - B%(P, B3%(P, B1!(P)), 16)) * 9)

        If W% = 2 And H6% > 250 + E2% + E3% Then 13650
        If H6% > 490 + E2% + E3% Then 13650
        If P2 = 2 Then 13650
        S2% = 13

        If S4% = 4 Then
            If W% = 5 And Int(Rnd(1) * 3) + 1 = 1 Then 13633
            If W% = 2 Then Call CREDITASSIST(W%, D): GoTo 13633
        End If

        If S4% = 7 And W% = 1 Then Call CREDITASSIST(W%, D): TB = 9: W% = 2: Call PBP("He throws home"): A5%(3) = 11: A5%(1) = 0: A5%(2) = 0: A5%(0) = 0: GoTo 13634
        If S4% = 5 And S6%(P, 0) - S6%(D, 0) >= 0 And INNING% > 7 And O%(0) = 0 And INFPOS% > 0 And W% = 5 Or S4% = 5 And S6%(P, 0) - S6%(D, 0) >= 0 And INNING% > 7 And O%(0) = 0 And INFPOS% > 0 And W% = 3 Then 13650
        If S4% = 7 And INFPOS% > 0 And (W% = 5 Or W% = 3) Then Call CREDITASSIST(W%, D): TB = 9: W% = 2: Call PBP("He fires it home"): A5%(3) = 11: A5%(1) = 0: A5%(2) = 0: A5%(0) = 0: GoTo 13634
        If S4% = 7 And INFPOS% = 2 And W% = 4 Then Call CREDITASSIST(W%, D): TB = 9: W% = 2: Call PBP("He throws home for the force"): A5%(3) = 11: A5%(1) = 0: A5%(2) = 0: A5%(0) = 0: GoTo 13634
        If S4% = 7 And INFPOS% = 2 And W% = 6 Then Call CREDITASSIST(W%, D): TB = 9: W% = 2: Call PBP("He goes home with it"): A5%(3) = 11: A5%(1) = 0: A5%(2) = 0: A5%(0) = 0: GoTo 13634

        If W% <= 4 Then
            Call CREDITASSIST(W%, D)
            W% = 6
            Call PBP("He throws to " + B$(D, B9%(D, 6)))
        Else
            Call CREDITASSIST(W%, D)
            W% = 4
            Call PBP("He throws to " + B$(D, B9%(D, 4)))
        End If

        A5%(1) = 11: A5%(2) = 0: A5%(3) = 0: A5%(0) = 0

        If S4% = 7 And (W% = 2 Or W% = 1) Then
            A5%(3) = 11: A5%(2) = 1: A5%(1) = 1: A5%(0) = 1
        End If

        GoTo 13634

    End If

    13601 '
    Call WINDEX
    Call STRIKEOUT(U%, D)

    13602 W% = 2: Call CREDITREGPO(W%, D)
    O%(0) = O%(0) + 1
    O%(1) = O%(1) + 1
    SO = 1
    If B7%(P, B1!(P)) <> 1 Then I5 = B3%(P, B1!(P)): I6 = 0: Call INCBATOFF(P, I5, I6): I6 = 8: Call INCBATOFF(P, I5, I6): If P2 = 2 Then U% = 3
    I5 = P1%(D): I6 = 5: Call ADDPIT(D, I5, I6): I6 = 0: Call ADDPIT(D, I5, I6)
    If B7%(P, B1!(P)) = 1 Then I5 = P1%(P): I6 = 23: Call INCPITOFF(P, I5, I6): I6 = 31: Call INCPITOFF(P, I5, I6): If P2 = 2 Then U% = 3
    If P2 = 2 And O%(0) < 3 Then SO = 7: GoTo 14800

    ' *** WILD PITCH OR PASSED BALL ON A STRIKEOUT
    I = Int(Rnd(1) * 600) + 1
    If B0%(1, 0) = 0 And I = 9 And SO = 1 Or O%(0) = 3 And I = 9 Then
        O%(0) = O%(0) - 1: O%(1) = O%(1) - 1
        I5 = P1%(D): P8%(D, I5, 0) = P8%(D, I5, 0) - 1
        P5%(D, I5, 0) = P5%(D, I5, 0) - 1
        B8%(D, B9%(D, 2), 16) = B8%(D, B9%(D, 2), 16) - 1
        B5%(D, B9%(D, 2), 16) = B5%(D, B9%(D, 2), 16) - 1

        I1 = Int(Rnd(1) * 100) + 1
        If I1 < 77 Then
            '13230 / *** wild pitch ***
            If S4% = 0 And SO <> 1 Then
                '13100 / *** fouled out of play ***
                Call FOULBALL
                GoTo 15052
            End If

            Call WILDPITCH(S2%, D)

            GoTo 13222

        Else

            GoTo 13220

        End If

    End If

    GoTo 13900


    '-----
    13633 A5%(3) = 0: A5%(2) = 11: A5%(1) = 0: A5%(0) = 0
    '-----


    13634 I5 = P1%(D): I6 = 0
    Call ADDPIT(D, I5, I6)
    O%(0) = O%(0) + 1
    O%(1) = O%(1) + 1
    Q$(4) = B$(D, B9%(D, W%))

    Call ADVANCEMENT(P, D, S2%, F%, I3)
    Call CREDITREGPO(W%, D)

    S2% = 15
    Call FLDERR(F%, W%, D, I3, SB%, S2%, P)

    If F% = 1 Then 13900

    Call CREDITASSIST(W%, D)

    If W% = 5 And O%(0) < 2 And Int(Rnd(1) * 10) + 1 <= B%(P, B3%(P, B0%(1, 0)), 16) Then
        A5%(0) = 1
        A5%(1) = 11
        A5%(2) = 0
        A5%(3) = 0
        If O%(0) < 2 Then A5%(2) = 1: A5%(3) = 1
    Else
        A5%(0) = 11
        A5%(1) = 1
        A5%(2) = 0
        A5%(3) = 0
        If O%(0) < 2 Then A5%(2) = 1: A5%(3) = 1
    End If

    O%(0) = O%(0) + 1
    O%(1) = 2
    I5 = P1%(D)
    I6 = 0

    Call DPRELAY
    Call ADDPIT(D, I5, I6)
    Call ADVANCEMENT(P, D, S2%, F%, I3)
    Call CREDITPUTOUT(I3, FB2P%, AST%, D)
    Call d100(RN)

    DPC% = 0
    If RN <= 80 Then F$ = " --- DOUBLE PLAY ---"
    If RN > 80 Then F$ = " --- TWIN KILLING ---"
    Call PBP(F$)
    DP%(D) = DP%(D) + 1: D3%(D) = D3%(D) + 1
    TB = 0
    Call INCREMENTHIT(P, D, MO)

    GoTo 13900


    '-----


    13650 If O%(0) < 2 Then 13690
    I = Int(Rnd(1) * 10) + 1
    S2% = 13

    If W% = 5 Then
        If I <= 5 And (S4% = 4 Or S4% = 7) Then
            Call PITCHERNAME(W%, D): Call PBP(Q$(4) + " gloves it and heads for 3rd"): A5%(0) = 0: A5%(1) = 0: A5%(2) = 11: A5%(3) = 0: GoTo 13684
        Else
            Call PITCHERNAME(W%, D)
            Call GROUNDERS(W%, D)
            Call THROW2FIRST(D): GoTo 13672
        End If
    End If

    If W% = 6 Then
        If I <= 8 And (S4% = 1 Or S4% = 4 Or S4% = 5 Or S4% = 7) Then
            Call PITCHERNAME(W%, D)
            Call GROUNDERS(W%, D)
            Call DPPIVOT(W%, D)
            AST% = 6: A5%(0) = 0: A5%(1) = 11: A5%(2) = 0: A5%(3) = 0: GoTo 13684
        Else
            Call PITCHERNAME(W%, D)
            Call GROUNDERS(W%, D)
            Call THROW2FIRST(D): GoTo 13672
        End If
    End If

    If W% = 4 And I <= 5 And (S4% = 1 Or S4% = 4 Or S4% = 5 Or S4% = 7) Then
        Call PITCHERNAME(W%, D)
        Call GROUNDERS(W%, D)
        Call DPPIVOT(W%, D)
        AST% = 4: A5%(0) = 0: A5%(1) = 11: A5%(2) = 0: A5%(3) = 0: GoTo 13684
    End If

    Call d100(RN)

    If W% = 3 Then
        If RN <= 94 Then
            Call PITCHERNAME(W%, D)
            Call GROUNDERS(W%, D)
            Call PBP("He takes it to the bag unassisted"): fbu% = 1: GoTo 13672
        Else
            Call PITCHERNAME(W%, D)
            Call GROUNDERS(W%, D)
            W% = 1
            Call PITCHERNAME(W%, D)
            Call PBP("He flips it to " + Q$(4) + " covering")
            FB2P% = 1
            W% = 3
            GoTo 13672
        End If
    End If

    Call PITCHERNAME(W%, D)
    Call GROUNDERS(W%, D)
    Call SECOND2FIRST(D)
    'GoTo 13672

    13672 A5%(0) = 11: A5%(1) = 0: A5%(2) = 0: A5%(3) = 0

    13684 'Call DELAY
    If fbu% = 0 Then Call CREDITASSIST(W%, D)
    fbu% = 0

    If DPC% = 1 And A5%(0) = 1 Then DPC% = 2

    Call ADVANCEMENT(P, D, S2%, F%, I3)

    If DPC% = 2 Then
        DPC% = 0
        Call DPSAFE
    End If

    If I3 > 4 Then I3 = 1

    Call CREDITPUTOUT(I3, FB2P%, AST%, D)

    O%(0) = O%(0) + 1
    O%(1) = O%(1) + 1
    I5 = P1%(D): I6 = 0: Call ADDPIT(D, I5, I6)

    GoTo 13900


    '-----


    13690 I = Int(Rnd(1) * 100) + 1
    If (I <= 90 And P2 <> 2 Or S4% = 0) Or (I <= 10 And P2 = 2) Then
        13720 '
        S2% = 14

        If S4% = 0 Or S4% = 2 Or S4% = 3 Or S4% = 6 Then
            A5%(0) = 11
            Call OUTATFIRST(W%, D, fbu%, FB2P%)
            GoTo 13693
        End If

        I = Int(Rnd(1) * 100) + 1

        A5%(0) = 1
        A5%(1) = 1
        A5%(2) = 1
        A5%(3) = 1

        If INFPOS% = 0 And W% = 2 Then A5%(3) = 0
        If S4% = 5 Or S4% = 7 Or S4% = 4 Then 13725

        A5%(1) = 11

        GoTo 13743

    End If

    S2% = 13
    A5%(1) = 1
    A5%(2) = 1
    A5%(3) = 1
    A5%(0) = 11
    I = Int(Rnd(1) * 100) + 1
    If S4% = 1 Or S4% = 4 Or S4% = 5 Or S4% = 7 Then 13713

    13693 I = Int(Rnd(1) * 100) + 1
    A5%(1) = 0: A5%(2) = 0: A5%(3) = 0
    If W% = 5 And I <= 25 And INFPOS% < 2 Then A5%(2) = 1
    If W% = 5 And I <= 83 And INFPOS% = 0 Then A5%(3) = 1: ' WAS 50
    If W% = 5 And I <= 10 And INFPOS% > 0 Then A5%(3) = 1
    If W% = 5 And I < 5 And INFPOS% < 2 And S4% = 2 And S6%(P, 0) - S6%(D, 0) > -2 Or W% = 5 And I < 5 And INFPOS% < 2 And S4% = 6 And A5%(3) = 1 And S6%(P, 0) - S6%(D, 0) > -2 Then A5%(2) = 11: A5%(0) = 1: Call PBP("NO, he's going to third")
    If W% = 6 And I <= 20 And INFPOS% < 2 Then A5%(2) = 1
    If W% = 6 And I <= 92 And INFPOS% < 2 Then A5%(3) = 1
    If W% = 6 And I <= 5 And INFPOS% = 2 Then A5%(3) = 1
    If W% = 6 And I < 6 And INFPOS% < 2 And S4% = 2 And S6%(P, 0) - S6%(D, 0) > -2 Or W% = 6 And I < 6 And INFPOS% < 2 And S4% = 6 And A5%(3) = 1 And S6%(P, 0) - S6%(D, 0) > -2 Then A5%(2) = 11: A5%(0) = 1: Call PBP("NO, he's going to third")
    If W% = 4 And I <= 90 And INFPOS% < 2 Then A5%(2) = 1
    If W% = 4 And I <= 90 And INFPOS% < 2 Then A5%(3) = 1
    If W% = 4 And I <= 65 And INFPOS% = 2 Then A5%(2) = 1
    If W% = 4 And I <= 5 And INFPOS% = 2 Then A5%(3) = 1
    If W% = 3 And I <= 95 Then A5%(2) = 1
    If W% = 3 And I <= 88 And INFPOS% = 0 Then A5%(3) = 1: ' WAS 60
    If W% = 3 And I <= 15 And INFPOS% > 0 Then A5%(3) = 1
    If W% = 1 And I <= 30 Then A5%(2) = 1
    If W% = 1 And I <= 50 And INFPOS% = 0 Then A5%(3) = 1
    If W% = 1 And I <= 10 And INFPOS% > 0 Then A5%(3) = 1
    If W% = 2 And I <= 45 Then A5%(2) = 1

    13713 GoTo 13684


    '-----


    13725 If S4% = 4 Or S4% = 7 Then 13732
    If S6%(P, 0) - S6%(D, 0) >= 0 And INNING% > 6 And O%(0) = 0 And INFPOS% > 0 And W% = 5 Or S6%(P, 0) - S6%(D, 0) >= 0 And INNING% > 6 And O%(0) = 0 And INFPOS% > 0 And W% = 3 Then A5%(3) = 11: GoTo 13743
    If INFPOS% = 0 And W% <> 2 Then A5%(1) = 11: GoTo 13743
    If INFPOS% > 0 And W% = 5 Or INFPOS% > 0 And W% = 3 Then A5%(3) = 0: A5%(1) = 11: GoTo 13743
    If INFPOS% > 0 And (W% = 1 Or W% = 3) Then A5%(3) = 0: A5%(1) = 1: A5%(0) = 11: GoTo 13743
    If INFPOS% = 2 And W% = 4 Or INFPOS% = 2 And W% = 6 And I <= 90 Then A5%(3) = 0: A5%(1) = 11: GoTo 13743
    A5%(1) = 11

    GoTo 13743


    '-----


    13732 If W% = 6 And I < 6 And INFPOS% < 2 And INNING% < 9 Or W% = 5 And I < 6 And INFPOS% < 2 And INNING% < 9 Then A5%(2) = 11: GoTo 13684
    If S4% = 7 Then 13740
    I = Int(Rnd(1) * 10) + 1: A5%(0) = 1: A5%(1) = 11: A5%(2) = 1: A5%(3) = 0
    If W% = 5 And I <= 5 Then A5%(1) = 1: A5%(2) = 11: A5%(3) = 0
    If W% = 1 And I <= 3 Then A5%(1) = 1: A5%(2) = 11: A5%(3) = 0
    If W% = 2 And B%(P, B3%(P, B0%(2, 0)), 16) < 7 And B%(P, B3%(P, B0%(2, 0)), 16) > 0 Then A5%(1) = 1: A5%(2) = 11: A5%(3) = 0: GoTo 13743
    If W% = 2 And B%(P, B3%(P, B0%(2, 0)), 16) > 6 Then A5%(1) = 1: A5%(2) = 1: A5%(0) = 11

    GoTo 13743


    '-----


    13740 I = Int(Rnd(1) * 100) + 1: A5%(1) = 11: A5%(2) = 1: A5%(3) = 1: A5%(0) = 1
    If INFPOS% > 0 And W% = 5 Or INFPOS% > 0 And W% = 3 Or INFPOS% = 2 And W% = 4 Or INFPOS% = 2 And W% = 6 Or W% = 2 Or W% = 1 Then A5%(3) = 11: A5%(0) = 1: A5%(1) = 1: A5%(2) = 1: GoTo 13743
    If W% = 5 And I <= 5 Or W% = 1 Or W% = 2 Then A5%(3) = 11: A5%(2) = 1: A5%(1) = 1: A5%(0) = 1

    13743 GoTo 13684


    '-----------------------------------------------------
    '--- THIS IS CRITICAL FOR PBP MOVING AUTOMATICALLY ---
    '-----------------------------------------------------
    ' Play-by-Play box
    13900 '
    If usingGfx = 1 Then _PutImage (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 144), backupScreen&, imageScreen&, (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 144)

    ' essentially it allows the user to press a key
    ' during game play to activate certain functions
    ' or special menus, etc.
    I$ = InKey$
    If UCase$(I$) = "Q" Then Call EndOfGame: End
    If UCase$(I$) = "O" Then
        Call OPTIONS
    End If

    '----------------------------------------------------

    'There was some question as to whether this is needed
    'based on comparing to the original code, but the working
    'version of my code had this in it still
    If usingGfx = 1 Then _PutImage (17 * FontColAdj%, 128)-Step(46 * FontColAdj%, 80), backupScreen&, imageScreen&, (17 * FontColAdj%, 128)-Step(46 * FontColAdj%, 80)

    DPC% = 0
    H0% = 0
    INFPOS% = 0
    F% = 0
    PQ = 0
    H0%(0) = 0

    If O%(0) = 3 Then
        GoTo 15000
    Else
        GoTo 15050
    End If


    '-----


    14000 'balls hit to the air
    I = Int(Rnd(1) * 100) + 1
    A5%(0) = 0: A5%(1) = 0: A5%(2) = 0: A5%(3) = 0

    'Case 1 to 73
    If I <= 73 Then 14020: ' flyout

    'Case 74 to 89
    If I <= 89 Then 14010: ' popup

    'Case 90 to 100
    S2% = 21

    Call GETINFIELDER(W%, P, I1, D, S2%, P2)
    Call WINDEX
    Call DELIVERY(D)

    Y% = Int(Rnd(1) * 42) + 70
    'Print #9, "Calling PBP from SOURCE, index "; Y%
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Call PBP(Y$)

    Y% = Int(Rnd(1) * 34) + 120
    'Print #9, "Calling PBP from SOURCE, index "; Y%
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Call PBP(Y$)

    If B7%(P, B1!(P)) = 1 Then
        I5 = P1%(P): I6 = 23: Call INCPITOFF(P, I5, I6)
    Else
        I5 = B3%(P, B1!(P)): I6 = 0: Call INCBATOFF(P, I5, I6)
    End If

    Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
    If F% = 1 Then 13900

    O%(0) = O%(0) + 1
    O%(1) = O%(1) + 1
    Call CREDITREGPO(W%, D)
    I5 = P1%(D): I6 = 0
    Call ADDPIT(D, I5, I6)
    If O%(0) = 3 Then 13900

    I = Int(Rnd(1) * 100) + 1

    If (S4% = 1 Or S4% = 5) And I >= 80 Or (S4% = 1 Or S4% = 5) And P2 = 2 Then 14012
    If (S4% = 4 Or S4% = 2) And I >= 80 Or S4% = 4 And P2 = 2 Then 14014

    14009 Call ADVANCEMENT(P, D, S2%, F%, I3)

    GoTo 13900


    '-----


    14010 ' infield popup
    Call GETINFIELDER(W%, P, I1, D, S2%, P2)
    S2% = 20
    Call WINDEX

    If W% = 1 Then W% = 2: Q$(4) = B$(D, B9%(D, W%))
    If (W% = 2 Or W% = 5 Or W% = 3) And Int(Rnd(1) * 100) + 1 <= 30 Then fo% = 1
    If fo% = 0 And (S4% = 4 Or S4% = 7) And O%(0) < 2 Then Call PBP("INFIELD FLY RULE CALLED")
    If fo% = 1 And W% = 2 Then Y% = Int(Rnd(1) * 24) + 180
    If fo% = 1 And (W% = 3 Or W% = 4) Then Y% = Int(Rnd(1) * 31) + 210
    If fo% = 1 And (W% = 5 Or W% = 6) Then Y% = Int(Rnd(1) * 31) + 250
    If fo% <> 1 And W% = 2 Then Y% = Int(Rnd(1) * 50) + 400
    If fo% <> 1 And W% = 3 Then Y% = Int(Rnd(1) * 60) + 450
    If fo% <> 1 And W% = 5 Then Y% = Int(Rnd(1) * 60) + 510
    If fo% <> 1 And W% = 6 Then Y% = Int(Rnd(1) * 60) + 570
    If fo% <> 1 And W% = 4 Then Y% = Int(Rnd(1) * 60) + 630
    'Print #9, "Calling PBP from SOURCE, index "; Y%
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Call PBP(Y$)

    If fo% = 1 And W% = 2 Then Y% = Int(Rnd(1) * 12) + 321
    If fo% = 1 And (W% = 3 Or W% = 4) Then Y% = Int(Rnd(1) * 25) + 340
    If fo% = 1 And (W% = 5 Or W% = 6) Then Y% = Int(Rnd(1) * 25) + 370
    If fo% <> 1 Then Y% = Int(Rnd(1) * 25) + 690
    'Print #9, "Calling PBP from SOURCE, index "; Y%
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Call PBP(Y$)

    14011 If B7%(P, B1!(P)) = 1 Then
        I5 = P1%(P): I6 = 23
        Call INCPITOFF(P, I5, I6)
    Else
        I5 = B3%(P, B1!(P)): I6 = 0
        Call INCBATOFF(P, I5, I6)
    End If

    If S4% = 4 Then 14017
    If Int(Rnd(1) * 100) + 1 <= 25 And (L%(1, 13) = 11 Or L%(1, 13) = 8) Then Call PBP("fights the wind...")
    If Int(Rnd(1) * 100) + 1 <= 15 And (L%(1, 13) = 2 Or L%(1, 13) = 4 Or L%(1, 13) = 13 Or L%(1, 13) = 24) Then Call PBP("fights the lights...")
    If fo% <> 1 Then
        Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
        If F% = 1 Then 13900
    End If

    14017 fo% = 0
    Call PBP(Q$(4) + " makes the catch")
    Call CREDITREGPO(W%, D)
    O%(0) = O%(0) + 1
    O%(1) = O%(1) + 1
    I5 = P1%(D): I6 = 0
    Call ADDPIT(D, I5, I6)

    GoTo 13900


    '-----


    14012 'runner doubled off of 1st
    A5%(1) = 10: O%(0) = O%(0) + 1: O%(1) = O%(1) + 1
    Call ADDPIT(D, I5, I6)
    D3%(D) = D3%(D) + 1: DP%(D) = DP%(D) + 1
    If W% <> 3 Then
        Y% = Int(Rnd(1) * 10) + 160
    Else
        Y% = Int(Rnd(1) * 10) + 170
    End If

    'Print #9, "Calling PBP from SOURCE, index "; Y%
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Call PBP(Y$)

    I3 = 1
    Call CREDITPUTOUT(I3, FB2P%, AST%, D)
    Call PBP(" --- DOUBLE PLAY ---")
    If W% <> 3 Then Call CREDITASSIST(W%, D)

    GoTo 14009


    '-----


    14014 'runner doubled off of 2nd
    A5%(2) = 10: O%(0) = O%(0) + 1: O%(1) = O%(1) + 1
    Call ADDPIT(D, I5, I6)
    D3%(D) = D3%(D) + 1: DP%(D) = DP%(D) + 1
    I3 = 2
    Call CREDITPUTOUT(I3, FB2P%, AST%, D)
    Call PBP(" --- DOUBLE PLAY ---")
    Call CREDITASSIST(W%, D)

    GoTo 14009


    '-----


    14020 ' *** FLY  OUTS ***
    Call GETOUTFIELDER(W%, P, I1, D)
    If B7%(P, B1!(P)) <> 1 Then
        I5 = B3%(P, B1!(P)): I6 = 0
        Call INCBATOFF(P, I5, I6)
    Else
        I5 = P1%(P): I6 = 23
        Call INCPITOFF(P, I5, I6)
    End If
    I = Int(Rnd(1) * 100) + 1

    'Case 1 to 17
    If I <= 17 Then
        14050 ' *** shallow fly ball ***
        S2% = 19
        Call WINDEX
        X$ = C$(W%)
        If Int(Rnd(1) * 100) <= 25 And W% = 7 Then X$ = "lcf"
        If Int(Rnd(1) * 100) <= 25 And W% = 9 Then X$ = "rcf"
        Call DELIVERY(D)
        Call d100(RN)

        Y% = Int(Rnd(1) * 60) + 1170
        'Print #9, "Calling PBP from SOURCE, index "; Y%
        Call GETRPBP(Y%, Y$, D)
        Call STRIPRPBP(Y$, Y%, D)
        Call PBP(Y$ + " " + X$)

        Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
        If F% = 1 Then 13900
        GoTo 14025
    End If

    'Case 18 to 33
    If I <= 33 Then
        14060 ' *** deep fly out ***
        S2% = 17

        Call WINDEX
        Call LONGFLY(D, W%)
        Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
        If F% = 1 Then 13900
        Call CREDITREGPO(W%, D)
        Call CAUGHTFLY(I, S2%, D)

        'Print #9, "We just called CAUGHTFLY for deep fly out ~14060"

        O%(0) = O%(0) + 1
        O%(1) = O%(1) + 1
        I5 = P1%(D)
        I6 = 0

        Call ADDPIT(D, I5, I6)
        'Print #9, "We just called ADDPIT for deep fly out ~14060"

        If O%(0) = 3 Then 13900

        If B0%(3, 0) <> 0 Then

            A5%(3) = 1
            I5 = P1%(D)
            I6 = 16

            Call ADDPIT(D, I5, I6)
            'Print #9, "We just called ADDPIT again for deep fly out ~14060"

            If B7%(P, B1!(P)) = 1 Then I5 = P1%(P): I6 = 23: Call PITOFF(P, I5, I6): I5 = P1%(P): I6 = 41: Call INCPITOFF(P, I5, I6): GoTo 14066

            I5 = B3%(P, B1!(P)): I6 = 0
            Call BATOFF(P, I5, I6): I5 = B3%(P, B1!(P)): I6 = 19: Call INCBATOFF(P, I5, I6)

            'Print #9, "We just called BATOFF for deep fly out ~14060"

        End If

        'ASSUMPTION: Somewhere in here is where it gets locked up
        14066 '
        If B0%(2, 0) = 0 Then 14072

        'Print #9, "We didn't go to 14072"
        I4 = (B%(P, B3%(P, B0%(2, 0)), 16) - 5) * 25
        ZM = (B%(D, B9%(D, W%), 15) - 5) * 25
        I4 = I4 - ZM

        I = Int(Rnd(1) * 1000) + 1
        'Print #9, "We just got a random # - "; I

        If W% = 9 And S2% = 17 And I <= 800 + I4 And P2 <> 2 Or W% = 9 And S2% = 18 And I <= 400 + I4 And P2 <> 2 Or W% = 8 And S2% = 17 And I <= 700 + I4 And P2 <> 2 Or W% = 8 And S2% = 18 And I <= 350 + I4 And P2 <> 2 Or W% = 7 And S2% = 17 And I <= 250 + I4 And P2 <> 2 Then A5%(2) = 1
        If P2 = 2 And B%(P, B3%(P, B0%(2, 0)), 16) > 6 And W% = 9 And S2% = 17 And I <= 400 + I4 Or P2 = 2 And B%(P, B3%(P, B0%(2, 0)), 16) > 6 And W% = 8 And S2% = 17 And I <= 400 + I4 Then A5%(2) = 1

        'Print #9, "We just checked W% and P2: "; W%; " | "; P2

        '------------------------------------------------------------------

        If A5%(2) <> 1 And S2% = 18 And W% = 9 And P2 <> 2 And S4% < 6 And I > 800 Then
            I8 = 3
            LN% = 3308
            If F% = 0 Then Call TRYFOREXTRABASE(LN%, S2%, P2, Z2%, D, W%, SAH%, SB%, I8, I9)

            'Print #9, "We just called TRYFOREXTRABASE for deep fly out ~14060"

            GoTo 14072
        End If

        If A5%(2) <> 1 And S2% = 18 And W% = 8 And P2 <> 2 And S4% < 6 And I > 840 Then
            I8 = 3
            LN% = 3308
            If F% = 0 Then Call TRYFOREXTRABASE(LN%, S2%, P2, Z2%, D, W%, SAH%, SB%, I8, I9)

            'Print #9, "We just called TRYFOREXTRABASE again for deep fly out ~14060"

            GoTo 14072
        End If

        If A5%(2) <> 1 And W% = 7 And P2 <> 2 And S4% < 6 And I > 880 Then
            I8 = 3
            LN% = 3308
            If F% = 0 Then Call TRYFOREXTRABASE(LN%, S2%, P2, Z2%, D, W%, SAH%, SB%, I8, I9)

            'Print #9, "We just called TRYFOREXTRABASE once more for deep fly out ~14060"

        End If

        14072 '
        If B0%(1, 0) <> 0 Then
            I = Int(Rnd(1) * 1000) + 1: A5%(1) = 0
            I3 = (B%(P, B3%(P, B0%(1, 0)), 16) - 5) * 25
            I4 = (B%(D, B9%(D, W%), 15) - 5) * 25: J5 = I3 - I4

            If S2% = 17 And P2 <> 2 And S4% = 1 And I <= 100 + J5 Then
                I8 = 2
                LN% = 3308
                If F% = 0 Then Call TRYFOREXTRABASE(LN%, S2%, P2, Z2%, D, W%, SAH%, SB%, I8, I9)
            End If
            I8 = 2
            LN% = 3308

            'Print #9, "We just called TRYFOREXTRABASE last time for deep fly out ~14060"

        End If

        '--- Double-check this sometime
        Call ADVANCEMENT(P, D, S2%, F%, I3)
        'Print #9, "We just called ADVANCEMENT for deep fly out ~14060"

        GoTo 13900

    End If


    '-----


    'Case 34 to 100
    ' *** regular fly out ***
    S2% = 18
    Call WINDEX
    X$ = C$(W%)
    If Int(Rnd(1) * 100) <= 25 And W% = 7 Then X$ = "lcf"
    If Int(Rnd(1) * 100) <= 25 And W% = 9 Then X$ = "rcf"

    Call DELIVERY(D)
    Call d100(RN)

    Y% = Int(Rnd(1) * 90) + 1070
    If (W% = 7 Or W% = 9) And RN <= 10 Then X$ = "": Y% = Int(Rnd(1) * 10) + 1160

    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Call PBP(Y$ + " " + X$)
    Call FLDERR(F%, W%, D, I3, SB%, S2%, P)

    If F% = 1 Then 13900

    '--- where does this end?
    '--- can we turn into subroutine?
    14025 '
    Call CREDITREGPO(W%, D)
    Call CAUGHTFLY(I, S2%, D)

    'Print #9, "We just called CAUGHTFLY from ~14025"

    O%(0) = O%(0) + 1
    O%(1) = O%(1) + 1
    I5 = P1%(D)
    I6 = 0

    Call ADDPIT(D, I5, I6)
    'Print #9, "We just called ADDPIT from ~14025"

    If O%(0) = 3 Then 13900

    I = Int(Rnd(1) * 100) + 1

    If S2% = 19 And S4% = 1 And I <= 33 And P2 = 2 Or S2% = 19 And S4% = 5 And I <= 33 Then
        A5%(1) = 10
        O%(0) = O%(0) + 1: O%(1) = O%(1) + 1
        Call ADDPIT(D, I5, I6)
        D3%(D) = D3%(D) + 1: DP%(D) = DP%(D) + 1
        Call CREDITASSIST(W%, D)
        GoTo 14009
    End If

    'Print #9, "We just checked S2% from ~14025"

    If B0%(3, 0) > 0 Then
        I8 = 4
        LN% = 3308
        If F% = 0 Then Call TRYFOREXTRABASE(LN%, S2%, P2, Z2%, D, W%, SAH%, SB%, I8, I9)

    End If

    'Print #9, "We just checked B0% from ~14025"

    If I9 = 1 Then
        I9 = 0
        Call ADVANCEMENT(P, D, S2%, F%, I3)
        GoTo 13900
    Else
        GoTo 14066
    End If


    '--------------------
    'Do we ever get here???
    '14095 I$ = GetKeyPress$
    'Return
    '--------------------


    14100 ' *** BUNT ROUTINE ***
    Call WINDEX
    For I = 0 To 3: A5%(I) = 0: Next
    SH = 2
    S2% = 23
    If (S4% = 3 Or S4% > 4) And O%(0) < 2 Then Call SQUEEZECHOICE(SH)
    Call d100(RN)
    If B7%(P, B1!(P)) = 1 Then BR = P%(P, P1%(P), 32)
    If B7%(P, B1!(P)) <> 1 Then BR = B%(P, B3%(P, B1!(P)), 30)
    If INFPOS% > 0 Then BR = BR - 2
    If BR <= 1 Then BR = 1
    For I = 1 To 9:
        If RN <= BT%(L%(1, 10), BR, I) Then 14107
    Next

    14107 WW% = Int(Rnd(1) * 10)
    If WW% <= 2 Then W% = 5
    If WW% > 2 And WW% <= 4 Then W% = 1
    If WW% > 4 And WW% <= 7 Then W% = 3
    If WW% > 7 Then W% = 2
    Call GETFIELDNAME(W%, D)
    Call d100(RN)

    If RN <= 52 Then 14175

    Select Case I
        Case 1
            14110 'PU
            Call PBP(Q$(0) + " bunts it in the air...")
            Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
            Call PBP(Q$(4) + " makes the catch")
            Call ADDSTTS(P, D)

            O%(0) = O%(0) + 1
            O%(1) = O%(1) + 1
            Call CREDITREGPO(W%, D)

            If O%(0) <> 3 And SH <> 2 Then
                '--- start of a new sub ???
                '--- where does 4111 end ???
                14111 '
                If W% <> 5 Then
                    Call CREDITASSIST(W%, D)
                    W% = 5
                    Call CREDITREGPO(W%, D)
                    Q$(5) = Q$(4)
                    Call GETFIELDNAME(W%, D)
                Else
                    Call CREDITASSIST(W%, D)
                    W% = 6
                    Call CREDITREGPO(W%, D)
                    Q$(5) = Q$(4)
                    Call GETFIELDNAME(W%, D)
                End If

                14115 '
                Call PBP(Q$(5) + " throws to " + Q$(4) + " at 3rd")
                A5%(3) = 10
                Call ADVANCEMENT(P, D, S2%, F%, I3)
                O%(0) = O%(0) + 1
                O%(1) = O%(1) + 1
                I5 = P1%(D)
                I6 = 0

                Call ADDPIT(D, I5, I6)

                If SH = 1 Then
                    If O%(0) < 3 Then
                        GoTo 15051
                    Else
                        'O%(0) >= 3
                        B1!(P) = B1!(P) - 1
                    End If
                End If
            End If

            GoTo 13900

        Case 2
            14120 'DP
            If S4% = 1 Or S4% = 4 Or S4% = 5 Or S4% = 7 Then
                14125 '
                Call PBP(Q$(0) + " lays down a good bunt")
                Call FLDERR(F%, W%, D, I3, SB%, S2%, P)

                If F% = 1 Then 13900

                Call PBP(Q$(4) + " fields it cleanly")

                If SH = 1 And (S4% = 5 Or S4% = 7) Then
                    14127 '
                    If W% = 2 Then
                        Call PBP("and catches " + Q$(3) + " heading home!")
                        Call CREDITREGPO(W%, D)
                    Else
                        'W% <> 2
                        Call PBP("and throws home to nail " + Q$(3) + "!")
                        Call CREDITASSIST(W%, D)
                        W% = 2
                        Call CREDITREGPO(W%, D)
                    End If

                    A5%(3) = 11

                    For I = 0 To 2: A5%(0) = 1: Next

                    '14122
                    Call ADDSTTS(P, D)
                    O%(0) = O%(0) + 1
                    O%(1) = O%(1) + 1
                    Call ADVANCEMENT(P, D, S2%, F%, I3)
                    Call CREDITPUTOUT(I3, FB2P%, AST%, D)
                    GoTo 13900

                End If

                If S4% = 7 And O%(0) < 2 Then
                    14128 '
                    A5%(3) = 11

                    If W% = 2 Then
                        Call PBP("He steps on home for one...")
                        Call CREDITREGPO(W%, D)
                        Call CREDITASSIST(W%, D)
                    Else
                        'W% <> 2
                        Call PBP("He throws home for the force")
                        Call CREDITASSIST(W%, D)
                        W% = 2
                        Call CREDITREGPO(W%, D)
                        Call CREDITASSIST(W%, D)
                    End If

                    Call ADVANCEMENT(P, D, S2%, F%, I3)
                    Call PBP("Back to first...")

                    A5%(0) = 11

                    Call ADVANCEMENT(P, D, S2%, F%, I3)
                    Call CREDITPUTOUT(I3, FB2P%, AST%, D)
                    Call PBP("DOUBLE PLAY!!")

                    O%(0) = O%(0) + 2
                    O%(1) = O%(1) + 2

                    Call ADDSTTS(P, D)

                    I5 = P1%(D)
                    I6 = 0

                    Call ADDPIT(D, I5, I6)

                    If O%(0) < 3 Then
                        A5%(2) = 1
                        A5%(1) = 1
                        Call ADVANCEMENT(P, D, S2%, F%, I3)
                    End If

                    GoTo 13900

                End If

                Call PBP("He throws to 2nd")
                Call CREDITASSIST(W%, D)

                A5%(1) = 11

                Call ADDSTTS(P, D)

                O%(0) = O%(0) + 1
                O%(1) = O%(1) + 1
                Call ADVANCEMENT(P, D, S2%, F%, I3)
                Call CREDITPUTOUT(I3, FB2P%, AST%, D)

                If O%(0) < 3 Then
                    A5%(0) = 11
                    Call CREDITASSIST(W%, D)

                    A5%(2) = 1

                    Call PBP("over to first...")
                    Call ADVANCEMENT(P, D, S2%, F%, I3)
                    Call PBP("DOUBLE PLAY!!")
                    Call CREDITPUTOUT(I3, FB2P%, AST%, D)

                    O%(0) = O%(0) + 1
                    O%(1) = O%(1) + 1
                    I5 = P1%(D)
                    I6 = 0
                    Call ADDPIT(D, I5, I6)
                End If

                GoTo 13900

            Else
                Call PBP(Q$(0) + " lays down the bunt...")
                Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
                Call PBP(Q$(4) + " makes a nice fielding play")
                Call CREDITASSIST(W%, D): A5%(0) = 11
                If SH = 1 And (S4% = 3 Or S4% = 6) Then A5%(3) = 11: For I = 0 To 2: A5%(I) = 1: Next

                '14122
                Call ADDSTTS(P, D)
                O%(0) = O%(0) + 1
                O%(1) = O%(1) + 1
                Call ADVANCEMENT(P, D, S2%, F%, I3)
                Call CREDITPUTOUT(I3, FB2P%, AST%, D)
                GoTo 13900
            End If

        Case 3
            Call LDRNRCTDN
            GoTo 13900

        Case 4
            14140 'SHGOOD
            Call PBP(Q$(0) + " lays down a good bunt...")
            Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
            Call PBP(Q$(4) + " makes a nice play")
            If S4% = 0 Then
                S2% = -12
                Call PBP(Q$(0) + " beats out an infield hit!")
                GoTo 13065
            End If

            14141 '
            I5 = P1%(D)
            I6 = 15

            Call ADDPIT(D, I5, I6)

            If B7%(P, B1!(P)) = 1 Then
                I5 = P1%(P): I6 = 40: Call INCPITOFF(P, I5, I6)
            Else
                I5 = B3%(P, B1!(P)): I6 = 18: Call INCBATOFF(P, I5, I6)
            End If

            I = Int(Rnd(1) * 100) + 1

            If S4% = 5 And SH = 2 And I > 98 Or I > 97 Then
                S2% = -12
                Call PBP(Q$(0) + " beats it out!")
                GoTo 13065
            End If

            A5%(0) = 11

            Call PBP("The only play is to first")

            I5 = P1%(D)
            I6 = 0

            Call ADDPIT(D, I5, I6)

            O%(0) = O%(0) + 1
            O%(1) = O%(1) + 1

            Call CREDITASSIST(W%, D)
            Call ADVANCEMENT(P, D, S2%, F%, I3)
            Call CREDITPUTOUT(I3, FB2P%, AST%, D)

            If O%(0) < 3 Then
                For I = 1 To 3: A5%(I) = 1: Next
                Call ADVANCEMENT(P, D, S2%, F%, I3)
            End If

            GoTo 13900

        Case 5
            14150 'C@3
            If SH = 1 Then 14160
            Call d100(RN)

            If B7%(P, B1!(P)) = 1 Then RR = 2
            If B7%(P, B1!(P)) <> 1 Then RR = B%(P, B3%(P, B1!(P)), 16)
            If INFPOS% > 0 Then RR = RR - 2
            If RR <= 2 Then RR = 2

            For I = 0 To 2
                If RN <= CF%(RR, I) Then Exit For
            Next

            Select Case I + 1
                Case 1
                    14156 If S4% > 0 Then 14157
                    Call PBP(Q$(0) + " drops it right down the line")
                    Call PBP(Q$(4) + " lets it roll...")
                    Call PBP(Q$(0) + " is trying for 2nd!!")
                    Call PBP(Q$(4) + " fields and throws too late!!")
                    Call PBP("You won't see that play very often")

                    A5%(0) = 2: I5 = P1%(D): I6 = 1: Call ADDPIT(D, I5, I6)
                    If B7%(P, B1!(P)) <> 1 Then I5 = B3%(P, B1!(P)): I6 = 1: Call INCBATOFF(P, I5, I6): I6 = 4: Call INCBATOFF(P, I5, I6): I6 = 0: Call INCBATOFF(P, I5, I6)
                    If B7%(P, B1!(P)) = 1 Then I5 = P1%(P): I6 = 23: Call INCPITOFF(P, I5, I6): I6 = 24: Call INCPITOFF(P, I5, I6): I6 = 27: Call INCPITOFF(P, I5, I6)
                    Call ADVANCEMENT(P, D, S2%, F%, I3)
                    Call SCOREBOARD
                    GoTo 13900

                Case 2
                    14157 S2% = 12
                    Call PBP(Q$(0) + " lays down a great bunt...")
                    Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
                    If F% = 1 Then 13900
                    Call PBP(Q$(4) + " fields... but too late!")
                    S2% = -12
                    GoTo 13065

                Case 3
                    14158 GoTo 14140

            End Select

        Case 6
            14160 'PLYLDBS
            If B7%(P, B1!(P)) = 1 Then RR = 2
            If B7%(P, B1!(P)) <> 1 Then RR = B%(P, B3%(P, B1!(P)), 16)
            If INFPOS% > 0 Then RR = RR - 2
            If RR <= 2 Then RR = 2
            If S4% = 0 Then 14150
            If S4% = 1 Then I3 = 1: J3$ = "2nd"
            If S4% = 2 Or S4% = 4 Then I3 = 2: J3$ = "3rd"
            If S4% = 3 Or S4% > 4 Then I3 = 3: J3$ = "home"

            Call PBP(Q$(0) + " gets the bunt down...")
            Call FLDERR(F%, W%, D, I3, SB%, S2%, P)

            If F% = 1 Then 13900

            Call PBP(Q$(4) + " fields it quickly...")
            Call PBP("Looks like a close play at " + J3$ + "!!")
            Call PBP("1- Throw to " + J3$ + " 2- Throw to 1st")

            If U6 = 2 Or U6 = 1 And P <> U9 Then
                I$ = "1"
            Else
                Do
                    I$ = GetKeyPress$
                    I5 = Val(I$)
                Loop Until I5 >= 1 And I5 <= 2
            End If

            14162 If I5 = 2 Then 14141

            Call d100(RN)
            For I = 0 To 1
                If RN <= LB%(RR, I) Then Exit For
            Next

            14163 '
            If I = 0 Then
                PLB = 1
                Call LDRNRCTDN
            Else
                Call PBP(Q$(4) + " throws to " + J3$ + "... SAFE!!")
                If B7%(P, B1!(P)) <> 1 Then I5 = B3%(P, B1!(P)): I6 = 0: Call INCBATOFF(P, I5, I6)
                If B7%(P, B1!(P)) = 1 Then I5 = P1%(P): I6 = 23: Call INCPITOFF(P, I5, I6)
                For I = 0 To 3: A5%(I) = 1: Next: Call ADVANCEMENT(P, D, S2%, F%, I3)
            End If

            GoTo 13900

        Case 7
            14170 'FLKSO
            Call d100(RN)

            If P%(D, P1%(D), 6) = 0 Then
                BR = 0
            Else
                BR = P%(D, P1%(D), 9) / P%(D, P1%(D), 6)
            End If

            14173 '
            If BR <= 4 Then PR = 5
            If BR > 4 And BR <= 5.4 Then PR = 4
            If BR > 5.4 And BR <= 6.9 Then PR = 3
            If BR > 6.9 And BR <= 8.4 Then PR = 2
            If BR > 8.4 And BR <= 11.9 Then PR = 1
            If BR > 11.9 Then PR = 0

            For I = 0 To 2
                If RN <= SO%(PR, I) Then Exit For
            Next

            Select Case I + 1

                Case 1
                    14172 GoTo 13601

                Case 2
                    '14175 U% = U% + 1
                    'IF U% = 3 THEN 13601
                    If usingGfx = 1 Then
                        'Print #9, "Calling gfx print from ~14173; usingGfx = "; Str$(usingGfx)
                        PrintOnGfx 64, 28, Str$(U%), imageScreen&
                    Else
                        Locate 2, 58: Print U%
                    End If
                    Call WINDEX

                    Call d100(RN)
                    F$ = Q$(0) + " "
                    If RN <= 13 Or SH = 1 And RN <= 42 Then F$ = F$ + "misses the pitch"
                    If RN > 13 And RN <= 42 And SH <> 1 Then F$ = F$ + "takes a called strike"
                    If RN > 42 Then F$ = F$ + "bunts it foul"
                    Call PBP(F$)

                    If U% = 3 Then 13601
                    If SH = 1 And RN <= 42 Then W% = 2: Call GETFIELDNAME(W%, D): GoTo 14111
                    If U% = 1 Then
                        Call PBP("He has" + Str$(U%) + " strike")
                    Else
                        'U% > 1
                        Call PBP("He has" + Str$(U%) + "strikes")
                    End If
                    Call PBP(F$)

                    If S4% = 4 Or S4% = 2 Then INFPOS% = 0

                    If usingGfx = 1 Then _PutImage (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 128), backupScreen&, imageScreen&, (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 128)

                    GoTo 15080

                Case 3
                    GoTo 14140

            End Select

        Case 8
            14180 'TFPLY
            Call PBP(Q$(0) + " lays down the bunt...")
            Call PBP(Q$(4) + " has a tough play")
            Call FLDERR(F%, W%, D, I3, SB%, S2%, P)

            If F% = 1 Then 13900
            If W% = 1 Then RR = 3
            If W% <> 1 Then RR = B%(D, B9%(D, W%), 17)
            If INFPOS% > 0 And S4% <> 0 Then RR = RR + 1 + L%(1, 10)
            If INFPOS% > 0 And S4% = 0 Then RR = RR + L%(1, 10)
            If INFPOS% = 0 And S4% = 0 Then RR = RR - 1
            If RR > 11 Then RR = 11
            If RR < 0 Then RR = 0

            Call d100(RN)

            For I = 0 To 2
                If RN <= TP%(RR, I) Then 14182
            Next

            14182 '
            Select Case I + 1
                Case 1:
                    14183 S2% = 12
                    Call PBP("but too late...base hit!")
                    GoTo 13065

                Case 2:
                    PLB = 1
                    Call LDRNRCTDN
                    GoTo 13900

                Case 3:
                    14185 GoTo 14141

            End Select

        Case 9
            14175 U% = U% + 1
            'IF U% = 3 THEN 13601
            If usingGfx = 1 Then
                'Print #9, "Calling gfx print from ~14175; usingGfx = "; Str$(usingGfx)
                PrintOnGfx 64, 28, Str$(U%), imageScreen&
            Else
                Locate 2, 58: Print U%
            End If

            Call WINDEX
            Call d100(RN)

            F$ = Q$(0) + " "
            If RN <= 13 Or SH = 1 And RN <= 42 Then F$ = F$ + "misses the pitch"
            If RN > 13 And RN <= 42 And SH <> 1 Then F$ = F$ + "takes a called strike"
            If RN > 42 Then F$ = F$ + "bunts it foul"
            Call PBP(F$)

            If U% = 3 Then
                GoTo 13601
            End If

            If SH = 1 And RN <= 42 Then W% = 2: Call GETFIELDNAME(W%, D): GoTo 14111
            If U% = 1 Then
                Call PBP("He has" + Str$(U%) + " strike")
            Else
                'U% > 1
                Call PBP("He has" + Str$(U%) + "strikes")
            End If

            If S4% = 4 Or S4% = 2 Then INFPOS% = 0

            If usingGfx = 1 Then _PutImage (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 128), backupScreen&, imageScreen&, (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 128)

            GoTo 15080

    End Select


    '-----


    14800 SH% = 0
    S2% = 16
    W% = 1
    Q$(4) = P$(D, P1%(D))

    Select Case S4%
        Case 0
            GoTo 15051
            'set a "skip" variable here

        Case 1, 5
            TGTBASE% = 2
            If P2 <> 2 Then
                Call WINDEX
                SB% = 1
                Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
                SB% = 0
                If F% = 1 Then
                    B1!(P) = B1!(P) - 1
                    Call WHOSON1ST(S4%)
                    GoTo 13900
                End If
            End If

        Case 2, 4
            TGTBASE% = 3
            If P2 <> 2 Then
                Call WINDEX
                SB% = 1
                Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
                SB% = 0
                If F% = 1 Then
                    B1!(P) = B1!(P) - 1
                    Call WHOSON1ST(S4%)
                    GoTo 13900
                End If
            End If

        Case 3, Is >= 6
            TGTBASE% = 4

    End Select

    14804 I2 = B3%(P, B0%(TGTBASE% - 1, 0))
    For I3 = 1 To 2
        A5%(I3) = 1
        A5%(3) = 0
    Next I3

    Call STEALCHANCE(AA, I2, TGTBASE%, CHANCE%)
    If B7%(P, B0%(TGTBASE% - 1, 0)) = 1 Then CHANCE% = 0
    If TGTBASE% = 4 Then CHANCE% = CHANCE% * .05: ' *** REDUCTION FOR STEALING HOME ***

    14809 If B%(P, I2, 14) > 0 Then Q0 = Int((B%(P, I2, 13) / (B%(P, I2, 13) + B%(P, I2, 14))) * 1000): GoTo 14813
    If B%(P, I2, 13) > 31 Then Q0 = 700 + ((B%(P, I2, 13) - 30) * 2): GoTo 14813
    If B%(P, I2, 13) > 10 Then Q0 = 600 + ((B%(P, I2, 13) - 10) * 10): GoTo 14813
    If B%(P, I2, 13) > 0 Then Q0 = 400 + ((B%(P, I2, 13) * 20))
    Q0 = 100

    14813 If B7%(P, B0%(TGTBASE% - 1, 0)) = 1 Then Q0 = 100

    Call STEAL3RD(TGTBASE%, AA, Q0, H0%, D) ' *** SUCCESS OF 3B STEAL ***

    If P%(D, P1%(D), 0) = 1 And TGTBASE% = 2 Then CHANCE% = CHANCE% + 25: Q0 = Q0 + 10
    If P%(D, P1%(D), 0) = -1 And TGTBASE% = 2 Then CHANCE% = CHANCE% - 50: Q0 = Q0 - 30
    If P2 = 2 Then
        14838 CHANCE% = 100: Q0 = Q0 - 200: W% = 2: Q$(4) = B$(D, B9%(D, 2))
        TGBASE% = B3%(P, B0%(TGTBASE% - 1, 0))
        B0%(TGTBASE% - 1, 2) = 18
        Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
        If F% = 1 Then I5 = TGBASE%: I6 = 9: Call INCBATOFF(P, I5, I6): B1!(P) = B1!(P) - 1: Call STRIKEOUTCS(SO): GoTo 13900
        GoTo 14827
    End If

    B0%(TGTBASE% - 1, 2) = B0%(TGTBASE% - 1, 2) + 1
    I4 = Int(Rnd(1) * 100) + 1

    If I4 > B0%(TGTBASE% - 1, 2) Then 14825

    S2% = 22: W% = 1: Q$(4) = P$(D, P1%(D))

    14820 '
    Call WINDEX
    Call PBP(Q$(TGTBASE% - 1) + " caught off base in a rundown!")

    A5%(1) = 0: A5%(2) = 0: A5%(3) = 0: A5%(TGTBASE% - 1) = 11
    O%(0) = O%(0) + 1: O%(1) = O%(1) + 1: Call PUTOUT(TGTBASE%, D, P)
    Call ADVANCEMENT(P, D, S2%, F%, I3): Call CREDITPUTOUT(I3, FB2P%, AST%, D)
    I5 = P1%(D): I6 = 0: Call ADDPIT(D, I5, I6)
    If O%(0) >= 3 Then B1!(P) = B1!(P) - 1: GoTo 13900
    INFPOS% = 0

    GoTo 15051


    '-----


    14825 'RUNNER HAS A CHANCE TO STEAL
    B0%(TGTBASE% - 1, 2) = B0%(TGTBASE% - 1, 2) + 17
    I9 = Int(Rnd(1) * 1000) + 1

    If I9 > CHANCE% * 1.388 And D5 <> 3 Then
        Call WINDEX
        Call NOJUMP(D)

        If usingGfx = 1 Then _PutImage (17 * FontColAdj%, 128)-Step(46 * FontColAdj%, 80), backupScreen&, imageScreen&, (17 * FontColAdj%, 128)-Step(46 * FontColAdj%, 80)

        GoTo 15085
    End If

    14826 '
    Call WINDEX
    TGBASE% = B3%(P, B0%(TGTBASE% - 1, 0))

    Y% = Int(Rnd(1) * 20) + 3090
    'Print #9, "Calling PBP from SOURCE, index "; Y%
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Call PBP(Y$)

    Y% = Int(Rnd(1) * 13) + 3110
    'Print #9, "Calling PBP from SOURCE, index "; Y%
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Call PBP(Y$)

    Call PITCHOUT(S4%, TGTBASE%, Q0)

    If S4% <> 5 Then 14888 ' *** DOUBLE STEAL ***1st&3rd

    If SH% = 1 Then
        I9 = Int(Rnd(1) * 1000) + 1
    Else
        If U6 = 2 Or U6 = 1 And P <> U9 Then
            I$ = "Y"
        Else
            Call PBP("Throw to 2B (YN) ")
            14886 I$ = GetKeyPress$
        End If

        14887 If UCase$(I$) <> "Y" Then PJ = 7: GoTo 14829

        14888 W% = 2: Q$(4) = B$(D, B9%(D, 2))
        Call FLDERR(F%, W%, D, I3, SB%, S2%, P)
        If F% = 1 Then I5 = TGBASE%: I6 = 9: Call INCBATOFF(P, I5, I6): Call PITSWAP(TGTBASE%): B1!(P) = B1!(P) - 1: GoTo 13900

        14827 Call WHICHRUNNER(TGTBASE%, S4%, D5)
        I9 = Int(Rnd(1) * 1000) + 1
        Q0 = Q0 - ((B%(D, B9%(D, 2), 15) - 5) * 25)
    End If

    14828 '
    RN = Int(Rnd(1) * 11) + 1
    If TGTBASE% <> 4 Then
        If RN = 1 Then F$ = B$(D, B9%(D, 2)) + " rifles it to " + H$(TGTBASE%)
        If RN = 2 Then F$ = B$(D, B9%(D, 2)) + " fires it to " + H$(TGTBASE%)
        If RN = 3 Then F$ = B$(D, B9%(D, 2)) + " unloads it"
        If RN = 4 Then F$ = B$(D, B9%(D, 2)) + " is up and firing"
        If RN = 5 Then F$ = B$(D, B9%(D, 2)) + " comes up firing"
        If RN = 6 Then F$ = B$(D, B9%(D, 2)) + " lets it fly"
        If RN = 7 Then F$ = B$(D, B9%(D, 2)) + " throws down"
        If RN = 8 Then F$ = B$(D, B9%(D, 2)) + " gets it off"
        If RN = 9 Then F$ = B$(D, B9%(D, 2)) + " fires a missile"
        If RN = 10 Then F$ = B$(D, B9%(D, 2)) + " throws quickly"
        If RN = 11 Then F$ = B$(D, B9%(D, 2)) + " throws"
        Call PBP(F$)
    End If

    14837 If B0%(TGTBASE% - 1, 2) = 18 And I9 > Q0 Or B0%(TGTBASE% - 1, 2) > 18 And I9 > Q0 - 200 Then 14830

    14829 RN = Int(Rnd(1) * 100) + 1
    If RN <= 20 Then F$ = "He beats the throw!"
    If RN > 20 And RN <= 40 Then F$ = "He's in there!"
    If RN > 40 And RN <= 50 Then F$ = "Throw is off-line..."
    If RN > 50 And RN <= 60 Then F$ = "Throw is high..."
    If RN > 60 And RN <= 80 Then F$ = "He slides under the tag!"
    If RN > 80 And TGTBASE% <> 4 Then F$ = U$(TGTBASE% + 1) + " with the call"
    If RN > 80 And TGTBASE% = 4 Then F$ = U$(1) + " with the call"
    Call PBP(F$)
    Call PBP("safe @ " + H$(TGTBASE%) + "!")

    B0%(TGTBASE% - 1, 2) = 0
    INFPOS% = 0
    Call PITSWAP(TGTBASE%): Call ADVANCEMENT(P, D, S2%, F%, I3)
    I5 = B9%(D, 2): I6 = 20: Call INCBATDF(D, I5, I6)

    If SH% <> 1 Then
        14892 '
        If Not (S4% <> 5 Or S4% = 5 And PJ = 7) Then
            PJ = 0
            TGTBASE% = 4
            SS% = Int(Rnd(1) * 20) + 1

            If SS% = 6 Then
                GoTo 14820
            Else
                GoTo 14831
            End If
        Else
            GoTo 14831
        End If
    Else
        SH% = 0
        GoTo 15051
    End If


    '-----


    14830 RN = Int(Rnd(1) * 100) + 1
    If RN <= 20 Then F$ = B$(D, B9%(D, 2)) + " nails " + Q$(TGTBASE% - 1)
    If RN > 20 And RN <= 40 Then F$ = Q$(TGTBASE% - 1) + " is pegged at " + H$(TGTBASE%)
    If RN > 40 And RN <= 60 Then F$ = "Great throw by " + B$(D, B9%(D, 2)) + "!!"
    If RN > 60 And RN <= 80 Then F$ = Q$(TGTBASE% - 1) + " slides into the tag"
    If RN > 80 And TGTBASE% <> 4 Then F$ = U$(TGTBASE% + 1) + " with the call"
    If RN > 80 And TGTBASE% = 4 Then F$ = U$(1) + " with the call"
    Call PBP(F$)

    A5%(TGTBASE% - 1) = 11
    INFPOS% = 0
    I5 = B3%(P, B0%(TGTBASE% - 1, 0))
    I6 = 10

    Call INCBATOFF(P, I5, I6)

    I5 = P1%(D)
    I6 = 0

    Call ADDPIT(D, I5, I6)

    O%(0) = O%(0) + 1
    O%(1) = O%(1) + 1
    W% = 2

    Call CREDITASSIST(W%, D)
    Call ADVANCEMENT(P, D, S2%, F%, I3)
    Call CREDITPUTOUT(I3, FB2P%, AST%, D)

    I5 = B9%(D, 2)
    I6 = 21

    Call INCBATDF(D, I5, I6)

    If O%(0) >= 3 Then B1!(P) = B1!(P) - 1: Call STRIKEOUTCS(SO): GoTo 13900

    14831 If O%(0) >= 3 Or P2 = 2 And U% = 3 Then 13900
    If SH% = 1 Then SH% = 0: GoTo 15051
    If AA < 20 Or S4% <> 5 Or B7%(P, B0%(3, 0)) = 1 Then 15051
    Call WINDEX

    If U6 = 2 Or U6 = 1 And P = U9 Then
        I$ = "N"
    Else
        Call PBP("TRY TO STEAL HOME (YN)")
        14834 I$ = GetKeyPress$
    End If

    14835 If UCase$(I$) <> "Y" Then 15051
    SH% = 1
    14890 TGTBASE% = 4: A5%(1) = 0: A5%(2) = 0: A5%(3) = 1
    I2 = B3%(P, B0%(TGTBASE% - 1, 0)): CHANCE% = 100
    Q0 = 700
    GoTo 14826 ' *** STEAL HOME ***


    '-----


    14900 '
    Cls
    If usingGfx = 0 Then Screen 0
    P9 = D
    B1!(P) = B1!(P) + 1
    U% = 0
    If B1!(P) = 10 Then B1!(P) = 1

    Color 15: Print "DOES "; B$(D, B3%(D, B9%(D, 0))); " STAY IN THE GAME (YN)"

    14902 I$ = GetKeyPress$
    If UCase$(I$) = "N" Then I5 = 77: GoTo 15504
    I5 = 66
    Locate 5, 1
    For I = 1 To 9:
        Color 3, 0
        If BP(P9) = I Then Color 9
        Locate I + 4, 5: Print Using "# "; I;
        If B7%(P9, I) = 1 And I5 = 66 Then Print B$(P9, B3%(P9, I));
        If B7%(P9, I) = 1 And I5 <> 66 Then Print P$(P9, B3%(P9, I));
        If B7%(P9, I) <> 1 Then Print B$(P9, B3%(P9, I));
        Print " "; C$(B7%(P9, I));
        Color 3
    Next I

    I5 = 0

    Color 15: Locate 3, 1: Print "WHAT LINEUP SLOT WILL THE PITCHER BAT IN (1-9)"

    14905 I$ = GetKeyPress$
    I2 = Val(I$)
    If I2 < 1 Or I2 > 9 Then 14905
    If B7%(D, I2) = 10 Then B7%(D, I2) = 1
    INFPOS% = 0
    B7%(D, B9%(D, 0)) = B7%(D, I2): B9%(D, B7%(D, B9%(D, 0))) = B3%(D, B9%(D, 0)): B7%(D, I2) = 1
    I7% = D: I8% = B9%(D, 0): I9% = B3%(D, B9%(D, 0))
    Call REPLACEMENTS(I7%, I8%, I9%)
    I5 = 66

    GoTo 15504


    '--------------------------------------
    '--- THESE DO NOT APPEAR TO BE USED ---
    '--------------------------------------
    If CGERA% > 0 And INNING% = 8 And P = 0 And S6%(1, 0) > S6%(0, 0) And P%(1, P1%(1), 1) > 0 And P6%(1) = 1 And Int(P%(1, P1%(1), 5) / P%(1, P1%(1), 1) * 100 + .5) <= 75 And Int(Rnd(1) * 100) + 1 <= Int(P%(1, P1%(1), 16) / P%(1, P1%(1), 1) * 100 + .5) Then I = 1: S8%(I, 0) = S8%(I, 0) + 6: S8%(I, 1) = 6

    If CGERA% > 0 And INNING% = 8 And P = 0 And S6%(0, 0) > S6%(1, 0) And P%(0, P1%(0), 1) > 0 And P6%(0) = 1 And Int(P%(0, P1%(0), 5) / P%(0, P1%(0), 1) * 100 + .5) <= 75 And Int(Rnd(1) * 100) + 1 <= Int(P%(0, P1%(0), 16) / P%(0, P1%(0), 1) * 100 + .5) Then I = 0: S8%(I, 0) = S8%(I, 0) + 6: S8%(I, 1) = 6

    If P%(1, P1%(1), 1) = 0 Or P6%(1) <> 1 Then 15002

    Call d100(RN)

    If CGERA% > 0 And INNING% = 8 And P = 0 And S6%(1, 0) >= S6%(0, 0) And Int(P%(1, P1%(1), 5) / P%(1, P1%(1), 1) * 100 + .5) > 75 And Int(P%(1, P1%(1), 5) / P%(1, P1%(1), 1) * 100 + .5) <= 100 And RN <= Int(P%(1, P1%(1), 16) / P%(1, P1%(1), 1) * 100 + .5) Then I = 1: S8%(I, 0) = S8%(I, 0) + 6: S8%(I, 1) = 6

    15002 If P%(0, P1%(0), 1) = 0 Or P6%(0) <> 1 Then 15003

    Call d100(RN)

    If CGERA% > 0 And INNING% = 8 And P = 0 And S6%(0, 0) >= S6%(1, 0) And Int(P%(0, P1%(0), 5) / P%(0, P1%(0), 1) * 100 + .5) > 75 And Int(P%(0, P1%(0), 5) / P%(0, P1%(0), 1) * 100 + .5) <= 100 And RN <= Int(P%(0, P1%(0), 16) / P%(0, P1%(0), 1) * 100 + .5) Then I = 0: S8%(I, 0) = S8%(I, 0) + 6: S8%(I, 1) = 6

    15003 If CGERA% > 0 And INNING% = 8 And P = 0 And (S6%(1, 0) >= S6%(0, 0) Or S6%(0, 0) - S6%(1, 0) <= 2) And P%(1, P1%(1), 1) > 0 And P6%(1) = 1 And Int(P%(1, P1%(1), 16) / P%(1, P1%(1), 1) * 100 + .5) > 100 Then I = 1: S8%(I, 0) = S8%(I, 0) + 6: S8%(I, 1) = 6

    If CGERA% > 0 And INNING% = 8 And P = 0 And (S6%(0, 0) >= S6%(1, 0) Or S6%(1, 0) - S6%(0, 0) <= 2) And P%(0, P1%(0), 1) > 0 And P6%(0) = 1 And Int(P%(0, P1%(0), 16) / P%(0, P1%(0), 1) * 100 + .5) > 100 Then I = 0: S8%(I, 0) = S8%(I, 0) + 6: S8%(I, 1) = 6
    '-----------------------------------

    15500 Cls
    If usingGfx = 1 Then Screen 0
    TG = 0
    PG = 0
    RG = 0
    Color 12: Print Tab(33); "PERSONNEL MENU": Print
    Color 14: Print "(0) ";: Color 15: Print "RESUME PLAY": Print
    Color 14: Print "(1) ";: Color 15: Print "RELIEF PITCHER": Print
    Color 14: Print "(2) ";: Color 15: Print "CHANGE BATTER/FIELDER"

    15501 '
    Do
        I$ = GetKeyPress$
        I = Val(I$)
        I5 = 0
    Loop Until I >= 0 And I <= 2

    Select Case I + 1

        Case 1
            15580 '
            For I = 1 To 9
                If B7%(P9, I) <> 1 Then
                    B%(P9, B3%(P9, I), 21) = 1
                End If
            Next I

            If usingGfx = 1 Then
                Call LOADSCREEN
                Call FLDDISP_G(BC%, P, U%, D)
            Else
                Call FLDDISP(BC%, P, U%, D)
            End If

            GoTo 15051

        Case 2
            15504 If P2 = 5 Then Call TIRING(P9): GoTo 15501

            15505 Call PITDISP(P9)
            Locate 23, 1: Print "SELECT RELIEVER (Z = NO CHANGE) ";
            If B9%(P9, 1) <> 99 Then Call TIRING(P9)
            Print

            15507 I$ = GetKeyPress$
            If UCase$(I$) = "Z" Then 15500
            Call LetterToNumber(I$)
            I1 = Val(I$): If I1 > 21 Then 15507
            If P%(P9, I1, 15) > 0 Then 15507
            Locate 23, 1: Print String$(78, 32): Locate 23, 1: Print P$(P9, I1); " "; B1$(P%(P9, I1, 0) + 2); " ";
            Print "ARE YOU SURE (YN)";

            15515 I$ = GetKeyPress$
            If UCase$(I$) = "N" Then 15505

            PPH = 0: PR% = 0

            If S1%(P9) <> -1 And P6%(P9) > 1 Then I5 = P1%(P9): I6 = 22: Call OFFPIT(P9, I5, I6)
            P1%(P9) = I1: P6%(P9) = P6%(P9) + 1: P%(P9, I1, 15) = P6%(P9): Call PITSTAM(P9): Call CHECKSAVE(D, P, S4%)

            15518 P9 = 1 - P9: W5 = P9: W6 = W5: VV(P9) = 1: VV1(P9) = 9
            Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)

            P9 = 1 - P9

            If DH% = 1 Or I5 = 66 Or I5 = 77 Then
                15538 '
                I5 = 0
                For V0 = 1 To 9
                    If B7%(D, V0) = 1 Or B7%(D, V0) = 10 Then
                        B3%(D, V0) = P1%(D)
                        B9%(D, 1) = P1%(D)
                        B7%(D, V0) = 1
                        P9 = D
                        W5 = D
                        W6 = D
                        VV(D) = V0
                        VV1(D) = V0

                        Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)

                        VV(D) = 1
                        VV1(D) = 9
                        GoTo 15500

                    End If

                Next V0

                GoTo 15540

            End If

            Cls
            Locate , 14: Color 14: Print "DO YOU WISH TO MAKE A FLIP FLOP OR DOUBLE SWITCH (YN)";
            Color 15

            15520 I$ = GetKeyPress$
            If UCase$(I$) = "N" Then 15538

            Cls
            Call BATDISP(PG, P9)

            15523 Call CHANGELINEUP(P9, P): Locate 12, 30: Print "LINEUP SLOT FOR PITCHER TO BAT IN (1-9)"

            15524 I$ = GetKeyPress$
            If Asc(I$) = 32 And PG = 0 Then PG = 1: Cls: Call BATDISP(PG, P9): GoTo 15523
            If Asc(I$) = 32 And PG = 1 Then PG = 0: Cls: Call BATDISP(PG, P9): GoTo 15523
            If Asc(I$) = 9 And TG = 0 Then Call DISPFLDG(PG, P9, TG): GoTo 15523
            If Asc(I$) = 9 And TG = 1 Then TG = 0: Call BATDISP(PG, P9): GoTo 15523
            V2 = Val(I$): If V2 < 1 Or V2 > 9 Then 15524

            15526 Locate 13, 30: Print "WHO WILL REPLACE "; B$(D, B3%(D, V2)); " @ "; C$(B7%(D, V2));

            15527 I$ = GetKeyPress$
            If Asc(I$) = 32 And PG = 0 Then PG = 1: Call BATDISP(PG, P9): GoTo 15526
            If Asc(I$) = 32 And PG = 1 Then PG = 0: Call BATDISP(PG, P9): GoTo 15526
            If Asc(I$) = 9 And TG = 0 Then Call DISPFLDG(PG, P9, TG): GoTo 15526
            If Asc(I$) = 9 And TG = 1 Then TG = 0: Call BATDISP(PG, P9): GoTo 15526
            Call LetterToNumber(I$): V3 = Val(I$): If V3 > 22 Then 15527
            Locate 16, 29: Print B$(D, V3)
            Locate 17, 29: Print "ARE YOU SURE (YN)";

            15531 I$ = GetKeyPress$
            If UCase$(I$) = "N" Then 15518

            D0%(D) = D0%(D) + 1: X0%(D, 0, D0%(D)) = V3: X0%(D, 1, D0%(D)) = B7%(D, V2)

            For V0 = 1 To 9
                If B7%(D, V0) = 1 Then X0%(D, 2, D0%(D)) = (V0 * 10) + (D0%(D) - 9)
            Next V0

            For V0 = 1 To 9
                If B7%(D, V0) = 1 Then B7%(D, V0) = B7%(D, V2): B3%(D, V0) = V3: B9%(D, B7%(D, V0)) = V3: P9 = D: W5 = D: W6 = D: VV(D) = V0: VV1(D) = V0: Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)
                VV(D) = 1: VV1(D) = 9
            Next V0

            B%(D, V3, 21) = 1
            I7% = D: I8% = V2: I9% = V3

            Call REPLACEMENTS(I7%, I8%, I9%)

            I5 = 0

            For V0 = 1 To 9
                If V0 = V2 Then B7%(D, V2) = 1: B3%(D, V2) = P1%(D): B9%(D, 1) = P1%(D): VV(D) = V0: VV1(D) = V0: Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)
            Next V0

            15537 '
            VV(D) = 1
            VV1(D) = 9
            GoTo 15500

        Case 3
            15540 Cls: Call BATDISP(PG, P9): Call CHANGELINEUP(P9, P)

            15546 Locate 14, 29: Color 12: Print "SELECT:"
            Locate , 30: Color 14: Print " (1) ";: Color 15: Print "SELECT A PINCH-HITTER"
            Locate , 30: Color 14: Print " (2) ";: Color 15: Print "SWAP POSITIONS BETWEEN PLAYERS"
            Locate , 30: Color 14: Print " (3) ";: Color 15: Print "SUBSTITUTE PLAYER IN LINEUP"
            Locate , 30: Color 14: Print " (Z) ";: Color 15: Print "RESUME PLAY"
            Locate , 30: Color 14: Print "<SPACE> ";: Color 15: Print "TOGGLE ROSTER";: Color 14: Print " <TAB> ";: Color 15: Print "TOGGLE FIELDING/BATTING"

            15547 I$ = GetKeyPress$
            If Asc(I$) = 32 And PG = 0 Then PG = 1: Call BATDISP(PG, P9): GoTo 15547
            If Asc(I$) = 32 And PG = 1 Then PG = 0: Call BATDISP(PG, P9): GoTo 15547
            'GoTo 15590

            15590 If Asc(I$) = 9 And TG = 0 Then Call DISPFLDG(PG, P9, TG): GoTo 15547
            If Asc(I$) = 9 And TG = 1 Then TG = 0: Call BATDISP(PG, P9): GoTo 15547
            If UCase$(I$) = "Z" Then 15500
            I1 = Val(I$): If I1 = 2 Then 15567
            If I1 = 3 Then 15550
            If D2 = 6 Then 15550
            I2 = B1!(P): GoTo 15555
            For I5 = 20 To 23: Locate I5, 28
                Print Space$(52)
            Next I5

            Return

    End Select


    15550 Locate 20, 30: Print "LINEUP SLOT TO REPLACE (1-9) (Z)=NO CHANGE"

    15552 I$ = GetKeyPress$
    If Asc(I$) = 32 And PG = 0 Then PG = 1: Call BATDISP(PG, P9): Call CHANGELINEUP(P9, P): GoTo 15552
    If Asc(I$) = 32 And PG = 1 Then PG = 0: Call BATDISP(PG, P9): Call CHANGELINEUP(P9, P): GoTo 15552
    If Asc(I$) = 9 And TG = 0 Then Call DISPFLDG(PG, P9, TG): Call CHANGELINEUP(P9, P): GoTo 15552
    If Asc(I$) = 9 And TG = 1 Then TG = 0: Call BATDISP(PG, P9): Call CHANGELINEUP(P9, P): GoTo 15552
    If UCase$(I$) = "Z" Then 15540
    I2 = Val(I$): If I2 < 1 Or I2 > 9 Or P9 = D And B7%(P9, I2) = 1 Then 15552
    Locate , 30
    If B7%(P9, I2) = 1 Then Print P$(P9, P1%(P9));
    If B7%(P9, I2) <> 1 Then Print B$(P9, B3%(P9, I2));

    15555 Locate 22, 30: Print "# OF SUB"

    15556 I$ = GetKeyPress$
    If Asc(I$) = 32 And PG = 0 Then PG = 1: Call BATDISP(PG, P9): Call CHANGELINEUP(P9, P): GoTo 15556
    If Asc(I$) = 32 And PG = 1 Then PG = 0: Call BATDISP(PG, P9): Call CHANGELINEUP(P9, P): GoTo 15556
    If Asc(I$) = 9 And TG = 0 Then Call DISPFLDG(PG, P9, TG): Call CHANGELINEUP(P9, P): GoTo 15556
    If Asc(I$) = 9 And TG = 1 Then TG = 0: Call BATDISP(PG, P9): Call CHANGELINEUP(P9, P): GoTo 15556
    Call LetterToNumber(I$): I1 = Val(I$): If I1 > 22 Then 15555
    If B%(P9, I1, 21) > 0 Then 15555
    Locate 23, 30: Print B$(P9, I1); "... ARE YOU SURE (YN)"

    15560 I$ = GetKeyPress$
    If UCase$(I$) = "N" Then 15540
    B%(P9, I1, 21) = 1: B3%(P9, I2) = I1: B9%(P9, B7%(P9, I2)) = I1
    If B7%(P9, I2) = 1 Or B7%(P9, I2) = 10 Then B9%(P9, 1) = 99: B9%(P9, 0) = I2: B7%(P9, I2) = 10
    D0%(P9) = D0%(P9) + 1: X0%(P9, 0, D0%(P9)) = B3%(P9, I2)
    X0%(P9, 1, D0%(P9)) = B7%(P9, I2): X0%(P9, 2, D0%(P9)) = (I2 * 10) + (D0%(P9) - 9)
    W5 = P9: W6 = P9: VV(P9) = I2: VV1(P9) = I2
    I7% = P9: I8% = I2: I9% = I1

    Call REPLACEMENTS(I7%, I8%, I9%)
    Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)

    VV(P9) = 1
    VV1(P9) = 9

    GoTo 15540


    '-----


    15567 Locate 20, 29: Print "B.O. #1 (1-9)"

    15568 I$ = GetKeyPress$
    I1 = Val(I$): If I1 < 1 Or I1 > 9 Then 15568
    If B7%(P9, I1) = 1 Then 15568
    Locate 21, 29: Print "B.O. #2 (1-9)"

    15572 I$ = GetKeyPress$
    I2 = Val(I$): If I2 < 1 Or I2 > 9 Then 15572
    If B7%(P9, I2) = 1 Then 15572
    I3 = B7%(P9, I2): B7%(P9, I2) = B7%(P9, I1): B7%(P9, I1) = I3
    B9%(P9, B7%(P9, I1)) = B3%(P9, I1)
    B9%(P9, B7%(P9, I2)) = B3%(P9, I2)
    I7% = P9: I8% = I2: I9% = B3%(P9, I2)
    Call REPLACEMENTS(I7%, I8%, I9%)
    I7% = P9: I8% = I1: I9% = B3%(P9, I1)
    Call REPLACEMENTS(I7%, I8%, I9%)
    GoTo 15540


    '----------------------------------------
    '           END OF GAME!!!
    '----------------------------------------

    18500 '
    'Locate 22, 1
    'Print winning team and score
    If S6%(0, 0) > S6%(1, 0) Then
        Call PBP(A$(0) + " defeats " + A$(1) + Str$(S6%(0, 0)) + " TO" + Str$(S6%(1, 0)) + "!")
    Else
        Call PBP(A$(1) + " defeats " + A$(0) + Str$(S6%(1, 0)) + " TO" + Str$(S6%(0, 0)) + "!")
    End If

    normalFinish% = 1

    If AP% <> 1 Or U6 <> 2 Then
        'displayPause! = 1
        Call PBP("PRESS ANY KEY TO CONTINUE")
        I$ = GetKeyPress$
    End If

    Call EndOfGame
    End


    '----------------------------------------


    18700 H0% = 0
    If usingGfx = 1 Then
        Call HOLDSTATUS_G(H0%)
    Else
        Call HOLDSTATUS(H0%)
    End If
    A1 = S6%(D, 0) - S6%(P, 0)
    If A1 > 1 Or S4% = 3 Or S4% >= 6 Then 18800
    If S4% <> 1 And S4% <> 5 Then I2 = 2: GoTo 18800
    I2 = 1
    J = B0%(I2, 0): If J = 0 Then 18800
    If B7%(P, J) = 1 Then 18800
    If B7%(P, J) <> 1 And B%(P, B3%(P, J), 13) >= 10 Then
        H0% = 1
        If usingGfx = 1 Then
            Call HOLDSTATUS_G(H0%)
        Else
            Call HOLDSTATUS(H0%)
        End If
    End If

    18800 If SU%(D, 0) <> -1 And MG%(D, 589) = 0 And INNING% = MG%(D, 588) Then Call PITSTRAT
    If SU%(D, 1) <> -1 And MG%(D, 589) = 0 And INNING% > MG%(D, 588) Then Call PITSTRAT
    If SU%(D, 1) <> -1 And MG%(D, 589) <> 0 And INNING% >= MG%(D, 588) Then Call PITSTRAT

    If PZ = 1 Then PZ = 0: GoTo 15055
    A1 = S6%(D, 0) - S6%(P, 0)
    Call d100(RN)
    If INNING% < 9 Or CZ%(D) = -1 Or MG%(D, 581) = 999 Then 18725

    CZ%(D) = -1
    If A1 > 3 Or A1 < 0 Then 18725
    If P6%(D) <> 1 Then 18730
    If S6%(P, 0) = 0 And P%(D, P1%(D), 5) > 0 And RN <= Int(P%(D, P1%(D), 16) / P%(D, P1%(D), 5) * 100 + .5) + 10 Then 18725
    If P%(D, P1%(D), 5) > 0 And RN <= Int(P%(D, P1%(D), 16) / P%(D, P1%(D), 5) * 100 + .5) Then 18725
    If CGERA% > 0 And INNING% > 7 And S6%(D, 0) > S6%(P, 0) And P%(D, P1%(D), 1) > 0 And P6%(D) = 1 And Int(P%(D, P1%(D), 16) / P%(D, P1%(D), 1) * 100 + .5) <= 100 And Int(Rnd(1) * 100) + 1 <= Int(P%(D, P1%(D), 16) / P%(D, P1%(D), 1) * 100 + .5) Then 18725
    If CGERA% > 0 And INNING% > 7 And (S6%(D, 0) >= S6%(P, 0) Or S6%(P, 0) - S6%(D, 0) <= 2) And P%(D, P1%(D), 1) > 0 And P6%(D) = 1 And Int(P%(D, P1%(D), 16) / P%(D, P1%(D), 1) * 100 + .5) >= 100 Then 18725
    If CGERA% >= 8 Then 18725

    GK%(D) = 1
    GoTo 18725


    '-----


    18730 Call d100(RN)
    If RN <= 80 And P%(D, P1%(D), 3) < 15 Then GK%(D) = 1

    18725 If GK%(D) = 1 Then
        GK%(D) = 0
        Call RELIEVERS
        If usingGfx = 1 Then _PutImage (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 128), backupScreen&, imageScreen&, (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 128)
        GoTo 15055
    End If

    If B7%(P, B1!(P)) = 1 Then BR = 0
    If B7%(P, B1!(P)) <> 1 Then BR = B%(P, B3%(P, B1!(P)), 30)

    If P%(P, P1%(P), 11) <> 999 Then

        If I > 1 Then
            ' Variable I sometimes has a value of 3 or 4
            ' It's likely meant to resemble something else
            ' but used for several loops as well

            ' In the original game context, it may have ended
            ' up just getting 0 ?!?!
            Open "errlog" For Append As #9
            Print #9, "An error is about to happen"
            Print #9, "I -      "; I
            Print #9, "P -      "; P
            Print #9, "P1%(0) - "; P1%(0)
            Print #9, "P1%(1) - "; P1%(1)
            Print #9, ""
            Close #9
        End If

        I7! = P%(I, P1%(I), 11)
    Else
        If P%(P, P1%(P), 20) = 0 Then
            I7! = 0
        Else
            I7! = Int((P%(P, P1%(P), 22) / P%(P, P1%(P), 20) * 1000 + .5))
        End If
    End If

    18726 D2 = 1
    If INFPOS% > 0 Then 18820
    If MG%(D, 690) <> 999 Then 18801

    ' PROFILE INFIELD IN WITH 3RD OCCUPIED
    If S4% < 3 Or S4% = 4 Then 18801
    Call d100(RN)
    If O%(0) = 0 And A1 >= MG%(D, 691) * -1 And A1 <= MG%(D, 692) * -1 And INNING% >= MG%(D, 693) And RN <= MG%(D, 694) Then INFPOS% = 2: D2 = 3: GoTo 15055
    If O%(0) = 0 And A1 >= MG%(D, 695) * -1 And A1 <= MG%(D, 696) * -1 And INNING% >= MG%(D, 697) And RN <= MG%(D, 698) Then INFPOS% = 2: D2 = 3: GoTo 15055
    If O%(0) = 1 And (S4% = 5 Or S4% = 7) And A1 >= MG%(D, 699) * -1 And A1 <= MG%(D, 700) * -1 And INNING% >= MG%(D, 701) And RN <= MG%(D, 702) Then INFPOS% = 2: D2 = 3: GoTo 15055
    If O%(0) = 1 And (S4% = 5 Or S4% = 7) And A1 >= MG%(D, 703) * -1 And A1 <= MG%(D, 704) * -1 And INNING% >= MG%(D, 705) And RN <= MG%(D, 706) Then INFPOS% = 2: D2 = 3: GoTo 15055

    18801 If MG%(D, 707) <> 999 Then 18802
    If S4% <> 0 Then 18802
    Call d100(RN)

    ' PROFILE CORNERS IN AGAINST A BUNT HIT
    If BR >= MG%(D, 708) And RN <= MG%(D, 709) Or BR >= MG%(D, 710) And RN <= MG%(D, 711) Or BR >= MG%(D, 712) And RN <= MG%(D, 713) Then 18811

    18802 If MG%(D, 714) <> 999 Or B7%(P, B1!(P)) = 1 Then 18803
    If O%(0) <> 0 Then 18803
    If S4% <> 1 And S4% <> 4 Then 18803

    ' PROFILE CORNERS IN VS HITTER IN SAC BUNT SITUATION
    Call d100(RN)
    If A1 <= MG%(D, 715) And A1 >= MG%(D, 716) * -1 And S4% = 1 And BR >= MG%(D, 717) And RN <= MG%(D, 718) Then 18811
    If A1 <= MG%(D, 719) And A1 >= MG%(D, 720) * -1 And S4% = 1 And BR >= MG%(D, 721) And RN <= MG%(D, 722) Then 18811
    If A1 <= MG%(D, 723) And A1 >= MG%(D, 724) * -1 And S4% = 4 And BR >= MG%(D, 725) And RN <= MG%(D, 726) Then 18811
    If A1 <= MG%(D, 727) And A1 >= MG%(D, 728) * -1 And S4% = 4 And BR >= MG%(D, 729) And RN <= MG%(D, 730) Then 18811

    18803 If MG%(D, 731) <> 999 Or B7%(P, B1!(P)) <> 1 Or O%(0) = 2 Then 18804
    If S4% <> 1 And S4% <> 2 And S4% <> 4 Then 18804

    ' PROFILE CORNERS IN VS A PITCHER IN SAC BUNT SITUATION
    Call d100(RN)
    If I7! <= MG%(D, 732) And RN <= MG%(D, 733) And S4% = 1 And O%(0) <= 1 Then 18811
    If I7! <= MG%(D, 734) And RN <= MG%(D, 735) And S4% = 1 And O%(0) <= 1 Then 18811
    If I7! <= MG%(D, 736) And RN <= MG%(D, 737) And (S4% = 2 Or S4% = 4) And O%(0) = 0 Then 18811
    If I7! <= MG%(D, 738) And RN <= MG%(D, 739) And (S4% = 2 Or S4% = 4) And O%(0) = 0 Then 18811

    18804 If MG%(D, 740) <> 999 Then 18805
    If O%(0) = 2 Or S4% <> 3 And S4% < 5 Then 18805

    ' PROFILE CORNERS IN FOR A SQUEEZE
    Call d100(RN)
    If O%(0) = 0 And A1 <= MG%(D, 741) And A1 >= MG%(D, 742) And BR >= MG%(D, 743) And RN <= MG%(D, 744) Then 18811
    If O%(0) = 1 And A1 <= MG%(D, 745) And A1 >= MG%(D, 746) And BR >= MG%(D, 747) And RN <= MG%(D, 748) Then 18811

    18805 If MG%(D, 756) <> 999 Then 18806
    If S4% = 1 Or S4% = 4 Or S4% = 5 Or S4% = 7 Then 18806
    MOB% = 0
    For I = 1 To 3
        If B0%(I, 0) > 0 Then MOB% = MOB% + 1
    Next

    If A1 + MOB% + 1 >= 0 Then 18806: ' BATTER NOT TYING OR WINNING RUN
    Call d100(RN)

    If B%(P, B3%(P, B1!(P)), 4) = 0 Then I7! = 0: I6! = 0: GoTo 18806
    I6! = Int((B%(P, B3%(P, B1!(P)), 6) + B%(P, B3%(P, B1!(P)), 7) + B%(P, B3%(P, B1!(P)), 8) * 2 + B%(P, B3%(P, B1!(P)), 9) * 3) / B%(P, B3%(P, B1!(P)), 4) * 1000 + .5)
    If I6! <= MG%(D, 757) And INNING% >= MG%(D, 758) And RN <= MG%(D, 759) Then D2 = 8: GoTo 18850
    If I6! <= MG%(D, 760) And INNING% >= MG%(D, 761) And RN <= MG%(D, 762) Then D2 = 8: GoTo 18850
    If I6! <= MG%(D, 763) And INNING% >= MG%(D, 764) And RN <= MG%(D, 765) Then D2 = 8: GoTo 18850

    18806 A1 = S6%(D, 0) - S6%(P, 0)
    If A1 >= -1 And A1 <= 1 And INNING% >= 8 And (S4% = 3 Or S4% >= 5) And O%(0) < 2 Then 18809

    If A1 > 0 Or O%(0) > 0 Or S4% <= 2 Or S4% = 4 Or S4% = 5 And O%(0) = 1 Or INNING% <= 5 And A1 < -2 Or INNING% > 5 And A1 < -4 Then
        18810 If S4% = 0 Or S4% = 2 Or S4% = 3 Or S4% >= 5 Or O%(0) = 2 Or B1!(P) >= 3 And B1!(P) <= 6 Or INNING% <= 6 And A1 >= 3 Or INNING% <= 6 And A1 <= -3 Then 18820
        If INNING% > 7 And A1 >= 1 Or INNING% > 7 And A1 < -1 Then 18820

        18811 INFPOS% = 1: D2 = 4
    Else
        18809 '
        INFPOS% = 2: D2 = 3
    End If

    GoTo 15055


    '-----


    18820 If A1 <= 0 Or A1 = 0 And S4% <= 1 Or A1 = 0 And S4% = 4 Or S4% = 7 Or B7%(P, B1!(P)) = 1 Then 18850
    If INNING% >= 9 And P = 1 And O%(0) < 2 And A1 = 0 And S4% >= 2 And S4% <= 3 Or INNING% >= 9 And P = 1 And O%(0) = 2 And A1 = 0 And S4% >= 5 And S4% <= 6 Then
        '18835
        D2 = 2
        GoTo 15058
    End If

    I = B4%(P, 0, B1!(P)): I1 = B4%(P, 3, B1!(P)): If B1!(P) = 9 Then I2 = B4%(P, 0, 0): I3 = B4%(P, 3, 0)

    If B1!(P) < 9 Then I2 = B4%(P, 0, B1!(P) + 1): I3 = B4%(P, 3, B1!(P) + 1)
    If S4% <> 2 And S4% <> 6 Then 18850

    If I - I2 >= 50 And I1 - I3 >= 50 And A1 < 1 And INNING% > 8 Or I >= 280 And I1 >= 140 And INNING% > 8 And I1 > I3 And A1 < 1 Then
        D2 = 2
        GoTo 15058
    Else
        GoTo 18850
    End If


    '-----


    18850 If (S8%(D, 0) <= P8%(D, P1%(D), 4) + P8%(D, P1%(D), 1) And S8%(D, 1) <= P8%(D, P1%(D), 2)) Or B9%(D, 1) = 99 Then
        Call RELIEVERS
        If usingGfx = 1 Then _PutImage (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 128), backupScreen&, imageScreen&, (20 * FontColAdj%, 48)-Step(44 * FontColAdj%, 128)
    End If

    GoTo 15055


    '-----


    18900 JM = B3%(P, B1!(P))
    If PPH = 1 Then 18905
    A1 = S6%(P, 0) - S6%(D, 0)
    If B7%(P, B1!(P)) <> 1 Then 18906
    For I = 0 To 21
        If P%(P, I, 15) = 0 Then 18903
    Next

    GoTo 18941


    '-----


    18903 If MG%(P, 590) = 999 Then 18985
    If INNING% > 4 And INNING% < 7 And A1 < -2 And S6%(P, 0) > 0 Then 18930
    If INNING% > 4 And INNING% < 7 And A1 < -3 Then 18930
    If INNING% > 6 And A1 < 0 Or A1 = 0 And INNING% > 6 And INNING% < 9 And S4% > 1 Then 18930
    If A1 = 0 And INNING% >= 9 And S4% > 0 Or A1 = 0 And INNING% >= 9 And O%(0) = 0 Then 18930
    If P%(P, P1%(P), 6) / P%(P, P1%(P), 4) <= 2 And P8%(P, P1%(P), 0) >= 6 Then 18930

    18905 GoTo 18941


    '-----


    18906 If MG%(P, 847) = 999 Then 18991
    If B%(P, JM, 4) = 0 Then 18909
    If B%(P, JM, 6) / B%(P, JM, 4) * 1000 > 233 Or B%(P, JM, 9) >= 15 Then 18908
    If INNING% > 6 And A1 < -2 Or A1 <= 0 And INNING% >= 8 Or A1 = 0 And INNING% >= 9 Then 18909

    18908 GoTo 18941


    '-----


    18909 'GET A PINCH HITTER FOR A POSITION PLAYER
    If MG%(P, 540) = 999 Then
        18993 'SELECT PH FOR HITTER
        For I = 0 To 22
            If B%(P, I, 21) <= 0 And B$(P, I) <> "XXX" Then

                If B7%(P, B1!(P)) = B%(P, I, 22) Or B7%(P, B1!(P)) = B%(P, I, 23) Or B7%(P, B1!(P)) = B%(P, I, 24) Or B7%(P, B1!(P)) = B%(P, I, 25) Then

                    I = P%(D, P1%(D), 0)
                    I1 = 6
                    If I < 0 Then I1 = 1

                    For I = I1 To I1 + 4
                        If MG%(P, I1 + 540) <> -1 And B%(P, MG%(P, I1 + 540), 21) = 0 Then
                            I = MG%(P, I1 + 540)
                            MG%(P, I1 + 540) = -1
                            GoTo 18916
                        End If
                    Next

                End If

            End If

        Next

    End If

    18935 '
    For I = 0 To 22:
        If B%(P, I, 21) > 0 Or B$(P, I) = "XXX" Or B%(P, I, 4) = 0 Then 18917
        If B7%(P, B1!(P)) <> B%(P, I, 22) And B7%(P, B1!(P)) <> B%(P, I, 23) And B7%(P, B1!(P)) <> B%(P, I, 24) And B7%(P, B1!(P)) <> B%(P, I, 25) Then 18917

        If P%(D, P1%(D), 0) = 1 And B%(P, I, 0) > 0 And B%(P, I, 6) / B%(P, I, 4) * 1000 > B%(P, JM, 6) / B%(P, JM, 4) * 1000 + 35 Then 18916
        If P%(D, P1%(D), 0) = -1 And B%(P, I, 0) < 0 And B%(P, I, 6) / B%(P, I, 4) * 1000 > B%(P, JM, 6) / B%(P, JM, 4) * 1000 + 45 Then 18916

        If B%(P, I, 0) = 0 And B%(P, I, 6) / B%(P, I, 4) * 1000 > B%(P, JM, 6) / B%(P, JM, 4) * 1000 + 30 Then 18916
        GoTo 18917

        18916 PPH = 1: D0%(P) = D0%(P) + 1: X0%(P, 0, D0%(P)) = I: X0%(P, 1, D0%(P)) = B7%(P, B1!(P)): X0%(P, 2, D0%(P)) = (B1!(P) * 10) + (D0%(P) - 9)
        18919 B%(P, I, 21) = 1: B3%(P, B1!(P)) = I: B9%(P, B7%(P, B1!(P))) = I
        If B7%(P, B1!(P)) = 1 Or B7%(P, B1!(P)) = 10 Then B9%(P, 1) = 99: B9%(P, 0) = B1!(P): B7%(P, B1!(P)) = 10
        I7% = P: I8% = B1!(P): I9% = B3%(P, B1!(P))
        Call REPLACEMENTS(I7%, I8%, I9%)
        GoTo 18938

    18917 Next I

    GoTo 18941


    '-----


    18930 'GET A PINCH HITTER FOR THE PITCHER
    If MG%(P, 540) = 999 Then
        18990 'SELECT PH FOR PITCHER
        I = P%(D, P1%(D), 0)
        I1 = 6

        If I < 0 Then I1 = 1

        For I = I1 To I1 + 4
            If MG%(P, I1 + 540) <> -1 And B%(P, MG%(P, I1 + 540), 21) = 0 Then PH% = MG%(P, I1 + 540): MG%(P, I1 + 540) = -1: GoTo 18934
        Next

    End If

    18933 J% = 0: GP% = 0

    If CGERA% > 1 And INNING% < 4 Then 18941
    If CGERA% > 2 And INNING% < 7 Then 18941
    If CGERA% > 3 And INNING% < 9 Then 18941
    If CGERA% >= 8 Then 18941
    If CGERA% > 0 And INNING% > 7 And S6%(P, 0) > S6%(D, 0) And P%(P, P1%(P), 1) > 0 And P6%(P) = 1 And Int(P%(P, P1%(P), 16) / P%(P, P1%(P), 1) * 100 + .5) <= 100 And Int(Rnd(1) * 100) + 1 <= Int(P%(P, P1%(P), 16) / P%(P, P1%(P), 1) * 100 + .5) Then 18941
    If CGERA% > 0 And INNING% > 7 And (S6%(P, 0) >= S6%(D, 0) Or S6%(D, 0) - S6%(P, 0) <= 2) And P%(P, P1%(P), 1) > 0 And P6%(P) = 1 And Int(P%(P, P1%(P), 16) / P%(P, P1%(P), 1) * 100 + .5) >= 100 Then 18941

    For Idx = 0 To 22
        If B$(P, Idx) = "XXX" Or B%(P, Idx, 21) > 0 Or B%(P, Idx, 4) = 0 Then 18932
        If B%(P, Idx, 0) > 0 And P%(D, P1%(D), 0) = 1 Or B%(P, Idx, 0) < 0 And P%(D, P1%(D), 0) = -1 Then
            PH%(J%, 0) = Int(B%(P, Idx, 3) / 4 + .5)
        Else
            PH%(J%, 0) = B%(P, Idx, 3)
        End If
        PH%(J%, 1) = Idx: GP% = GP% + PH%(J%, 0): J% = J% + 1

    18932 Next
    If J% <> 0 Then

        RN = Int(Rnd(1) * GP%) + 1

        For I = 0 To J% - 1
            If RN <= PH%(I, 0) Then PH% = PH%(I, 1): GoTo 18934
            PH%(I + 1, 0) = PH%(I, 0) + PH%(I + 1, 0)
        Next

    End If

    GoTo 18941


    '--- this could maybe be a subroutine? ---
    18934 I = PH%: PPH = 1: D0%(P) = D0%(P) + 1
    X0%(P, 0, D0%(P)) = I
    X0%(P, 1, D0%(P)) = 10
    X0%(P, 2, D0%(P)) = 81 + D0%(P)
    B%(P, I, 21) = 1: B3%(P, B1!(P)) = I
    If B7%(P, B1!(P)) = 1 Or B7%(P, B1!(P)) = 10 Then B9%(P, 1) = 99: B9%(P, 0) = B1!(P): B7%(P, B1!(P)) = 10

    18938 P9 = P: W5 = P9: W6 = P9: VV(P9) = B1!(P): VV1(P9) = B1!(P)
    Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)
    If usingGfx = 1 Then
        Call FLDDISP_G(BC%, P, U%, D)
        Call MAINSCREEN_G(D, P, BC%, U%, MO)
    Else
        Call FLDDISP(BC%, P, U%, D)
        Call MAINSCREEN(D, P, BC%, U%, MO)
    End If

    VV(P9) = 1
    VV1(P9) = 9

    Q$(0) = B$(P, B3%(P, B1!(P)))

    If B7%(P, B1!(P)) = 1 Then Q$(0) = P$(P, P1%(D))
    Call WINDEX
    Call PBP(M$(P) + " is sending up a pinch hitter")
    PPH = 1

    GoTo 15052


    '-----


    18941 If PR% <> 1 Then Call PINCHRUNNER(MS%, A1, S4%, I2, P, PR%, BC%, U%, D, MO)
    If MS% = 1 Then MS% = 0: GoTo 15052

    18971 If B7%(P, B1!(P)) = 1 Then BR = 0
    If B7%(P, B1!(P)) <> 1 Then BR = B%(P, B3%(P, B1!(P)), 30)
    Call d100(RN)
    If S4% = 0 And (INFPOS% > 0 And RN <= 5 Or INFPOS% = 0 And RN <= 5) And BR > 8 Then P2 = 4: GoTo 14100

    ' MANAGER PROFILE TO HIT AND RUN
    Call d100(RN)
    If S4% = 0 Or MG%(P, 671) <> 999 Or B7%(P, B1!(P)) = 1 Then 18945
    If B%(P, B3%(P, B1!(P)), 4) = 0 Then I7! = 0 Else I7! = Int((B%(P, B3%(P, B1!(P)), 6) + B%(P, B3%(P, B1!(P)), 7) + B%(P, B3%(P, B1!(P)), 8) * 2 + B%(P, B3%(P, B1!(P)), 9) * 3) / B%(P, B3%(P, B1!(P)), 4) * 1000 + .5)
    If B%(P, B3%(P, B1!(P)), 12) = 0 Then I6! = 0 Else I6! = Int(B%(P, B3%(P, B1!(P)), 4) / B%(P, B3%(P, B1!(P)), 12) + .5)

    18949 If S4% = 1 And O%(0) = 0 And A1 <= MG%(P, 672) And A1 >= MG%(P, 673) * -1 And RN <= MG%(P, 674) And I7! <= MG%(P, 872) And I6! >= MG%(P, 866) Then P2 = 2: GoTo 15067
    If S4% = 1 And O%(0) = 1 And A1 <= MG%(P, 675) And A1 >= MG%(P, 676) * -1 And RN <= MG%(P, 677) And I7! <= MG%(P, 873) And I6! >= MG%(P, 867) Then P2 = 2: GoTo 15067
    If S4% = 5 And O%(0) = 0 And A1 <= MG%(P, 678) And A1 >= MG%(P, 679) * -1 And RN <= MG%(P, 680) And I7! <= MG%(P, 874) And I6! >= MG%(P, 868) Then P2 = 2: GoTo 15067
    If S4% = 5 And O%(0) = 1 And A1 <= MG%(P, 681) And A1 >= MG%(P, 682) * -1 And RN <= MG%(P, 683) And I7! <= MG%(P, 875) And I6! >= MG%(P, 869) Then P2 = 2: GoTo 15067
    If S4% = 4 And O%(0) = 0 And A1 <= MG%(P, 684) And A1 >= MG%(P, 685) * -1 And RN <= MG%(P, 686) And I7! <= MG%(P, 876) And I6! >= MG%(P, 870) Then P2 = 2: GoTo 15067
    If S4% = 4 And O%(0) = 1 And A1 <= MG%(P, 687) And A1 >= MG%(P, 688) * -1 And RN <= MG%(P, 689) And I7! <= MG%(P, 877) And I6! >= MG%(P, 871) Then P2 = 2: GoTo 15067

    18945 If MG%(P, 609) <> 999 Or B7%(P, B1!(P)) <> 1 Then 18946
    If S4% <> 1 And S4% <> 2 And S4% <> 4 Then 18946
    Call d100(RN)
    If S4% = 1 And INNING% <= 7 And MG%(P, 610) >= O%(0) And A1 <= MG%(P, 611) And A1 >= MG%(P, 612) * -1 And RN <= MG%(P, 613) Then 18970
    If S4% = 1 And INNING% > 7 And MG%(P, 614) >= O%(0) And A1 <= MG%(P, 615) And A1 >= MG%(P, 616) * -1 And RN <= MG%(P, 617) Then 18970
    If S4% = 2 And INNING% <= 7 And MG%(P, 618) >= O%(0) And A1 <= MG%(P, 619) And A1 >= MG%(P, 620) * -1 And RN <= MG%(P, 621) Then 18970
    If S4% = 2 And INNING% > 7 And MG%(P, 622) >= O%(0) And A1 <= MG%(P, 623) And A1 >= MG%(P, 624) * -1 And RN <= MG%(P, 625) Then 18970
    If S4% = 4 And INNING% <= 7 And MG%(P, 626) >= O%(0) And A1 <= MG%(P, 627) And A1 >= MG%(P, 628) * -1 And RN <= MG%(P, 629) Then 18970
    If S4% = 4 And INNING% > 7 And MG%(P, 630) >= O%(0) And A1 <= MG%(P, 631) And A1 >= MG%(P, 632) * -1 And RN <= MG%(P, 633) Then 18970

    18946 '
    If MG%(P, 634) = 999 And B7%(P, B1!(P)) <> 1 And O%(0) = 0 Or (S4% <> 1 And S4% <> 2 And S4% <> 4) Then

        If B%(P, B3%(P, B1!(P)), 4) = 0 Then
            I7! = 0
            I6! = 0
        Else
            I7! = Int(B%(P, B3%(P, B1!(P)), 6) / B%(P, B3%(P, B1!(P)), 4) * 1000 + .5)
            I6! = Int((B%(P, B3%(P, B1!(P)), 6) + B%(P, B3%(P, B1!(P)), 7) + B%(P, B3%(P, B1!(P)), 8) * 2 + B%(P, B3%(P, B1!(P)), 9) * 3) / B%(P, B3%(P, B1!(P)), 4) * 1000 + .5)
        End If

        18948 '
        Call d100(RN)
        If S4% = 1 And INNING% <= 7 And A1 <= MG%(P, 635) And A1 >= MG%(P, 636) * -1 And I7! <= MG%(P, 637) And I6! <= MG%(P, 638) And P%(D, P1%(D), 10) <= MG%(P, 639) And RN <= MG%(P, 640) Then 18970
        If S4% = 2 And INNING% <= 7 And A1 <= MG%(P, 641) And A1 >= MG%(P, 642) * -1 And I7! <= MG%(P, 643) And I6! <= MG%(P, 644) And P%(D, P1%(D), 10) <= MG%(P, 645) And RN <= MG%(P, 646) Then 18970
        If S4% = 4 And INNING% <= 7 And A1 <= MG%(P, 647) And A1 >= MG%(P, 648) * -1 And I7! <= MG%(P, 649) And I6! <= MG%(P, 650) And P%(D, P1%(D), 10) <= MG%(P, 651) And RN <= MG%(P, 652) Then 18970
        If S4% = 1 And INNING% > 7 And A1 <= MG%(P, 653) And A1 >= MG%(P, 654) * -1 And I7! <= MG%(P, 655) And I6! <= MG%(P, 656) And P%(D, P1%(D), 10) <= MG%(P, 657) And RN <= MG%(P, 658) Then 18970
        If S4% = 2 And INNING% > 7 And A1 <= MG%(P, 659) And A1 >= MG%(P, 660) * -1 And I7! <= MG%(P, 661) And I6! <= MG%(P, 662) And P%(D, P1%(D), 10) <= MG%(P, 663) And RN <= MG%(P, 664) Then 18970
        If S4% = 4 And INNING% > 7 And A1 <= MG%(P, 665) And A1 >= MG%(P, 666) * -1 And I7! <= MG%(P, 667) And I6! <= MG%(P, 668) And P%(D, P1%(D), 10) <= MG%(P, 669) And RN <= MG%(P, 670) Then 18970

    End If

    18947 '
    P2 = 1
    If S4% = 1 Or S4% = 5 Then
        18944 If A1 <= -1 And B%(P, B3%(P, B0%(1, 0)), 13) < 10 Or B0%(1, 2) > 1 Then 18943: 'CHANGED FROM <10
        If A1 >= -1 And S4% = 5 Then 18943
        If A1 < -5 Or B7%(P, B0%(1, 0)) = 1 And S4% = 1 Or B7%(P, B0%(2, 0)) = 1 And S4% = 2 Then 18943
        If A1 < 0 And INNING% >= 7 Then 18943
        P2 = 3
        GoTo 14800
    End If

    If S4% = 2 Or S4% = 4 Then
        If B%(P, B3%(P, B0%(2, 0)), 13) < 40 Or B7%(P, B1!(P)) = 1 Or O%(0) = 2 Then 18943
        If B0%(2, 2) > 1 Then 18943
        P2 = 3
        GoTo 14800
    End If

    18943 'GoTo 18960

    18960 If S4% = 0 Or O%(0) > 0 Or S4% = 7 Or S4% = 6 Or S4% = 3 Or S4% = 5 Or U% = 2 Or P = 0 And INNING% > 7 Then 18968
    If B7%(P, B1!(P)) = 1 And S4% = 1 And O%(0) < 2 Or B7%(P, B1!(P)) = 1 And S4% = 2 And O%(0) = 0 Or B7%(P, B1!(P)) = 1 And S4% = 4 And O%(0) = 0 Then 18969
    If B1!(P) > 2 And B1!(P) < 6 Or B4%(P, 0, B1!(P)) > 290 And B7%(P, B1!(P)) <> 1 Or B7%(P, B1!(P)) <> 1 And B4%(P, 3, B1!(P)) > 70 Then 18968
    If INNING% > 7 And A1 = -1 And O%(0) = 0 And S4% = 1 Then 18969

    18968 PPH = 0: PR% = 0

    18980 If O%(0) = 2 Or B4%(P, 4, B1!(P)) > 100 Or S4% = 0 Then 15064
    If S4% = 7 Or S4% = 6 Or S4% = 3 Or S4% = 2 Or A1 < -3 Then 15064
    If Int(Rnd(1) * 100) + 1 > 20 Then 15064
    P2 = 2
    GoTo 15067


    '-----


    18969 If O%(0) >= 1 And INNING% >= 7 Then 18968

    18970 P2 = 4
    GoTo 14100


    '-----


    18985 'PH FOR PITCHER WITH PROFILE
    Call d100(RN)
    MOB% = 0
    For I = 1 To 3
        If B0%(I, 0) > 0 Then MOB% = MOB% + 1
    Next
    If P%(P, P1%(P), 11) <> 999 Then I7! = P%(I, P1%(I), 11): GoTo 18986
    If P%(P, P1%(P), 20) = 0 Then I7! = 0: GoTo 18986
    I7! = Int((P%(P, P1%(P), 22) / P%(P, P1%(P), 20) * 1000 + .5))

    18986 For I = 0 To 2
        If INNING% >= MG%(P, 591 + I * 6) And A1 <= MG%(P, 592 + I * 6) * -1 And O%(0) <= MG%(P, 594 + I * 6) And I7! <= MG%(P, 595 + I * 6) And RN <= MG%(P, 596 + I * 6) And MOB% >= MG%(P, 593 + I * 6) Then 18930
    Next

    GoTo 18905


    '-----


    18991 'PH FOR POS PLAYER CASES
    Call d100(RN)
    MOB% = 0

    For I = 1 To 3
        If B0%(I, 0) > 0 Then MOB% = MOB% + 1
    Next

    If B%(P, B3%(P, B1!(P)), 4) = 0 Then
        I7! = 0: I6! = 0
    Else
        I7! = Int(B%(P, B3%(P, B1!(P)), 6) / B%(P, B3%(P, B1!(P)), 4) * 1000 + .5)
        I6! = Int((B%(P, B3%(P, B1!(P)), 6) + B%(P, B3%(P, B1!(P)), 7) + B%(P, B3%(P, B1!(P)), 8) * 2 + B%(P, B3%(P, B1!(P)), 9) * 3) / B%(P, B3%(P, B1!(P)), 4) * 1000 + .5)
    End If

    18992 '
    For I = 0 To 2
        If INNING% >= MG%(P, 848 + I * 6) And A1 <= MG%(P, 849 + I * 6) * -1 And I6! <= MG%(P, 851 + I * 6) And I7! <= MG%(P, 852 + I * 6) And RN <= MG%(P, 853 + I * 6) And MOB% >= MG%(P, 850 + I * 6) Then 18909
    Next

    GoTo 18905

End Sub

