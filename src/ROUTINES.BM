'------------------------------
'      ADDPIT Subroutine
'------------------------------
' ...explanation...
Sub ADDPIT (D, I5, I6)
    P8%(D, I5, I6) = P8%(D, I5, I6) + 1
    P5%(D, I5, I6) = P5%(D, I5, I6) + 1
End Sub


'------------------------------
'      ADDSTTS Subroutine
'------------------------------
' ...explanation...
Sub ADDSTTS (p, D)
    If B7%(p, B1!(p)) <> 1 Then I5 = B3%(p, B1!(p)): I6 = 0: Call INCBATOFF(p, I5, I6)
    If B7%(p, B1!(p)) = 1 Then I5 = P1%(p): I6 = 23: Call INCPITOFF(p, I5, I6)
    I5 = P1%(D): I6 = 0: Call ADDPIT(D, I5, I6)
End Sub


'------------------------------
'    ADJRUNNERS Subroutine
'------------------------------
' ...explanation...
Sub ADJRUNNERS (S2%, p)
    For i = 1 To 3
        If S2% = 13 And A5%(i) = 11 And B1%(i, 0) = 0 Then A5%(0) = 11
    Next i
    If B1%(3, 0) = 0 Or A5%(3) = 0 Then 6805
    i = 3
    If A5%(3) = 10 Then I3 = 3: Call CLEARBASE(i)
    If A5%(3) >= 1 And A5%(3) <= 4 Then Call CHARGERUN(D, i)
    If A5%(3) = 11 Then I3 = 4: Call CLEARBASE(i)

    6805 If B1%(2, 0) = 0 Or A5%(2) = 0 Then 6812
    i = 2
    If A5%(2) = 10 Then I3 = 2: Call CLEARBASE(i)
    If A5%(2) = 11 Then I3 = 3: Call CLEARBASE(i)
    If A5%(2) = 12 And B1%(3, 0) = 0 Then I3 = 4: Call CLEARBASE(i)
    If A5%(2) = 1 And B1%(3, 0) = 0 Then Call BATTER1(i)
    If A5%(2) >= 2 And A5%(2) <= 4 And B1%(3, 0) = 0 Then Call CHARGERUN(D, i)

    6812 If B1%(1, 0) = 0 Or A5%(1) = 0 Then 6821
    i = 1: If A5%(1) = 8 And B1%(2, 0) = 0 Then Call BATTER1(i)
    If A5%(1) = 10 Then I3 = 1: Call CLEARBASE(i)
    If A5%(1) = 11 Then I3 = 2: Call CLEARBASE(i)
    If A5%(1) = 12 And B1%(3, 0) = 0 And B1%(2, 0) = 0 Then I3 = 3: Call CLEARBASE(i)
    If A5%(1) = 13 And B1%(3, 0) = 0 And B1%(2, 0) = 0 Then I3 = 4: Call CLEARBASE(i)
    If A5%(1) = 1 And B1%(2, 0) = 0 Then Call BATTER1(i)
    If A5%(1) = 2 And B1%(2, 0) = 0 And B1%(3, 0) = 0 Then Call BATTER2(i)
    If A5%(1) >= 3 And A5%(1) <= 4 And B1%(2, 0) = 0 And B1%(3, 0) = 0 Then Call CHARGERUN(D, i)

    6821 i = 0: B1%(0, 0) = B1!(p): B1%(0, 1) = P1%(D)
    If A5%(0) = 0 Then 6835
    If A5%(0) > 0 And A5%(0) < 4 Then I3 = A5%(0): Call BATTER3(I3, p, D)
    If A5%(0) = 4 Then I3 = A5%(0): Call CHARGERUN(D, i)
    If A5%(0) = 11 Then I3 = 1: Call CLEARBASE(i)
    If A5%(0) = 12 Then I3 = 2: Call CLEARBASE(i)
    If A5%(0) = 13 Then I3 = 3: Call CLEARBASE(i)
    If A5%(0) = 14 Then I3 = 4: Call CLEARBASE(i)

    6835 '
End Sub


'------------------------------
'   ADV1BASE Subroutine
'------------------------------
' ...explanation...
Sub ADV1BASE (i)
    For I4 = 0 To 2
        B0%(i + 1, I4) = B0%(i, I4): B0%(i + 1, 2) = 0: B0%(i, I4) = 0
    Next I4
    Q$(i + 1) = Q$(i): Q$(i) = ""
End Sub


'------------------------------
'   ADV2BASES Subroutine
'------------------------------
' ...explanation...
Sub ADV2BASES (i)
    For I4 = 0 To 2
        B0%(i + 2, I4) = B0%(i, I4): B0%(i + 1, 2) = 0: B0%(i, I4) = 0
    Next I4
    Q$(i + 2) = Q$(i): Q$(i) = ""
End Sub


'------------------------------
'   ADV3BASES Subroutine
'------------------------------
' ...explanation...
Sub ADV3BASES (I3, p, D)
    B0%(I3, 0) = B1!(p): B0%(I3, 1) = P1%(D): Q$(I3) = Q$(0): B0%(I3, 2) = 0
    B0%(0, 0) = 0
End Sub


'------------------------------
'   ADVANCEMENT Subroutine
'------------------------------
' ...explanation...
Sub ADVANCEMENT (p, D, S2%, F%, I3)
    If B0%(3, 0) = 0 Or A5%(3) = 0 Then 3805
    i = 3
    If A5%(3) = 10 Then I3 = 3: Call RecordOut(i, I3)
    If A5%(3) >= 1 And A5%(3) <= 4 Then Call RecordRun(sah%, i, D, F%, PQ, S2%, W%, INFPOS%)
    If A5%(3) = 11 Then I3 = 4: Call RecordOut(i, I3)

    3805 If B0%(2, 0) = 0 Or A5%(2) = 0 Then 3812
    i = 2
    If A5%(2) = 10 Then I3 = 2: Call RecordOut(i, I3)
    If A5%(2) = 11 Then I3 = 3: Call RecordOut(i, I3)
    If A5%(2) = 12 And B0%(3, 0) = 0 Then I3 = 4: Call RecordOut(i, I3)
    If A5%(2) = 1 And B0%(3, 0) = 0 Then Call ADV1BASE(i)
    If A5%(2) >= 2 And A5%(2) <= 4 And B0%(3, 0) = 0 Then Call RecordRun(sah%, i, D, F%, PQ, S2%, W%, INFPOS%)

    3812 If B0%(1, 0) = 0 Or A5%(1) = 0 Then 3821
    i = 1: If A5%(1) = 8 And B0%(2, 0) = 0 Then Call ADV1BASE(i)
    If A5%(1) = 10 Then I3 = 1: Call RecordOut(i, I3)
    If A5%(1) = 11 Then I3 = 2: Call RecordOut(i, I3)
    If A5%(1) = 12 And B0%(3, 0) = 0 And B0%(2, 0) = 0 Then I3 = 3: Call RecordOut(i, I3)
    If A5%(1) = 13 And B0%(2, 0) = 0 And B0%(3, 0) = 0 Then I3 = 4: Call RecordOut(i, I3)
    If A5%(1) = 1 And B0%(2, 0) = 0 Then Call ADV1BASE(i)
    If A5%(1) = 2 And B0%(2, 0) = 0 And B0%(3, 0) = 0 Then Call ADV2BASES(i)
    If A5%(1) >= 3 And A5%(1) <= 4 And B0%(2, 0) = 0 And B0%(3, 0) = 0 Then Call RecordRun(sah%, i, D, F%, PQ, S2%, W%, INFPOS%)

    3821 i = 0: B0%(0, 0) = B1!(p): B0%(0, 1) = P1%(D)
    If A5%(0) = 0 Then 3835
    If A5%(0) > 0 And A5%(0) < 4 Then I3 = A5%(0): Call ADV3BASES(I3, p, D)
    If A5%(0) = 4 Then I3 = A5%(0): Call RecordRun(sah%, i, D, F%, PQ, S2%, W%, INFPOS%)
    If A5%(0) = 11 Then I3 = 1: Call RecordOut(i, I3)
    If A5%(0) = 12 Then I3 = 2: Call RecordOut(i, I3)
    If A5%(0) = 13 Then I3 = 3: Call RecordOut(i, I3)
    If A5%(0) = 14 Then I3 = 4: Call RecordOut(i, I3)

    3835 If F% = 0 And O%(1) < 3 Then Call ADJRUNNERS(S2%, p)
    For i = 0 To 3: A5%(i) = 0: Next i
End Sub


'------------------------------
'   BATDISP Subroutine
'------------------------------
' ...explanation...
Sub BATDISP (PG, P9)
    Locate 1, 1
    Color 14: Print "#";: Color l%(P9, 11), l%(P9, 12): Print A$(P9);: Color 14, 0
    Locate , 16: Print "B   POS    G  AB 2B 3B HR RBI  BB  SO SRAB  SB CS G%  BA"
    For i = 2 To 13: Locate i, 1: Print String$(78, 32): Next: Locate 2, 1
    If PG = 0 Then AA = 0: BB = 12
    If PG = 1 Then AA = 13: BB = 22
    For i = AA To BB: Locate , 1
        If b%(P9, i, 21) <> 0 Then 150
        Color 2, 0
        If i < 10 Then Print Using "#"; i;
        If i > 9 Then Print X$(i - 10);
        Color 15, 0
        Print Tab(3); b$(P9, i); Tab(17); B1$(b%(P9, i, 0) + 2);
        For xx = 20 To 23
            Print Tab(xx);: If b%(P9, i, xx + 2) <> -1 Then Print Using "#"; b%(P9, i, xx + 2);
        Next
        Print Tab(24);
        Print Using " ### ### ## ## ## ### ### ### #"; b%(P9, i, 3); b%(P9, i, 4); b%(P9, i, 7); b%(P9, i, 8); b%(P9, i, 9); b%(P9, i, 10); b%(P9, i, 11); b%(P9, i, 12); b%(P9, i, 16);
        Print Using "#"; b%(P9, i, 17);: Print Using "#"; b%(P9, i, 15);: Print Using "# "; b%(P9, i, 30);
        Print Using "### ## ## "; b%(P9, i, 13); b%(P9, i, 14); b%(P9, i, 18);: Print Tab(69); ".";
        If b%(P9, i, 4) <> 0 Then Print Using "###"; Int(((b%(P9, i, 6) / b%(P9, i, 4)) + .0005) * 1000): GoTo 150
        Print

    150 Next i
End Sub


'------------------------------
'   BATOFF Subroutine
'------------------------------
' ...explanation...
Sub BATOFF (p, I5, I6)
    B8%(p, I5, I6) = B8%(p, I5, I6) - 1: B5%(p, I5, I6) = B5%(p, I5, I6) - 1
    If I6 > 8 Or I6 = 2 Or I6 = 3 Then 100
    If P%(1 - p, P1%(1 - p), 0) = 1 Then 100
    If I6 >= 4 Then CSS%(p, I5, I6 - 2) = CSS%(p, I5, I6 - 2) - 1: GoTo 100
    CSS%(p, I5, I6) = CSS%(p, I5, I6) - 1

100 End Sub


'------------------------------
'   BATTER1 Subroutine
'------------------------------
' ...explanation...
Sub BATTER1 (i)
    For I4 = 0 To 1
        B1%(i + 1, I4) = B1%(i, I4): B1%(i, I4) = 0
    Next I4
End Sub


'------------------------------
'   BATTER2 Subroutine
'------------------------------
' ...explanation...
Sub BATTER2 (i)
    For I4 = 0 To 1
        B1%(i + 2, I4) = B1%(i, I4): B1%(i, I4) = 0
    Next I4
End Sub


'------------------------------
'   BATTER3 Subroutine
'------------------------------
' ...explanation...
Sub BATTER3 (I3, p, D)
    B1%(I3, 0) = B1!(p): B1%(I3, 1) = P1%(D)
End Sub


'------------------------------
'   CAUGHTFLY Subroutine
'------------------------------
' ...explanation...
Sub CAUGHTFLY (i, S2%, D)
    Call RANDNUM(rn)
    If rn <= 96 Then i = 1
    If rn = 97 Then i = 2
    If rn = 98 Then i = 3
    If rn = 99 Then i = 4
    If rn = 100 Then i = 6
    On i GOTO 4352, 4354, 4356, 4358, 4361, 4362

    4352 If S2% = 17 Then 4353
    Y% = Int(Rnd(1) * 60) + 1230
    Call GETRPBP(Y%, Y$, D): Call STRIPRPBP(Y$, Y%, D)
    Print Q$(4); " "; Y$
    Call DELAY

    4353 If S2% = 17 And l%(1, 13) = 37 Then Print "he climbs the terrace": Call DELAY
    Y% = Int(Rnd(1) * 20) + 1290
    Call GETRPBP(Y%, Y$, D): Call STRIPRPBP(Y$, Y%, D)
    Print Y$
    GoTo 4359

    4354 Print Q$(4); " makes a sliding catch": Call DELAY: Print "What a play!!!": GoTo 4359

    4356 Print Q$(4); " makes a leaping grab": Call DELAY: Print "What a catch!!!": GoTo 4359

    4362 Print Q$(4); " makes an incredible catch!!": GoTo 4359

    4358 Print Q$(4); " makes a diving catch!!!"

    4359 Call DELAY

    4361 '
End Sub


'------------------------------
'   CHANGELINEUP Subroutine
'------------------------------
' ...explanation...
Sub CHANGELINEUP (P9, p)
    Locate 14, 1: Color 2: Print " # LINEUP       PS  FA  OB"
    Color 15
    For i = 1 To 9: Locate , 1
        If B1!(P9) = i Then Print "*";
        Locate , 2: Print Using "#"; i;: Locate , 4
        If B7%(P9, i) = 1 Then Print p$(P9, P1%(P9));
        If B7%(P9, i) <> 1 Then Print b$(P9, B3%(P9, i));
        If B7%(P9, i) <> 0 And B7%(P9, i) < 10 Then Locate , 20: Print b%(P9, B3%(P9, i), 19);
        Locate , 17: Print C$(B7%(P9, i));
        Locate , 25
        For I1 = 1 To 3
            If B0%(I1, 0) = i And P9 = p Then Color 3: Print I1;: Color 15
        Next I1
        Print " "
    Next i
End Sub


'------------------------------
'   CHARGERUN Subroutine
'------------------------------
' ...explanation...
Sub CHARGERUN (D, i)
    If O%(1) >= 3 Then Call CLEARBASE(i): GoTo 6841
    I5 = B1%(i, 1): I6 = 3: Call ADDPIT(D, I5, I6): Call CLEARBASE(i)

    6841 '
End Sub


'------------------------------
'   CHECKSAVE Subroutine
'------------------------------
' ...explanation...
Sub CHECKSAVE (D, p, S4%)
    I3 = S6%(D, 0) - S6%(p, 0): S1%(D) = -1: If I3 < 1 Then 1807
    If S4% = 0 And I3 <= 2 Then S1%(D) = P1%(D)
    If S4% > 0 And S4% < 4 And I3 <= 3 Then S1%(D) = P1%(D)
    If S4% > 3 And S4% < 7 And I3 <= 4 Then S1%(D) = P1%(D)
    If S4% = 7 And I3 <= 5 Then S1%(D) = P1%(D)
    If S4% = 0 And O%(0) = 0 And I3 <= 3 Then S1%(D) = P1%(D)
    If INNING% > 5 And I3 > 0 And INNING% < 8 Then S1%(D) = P1%(D)

    1807 RI = 0: If S4% = 0 Then 1820
    If S4% = 1 Or S4% = 2 Or S4% = 3 Then RI = 1
    If S4% = 4 Or S4% = 5 Or S4% = 6 Then RI = 2
    If S4% = 7 Then RI = 3
    P5%(D, P1%(D), 17) = P5%(D, P1%(D), 17) + RI: P8%(D, P1%(D), 17) = P8%(D, P1%(D), 17) + RI

    1820 '
End Sub


'------------------------------
'   CLEARBASE Subroutine
'------------------------------
' ...explanation...
Sub CLEARBASE (i)
    B1%(i, 0) = 0: B1%(i, 1) = 0
End Sub


'------------------------------
'   CREDITASSIST Subroutine
'------------------------------
' ...explanation...
Sub CREDITASSIST (W%, D)
    '*** CREDIT ASSISTS ***
    If W% = 1 Then I5 = P1%(D): I6 = 39: Call ADDPIT(D, I5, I6): GoTo 3408
    I5 = B9%(D, W%): I6 = 17: Call INCBATDF(D, I5, I6)

    3408 '
End Sub


'------------------------------
'   CREDITPUTOUT Subroutine
'------------------------------
' ...explanation...
Sub CREDITPUTOUT (I3, FB2P%, AST%, D)
    '*** CREDIT INFIELD PUTOUTS ***
    If I3 > 4 Then I3 = 1
    po% = I3 + 2: ' 1=1st 2=2nd 3=3rd 4=home
    If po% = 6 Then po% = 2: GoTo 3417
    If po% = 3 And FB2P% = 1 Then FB2P% = 0: po% = 1: GoTo 3415
    If po% = 3 Then 3417
    If po% = 4 And AST% = 4 Then po% = 6: GoTo 3417
    If po% = 4 And AST% = 6 Then po% = 4: GoTo 3417
    GoTo 3417

    3415 If po% = 1 Then I5 = P1%(D): I6 = 38: Call ADDPIT(D, I5, I6): GoTo 3418

    3417 AST% = 0
    I5 = B9%(D, po%): I6 = 16: Call INCBATDF(D, I5, I6)

    3418 '
End Sub


'------------------------------
'   CREDITREGPO Subroutine
'------------------------------
' ...explanation...
Sub CREDITREGPO (W%, D)
    '*** CREDIT REGULAR PUTOUT  ***
    If W% = 1 Then
        I5 = P1%(D): I6 = 38
        Call ADDPIT(D, I5, I6)
    Else
        I5 = B9%(D, W%): I6 = 16
        Call INCBATDF(D, I5, I6)
    End If
End Sub


'------------------------------
'   DELAY Subroutine
'------------------------------
' ...explanation...
Sub DELAY ()
    'Is the IF statement necessary?
    'IF displayPause <> THEN
    _Delay displayPause
    'END IF
End Sub


'------------------------------
'   DELIVERY Subroutine
'------------------------------
' ...explanation...
Sub DELIVERY (D)
    '*** setup the delivery ***
    Call RANDNUM(RN)
    If RN <= 20 Then
        Y% = Int(Rnd(1) * 20) + 50
        Call GETRPBP(Y%, Y$, D)
        Call STRIPRPBP(Y$, Y%, D)
        Print Y$
        Call DELAY
    End If
    Y% = Int(Rnd(1) * 46) + 1
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Print Y$
    Call DELAY
End Sub


'------------------------------
'   DISPFLDG Subroutine
'------------------------------
' ...explanation...
Sub DISPFLDG (PG, P9, TG)
    'DIS FLDG
    Locate 1, 16: Print "P1 FAVG A R   P2 FAVG A R   P3 FAVG A R   P4 FAVG A R      "
    For i = 2 To 13: Locate i, 1: Print String$(78, 32): Next
    Locate 2
    If PG = 0 Then AA = 0: BB = 12
    If PG = 1 Then AA = 13: BB = 22
    For i = AA To BB: If b%(P9, i, 21) <> 0 Then 5802
        If i < 10 Then Print Using "#"; i;
        If i > 9 Then Print X$(i - 10);
        Color 15, 0
        Print Tab(3); b$(P9, i);
        Locate , 17: If b%(P9, i, 22) <> -1 Then Print Using "# #### # #"; b%(P9, i, 22); b%(P9, i, 26); b%(P9, i, 33); b%(P9, i, 34);
        Locate , 31: If b%(P9, i, 23) <> -1 Then Print Using "# #### # #"; b%(P9, i, 23); b%(P9, i, 27); b%(P9, i, 35); b%(P9, i, 36);
        Locate , 45: If b%(P9, i, 24) <> -1 Then Print Using "# #### # #"; b%(P9, i, 24); b%(P9, i, 28); b%(P9, i, 37); b%(P9, i, 38);
        Locate , 59: If b%(P9, i, 25) <> -1 Then Print Using "# #### # #"; b%(P9, i, 25); b%(P9, i, 29); b%(P9, i, 39); b%(P9, i, 40);
        Print

    5802 Next i: TG = TG + 1
End Sub


'------------------------------
'   DISPRUN Subroutine
'------------------------------
' ...explanation...
Sub DISPRUN (I2, p, X)
    J = B0%(I2, 0): If J = 0 Then 363
    Color l%(p, 11), l%(p, 12)
    If B7%(p, J) = 1 And p%(p, P1%(p), 11) <> 999 Then Print Left$(p$(p, P1%(p)), 10): Color 15, 2: Locate , X: Print "1/  0": GoTo 363
    If B7%(p, J) = 1 Then Print Left$(p$(p, P1%(p)), 10): Locate , X: Color 15, 2: Print Using "#"; p%(p, P1%(p), 31);: Print "/";: Print Using "###"; p%(p, P1%(p), 29): GoTo 363
    Print Left$(b$(p, B3%(p, J)), 10): Locate , X: Color 15, 2: Print Using "#"; b%(p, B3%(p, J), 16);: Print "/";: Print Using "###"; b%(p, B3%(p, J), 13)

    363 Color 15, 0
End Sub


'------------------------------
'   DPPBP Subroutine
'------------------------------
' ...explanation...
Sub DPPBP ()
    Call RANDNUM(rn)
    If rn <= 20 Then Print "may be a double play ball"
    If rn > 20 And rn <= 40 Then Print "they might turn two"
    If rn > 40 And rn <= 60 Then Print "they could get two"
    If rn > 60 And rn <= 80 Then Print "could be two"
    If rn > 80 Then Print "could be a double play"
    Call DELAY
End Sub


'------------------------------
'   DPPIVOT Subroutine
'------------------------------
' ...explanation...
Sub DPPIVOT (W%, D)
    '*** double play pivot ***
    If W% = 4 Then ww% = 6
    If W% = 6 Then ww% = 4
    If W% = 3 Then ww% = 1
    Y% = Int(Rnd(1) * 20) + 1910
    Call GETRPBP(Y%, Y$, D): Call STRIPRPBP(Y$, Y%, D)
    Print Y$; " "; b$(D, B9%(D, ww%))
    Call DELAY
End Sub


'------------------------------
'   DPRELAY Subroutine
'------------------------------
' ...explanation...
Sub DPRELAY ()
    Call RANDNUM(rn)
    If rn <= 10 And A5%(0) <> 11 Then Print "Give me the Hoover!": GoTo 3716
    If A5%(0) <> 11 Then 3716
    Call RANDNUM(rn)
    If rn <= 8 Then Print "over to 1st..."
    If rn > 8 And rn <= 16 Then Print "throw to 1st..."
    If rn > 16 And rn <= 24 Then Print "on to first..."
    If rn > 24 And rn <= 30 Then Print Q$(4); " pivots and throws"
    If rn > 30 And rn <= 36 Then Print Q$(4); " gets the throw off"
    If rn > 36 And rn <= 44 Then Print Q$(4); " is hit as he throws"
    If rn > 44 And rn <= 50 Then Print Q$(4); " leaps and throws"
    If rn > 50 And rn <= 56 Then Print Q$(4); " jumps over the sliding "; Q$(1)
    If rn > 56 And rn <= 64 Then Print "the relay to first..."
    If rn > 64 And rn <= 72 Then Print "quick turn by "; Q$(4)
    If rn > 72 And rn <= 80 Then Print "relay to 1st..."
    If rn > 80 And rn <= 88 Then Print "to 1st..."
    If rn > 88 And A5%(0) = 11 Then Print "over to 1st..."

    3716 Call DELAY
End Sub


'------------------------------
'   DPSAFE Subroutine
'------------------------------
' ...explanation...
Sub DPSAFE ()
    Call RANDNUM(rn)
    If rn <= 8 Then Print "over to 1st..."
    If rn > 8 And rn <= 16 Then Print "throw to 1st..."
    If rn > 16 And rn <= 24 Then Print "on to first..."
    If rn > 24 And rn <= 30 Then Print "pivot to first"
    If rn > 30 And rn <= 36 Then Print "the throw to 1st"
    If rn > 36 And rn <= 44 Then Print "relay to first"
    If rn > 44 And rn <= 50 Then Print "on to first..."
    If rn > 50 And rn <= 56 Then Print "on to first"
    If rn > 56 And rn <= 64 Then Print "the relay to first..."
    If rn > 64 And rn <= 72 Then Print "quick turn to first"
    If rn > 72 And rn <= 80 Then Print "relay to 1st..."
    If rn > 80 And rn <= 88 Then Print "to 1st..."
    If rn > 88 And A5%(0) = 11 Then Print "over to 1st..."
    Call DELAY
    Y% = Int(Rnd(1) * 20) + 1890
    Call GETRPBP(Y%, Y$, D): Call STRIPRPBP(Y$, Y%, D)
    Print Y$
    Call DELAY
End Sub


'------------------------------
'   DRAWBOX Subroutine
'------------------------------
' ...explanation...
Sub DRAWBOX (J)
    Locate 8, 8
    Color l%(1, 11), l%(1, 12)
    Print " Ö"; String$(61, 196); "· ";
    For II = 1 To J
        Locate 8 + II, 8
        Print " º"; String$(61, 32); "º ";
    Next
    Locate 9 + J, 8
    Print " Ó"; String$(61, 196); "½ ";
End Sub


'------------------------------
'   EJECTINC Subroutine
'------------------------------
' ...explanation...
Sub EJECTINC (EJ%, X$)
    EJ% = EJ% + 1: EJ$(EJ%) = X$
End Sub


'------------------------------
'   EJECTIONINJURY Subroutine
'------------------------------
' ...explanation...
Sub EJECTIONINJURY (u6, p, u9, D, po%, P9, W5, W6)
    '*** Defensive Player Ejected/Injured ***
    If u6 = 2 Or u6 = 1 And p <> u9 Then 2704
    Print "You must replace "; b$(D, B9%(D, po%)): Call DELAY: GoTo 2749

    2704 For I2 = 1 To 9: If B7%(D, I2) = po% Then 2705
    Next

    2705 For i = 0 To 22: If b%(D, i, 21) > 0 Or b$(D, i) = "XXX" Then 2708
        If B7%(D, I2) <> b%(D, i, 22) And B7%(D, I2) <> b%(D, i, 23) And B7%(D, I2) <> b%(D, i, 24) And B7%(D, I2) <> b%(D, i, 25) Then 2708

        2707 Print b$(D, B9%(D, po%)); " will be replaced by "; b$(D, i): Call DELAY
        D0%(D) = D0%(D) + 1
        X0%(D, 0, D0%(D)) = i
        X0%(D, 1, D0%(D)) = B7%(D, I2)
        X0%(D, 2, D0%(D)) = (I2 * 10) + (D0%(D) - 9)
        b%(D, i, 21) = 1
        B3%(D, I2) = i
        I7% = D: I8% = I2: i9% = i
        Call REPLACEMENTS(I7%, I8%, i9%)
        B9%(D, B7%(D, I2)) = i
        P9 = D: W5 = P9: W6 = P9: VV(P9) = po%: VV1(P9) = po%
        Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)		
        Call FLDDISP(BC%, p, U%, D): Call MAINSCREEN(D, p, BC%, U%, MO): Locate 15, 1
        VV(P9) = 1: VV1(P9) = 9
        GoTo 2749

    2708 Next i
    For i = 0 To 22: If b%(D, i, 21) > 0 Or b$(D, i) = "XXX" Then 2710
        GoTo 2707

    2710 Next i

    2749 '
End Sub


'------------------------------
'   FLDAVG Subroutine
'------------------------------
' ...explanation...
Sub FLDAVG (D, W%, I3)
    If b%(D, B9%(D, W%), 19) >= 999 Then I3 = 999: GoTo 4454
    If W% >= 7 Then I3 = b%(D, B9%(D, W%), 19): GoTo 4454
    If W% = 3 Or W% = 2 Then I3 = (b%(D, B9%(D, W%), 19)) * .96: GoTo 4454
    'IF W%<>1 AND W%<>4 AND W%<>6 THEN I3=(B%(D,B9%(D,W%),19))*.985

    4454 I4 = b%(D, B9%(D, W%), 22)
    I5 = b%(D, B9%(D, W%), 23)
    I6 = b%(D, B9%(D, W%), 24)
    I7 = b%(D, B9%(D, W%), 25)
    If W% = I4 Or W% = I5 Or W% = I6 Or W% = I7 Then 4462
    If W% = 4 Or W% > 6 Then I3 = 982
    If W% = 2 Then I3 = 987
    If W% = 3 Then I3 = 980
    If W% = 6 Or W% = 5 Then I3 = 964
    If W% >= 7 Then I3 = I3 - 10: GoTo 4462
    I3 = I3 - 20
    If W% = 2 Or W% >= 4 And W% <= 6 Then I3 = I3 - 80: GoTo 4464

    4462 If W% = 4 Or W% = 6 Then I3 = (b%(D, B9%(D, W%), 19)) * .995
    If W% = 5 Then I3 = (b%(D, B9%(D, W%), 19)) * .985

    4464 Rem
End Sub


'------------------------------
'   SPA Subroutine
'------------------------------
' ...explanation...
SUB SPA (F$,L)
   F$=LEFT$(F$,L)
10 IF LEN(F$)<L THEN F$=F$+" ":GOTO 10
END SUB


'------------------------------
'   FLDDISP Subroutine
'------------------------------
' ...explanation...
Sub FLDDISP (BC%, p, U%, D)
    Color , 0: Cls
    For X = 5 To 25
        Locate X, 46
        Color , 2
        Print String$(34, 32);
    Next
    Color , 0
    Locate 1, 1
    X% = 1: Y% = 9
    If INNING% > 9 Then X% = 10: Y% = 18
    If INNING% > 18 Then X% = 19: Y% = 27
    Print Tab(10);
    For X1% = 0 To 2
        Print Using "## ## ##  "; X% + 3 * X1%; X% + 3 * X1% + 1; X% + 3 * X1% + 2;
    Next
    Print " R  H  E ";: Color 1
    Print Chr$(179);: Color 15: Print " BALL:  ";: Color 14: Print BC%;
    Color 1: Print Chr$(179);: Color 15
    Print "WIND: ";: Color 14: Print WI$
    For i = 0 To 1: Locate i + 2: Print Left$(A$(i), 3); NN$(i);
        For I2 = X% To Y%
            If p = 0 And i = 0 And I2 > INNING% - 1 And s%(i, INNING%) = 0 Or p = 0 And i = 0 And I2 > INNING% And s%(i, INNING%) > 0 Or p = 1 And I2 > INNING% And i = 0 Then 310
            If p = 0 And i = 1 And I2 > INNING% - 1 Or p = 1 And i = 1 And s%(i, INNING%) = 0 And I2 > INNING% - 1 Or p = 1 And i = 1 And s%(i, INNING%) > 0 And I2 > INNING% Then 310
            Call INNDISP(I2, i)
        Next I2

        310 Locate , 40: Print Using "## ## ## "; S6%(i, 0); S6%(i, 1); S6%(i, 2);
        Color 1: Print Chr$(179);: Color 15
        If i = 0 Then Print " STRIKE:";: Color 14: Print U%;: Color 1: Print Chr$(179);: Color 15: Print "SKY:  ";: Color 14: Print SC$(SC%)
        If i = 1 Then Print " OUT:   ";: Color 14: Print O%(0);: Color 1: Print Chr$(179);: Color 15: Print "TEMP:";: Color 14: Print TP%
    Next i
    Color 1: Print String$(20, 196); Chr$(194); String$(23, 196); Chr$(194); String$(3, 196); Chr$(193); String$(11, 196); Chr$(193); String$(19, 196)
    For X = 5 To 12: Locate X, 21: Print Chr$(179);: Next
    For X = 5 To 25: Locate X, 45: Print Chr$(179);: Next
    Color 15, 2
    Locate 5, 58: Color l%(D, 11), l%(D, 12): Print Left$(b$(D, B9%(D, 8)), 10): Color 15, 2
    Locate 6, 59: Print Using "A:# R:#"; b%(D, B9%(D, 8), 15); b%(D, B9%(D, 8), 17)
    Locate 7, 59: Print Using "FA:####"; b%(D, B9%(D, 8), 19)
    Locate 6, 46: Color l%(D, 11), l%(D, 12): Print Left$(b$(D, B9%(D, 7)), 10);
    Locate , 70: Print Left$(b$(D, B9%(D, 9)), 10): Color 15, 2
    Locate 7, 47: Print Using "A:# R:#"; b%(D, B9%(D, 7), 15); b%(D, B9%(D, 7), 17);
    Locate , 71: Print Using "A:# R:#"; b%(D, B9%(D, 9), 15); b%(D, B9%(D, 9), 17)
    Locate 8, 47: Print Using "FA:####"; b%(D, B9%(D, 7), 19);
    Locate , 71: Print Using "FA:####"; b%(D, B9%(D, 9), 19)
    Locate 10, 49: Color l%(D, 11), l%(D, 12): Print Left$(b$(D, B9%(D, 6)), 10);
    Locate , 68: Print Left$(b$(D, B9%(D, 4)), 10): Color 15, 2
    Locate 11, 50: Print Using "R:#"; b%(D, B9%(D, 6), 17);
    Locate , 69: Print Using "R:#"; b%(D, B9%(D, 4), 17)
    Locate 12, 50: Print Using "FA:####"; b%(D, B9%(D, 6), 19);: Locate , 62
    Print Chr$(219);
    Locate , 69: Print Using "FA:####"; b%(D, B9%(D, 4), 19)
    Locate 14, 46: Color l%(D, 11), l%(D, 12): Print Left$(b$(D, B9%(D, 5)), 10);
    Locate , 70: Print Left$(b$(D, B9%(D, 3)), 10): Color 15, 2
    Locate 15, 47: Print Using "R:#"; b%(D, B9%(D, 5), 17);: Locate 17, 49
    Print Chr$(219);
    Locate , 78: Print Chr$(219);: Locate 15, 71: Print Using "R:#"; b%(D, B9%(D, 3), 17)
    Locate 16, 47: Print Using "FA:####"; b%(D, B9%(D, 5), 19);
    Locate , 71: Print Using "FA:####"; b%(D, B9%(D, 3), 19)
    Locate 17, 55: Color l%(D, 11), l%(D, 12): Print "["; B1$(p%(D, P1%(D), 0) + 2); "] "; Left$(p$(D, P1%(D)), 10): Color 15, 2
    Locate 18, 59: Print Using "H:#"; p%(D, P1%(D), 18)
    Locate 19, 59: Print Using "FA:####"; p%(D, P1%(D), 17)
    Locate 21, 62: Print Chr$(219)
    Locate 23, 58: Color l%(D, 11), l%(D, 12): Print Left$(b$(D, B9%(D, 2)), 10): Color 15, 2
    Locate 24, 59: Print Using "   A:#"; b%(D, B9%(D, 2), 15);
    Locate 25, 59: Print Using "FA:####"; b%(D, B9%(D, 2), 19);
    Color 7, 0: For X = 5 To 25: Locate X, 1: Print String$(44, 32);: Next
    Color 1: Locate 4, 1: Print String$(20, 196); Chr$(194); String$(23, 196); Chr$(194)
    Locate 14, 1: Print String$(20, 196); Chr$(193); String$(23, 196); Chr$(180)
End Sub


'------------------------------
'   FLDERR Subroutine
'------------------------------
' ...explanation...
Sub FLDERR (F%, W%, D, I3, SB%, S2%, p)
    F% = 0
    If W% = 1 Then I3 = p%(D, P1%(D), 17) + 30
    If W% = 1 And SB% = 1 Then I3 = 995
    If W% <> 1 Then Call FLDAVG(D, W%, I3)
    If I3 >= 999 Then I6 = 1: GoTo 4408
    If S2% >= 12 And S2% <= 15 Then I6 = 1009 - I3
    If S2% >= 7 And S2% <= 9 Then I6 = 1006 - I3
    If S2% = 16 Or S2% >= 22 Then I6 = 1000 - I3
    If S2% >= 17 And S2% <= 21 Then I6 = (1000 - I3) * .05

    4408 If W% = 7 Then I6 = I6 - 4
    If W% = 8 Then I6 = I6 - 10
    If W% = 9 Then I6 = I6 - 15
    If W% = 5 Then I6 = I6 - 15
    H6% = Int(Rnd(1) * 1000) + 1: If H6% > I6 Then 4421
    F% = 1: i = Int(Rnd(1) * 2) + 1: I1 = 2
    If W% = 1 Then I5 = P1%(D): I6 = 34: Call ADDPIT(D, I5, I6)
    If W% <> 1 Then I5 = B9%(D, W%): I6 = 11: Call INCBATDF(D, I5, I6)
    If S2% <> 12 Then 4410
    If S2% = 12 Then Print Q$(0); " beats out an infield single": Call DELAY
    If B7%(p, B1!(p)) <> 1 Then I5 = B3%(p, B1!(p)): I6 = 0: Call INCBATOFF(p, I5, I6): I6 = 1: Call INCBATOFF(p, I5, I6)
    I5 = P1%(D): I6 = 1: Call ADDPIT(D, I5, I6)
    If B7%(p, B1!(p)) = 1 Then I5 = P1%(p): I6 = 23: Call INCPITOFF(p, I5, I6): I6 = 24: Call INCPITOFF(p, I5, I6)

    4410 If S2% >= 17 And S2% <= 21 Then I1 = 3
    If S2% >= 17 And S2% <= 20 Then Call OUTFIELDERR
    If S2% = 8 Or S2% = 9 Or S2% >= 22 Or S2% = 16 Then I1 = 1
    If S2% >= 12 And S2% <= 14 And i = 1 Or S2% = 15 Then I1 = 1
    Call RANDNUM(rn)
    If I1 = 1 And W% = 1 And S2% = 16 Then Print "*** WILD PICK OFF THROW BY";: GoTo 4415
    If I1 = 1 And rn <= 50 Then Print "*** THROWING ERROR ON";: GoTo 4415
    If I1 = 1 And rn > 50 And rn <= 55 Then Print "*** BALL KICKED BY";: GoTo 4415
    If I1 = 1 Then Print "*** "; Q$(4); " THROWS IT AWAY ***": GoTo 4403
    If I1 = 2 And rn <= 30 Then Print "*** FIELDING ERROR ON";: GoTo 4415
    If I1 = 2 And rn > 30 And rn <= 50 Then Print "*** OFF THE GLOVE OF";: GoTo 4415
    If I1 = 2 And rn > 50 And rn <= 75 Then Print "*** BALL IS BOOTED BY";: GoTo 4415
    If I1 = 2 And rn > 75 And rn <= 95 Then Print "*** BALL IS BOBBLED BY";: GoTo 4415
    If I1 = 2 And rn > 95 Then Print "*** BALL IS THROUGH THE LEGS OF";: GoTo 4415
    If I1 = 3 And rn <= 33 Then Print "*** BALL DROPPED BY";: GoTo 4415
    If I1 = 3 And rn > 33 And rn <= 66 Then Print "*** OFF THE GLOVE OF";: GoTo 4415
    If I1 = 3 Then Print "*** BALL IS MISPLAYED BY";

    4415 Print " "; Q$(4); " ***"

    4403 If S2% = 16 Or S2% = 22 Then I8 = Int(Rnd(1) * 10) + 1: If I8 < 5 Then A5%(1) = 2: A5%(2) = 2: A5%(3) = 1: A5%(0) = 2: Call DELAY: GoTo 4418
    i = Int(Rnd(1) * 100) + 1
    A5%(1) = 1: A5%(2) = 1: A5%(3) = 1: A5%(0) = 1: Call DELAY
    If S2% > 17 And S2% <= 21 Then 4418
    If i <= 17 And S2% <> 8 Or S2% = 12 Then A5%(1) = 2: A5%(2) = 2: A5%(0) = 2

    4418 If S2% >= 17 And S2% <= 20 And O%(0) = 2 Or S2% >= 23 Or S2% = 16 And W% = 2 Then A5%(2) = 2: A5%(1) = 2: A5%(0) = 2: A5%(3) = 1
    If S2% >= 17 And S2% <= 19 And i <= 33 And O%(0) < 2 And B0%(1, 0) = 0 Then A5%(0) = 2
    If S2% = 16 Or S2% = 22 Then A5%(0) = 0
    If I1 > 0 And S2% <> 7 And S2% <> 8 And S2% <> 9 And S2% <> 16 And S2% <> 22 Then O%(1) = O%(1) + 1
    If S2% = 16 Or S2% = 7 Or S2% = 8 Or S2% = 9 Or S2% = 22 Then A5%(0) = 0: If I8 > 4 And W% <> 2 Then A5%(1) = 1: A5%(2) = 1: A5%(3) = 1
    S6%(D, 2) = S6%(D, 2) + 1
    Call ADVANCEMENT(p, D, S2%, F%, I3)

    4421 '
End Sub


'------------------------------
'   GETFIELDER Subroutine
'------------------------------
' ...explanation...
Sub GETFIELDER (W%, p, I1, D)
    W% = 0
    i = Int(Rnd(1) * 100) + 1
    If B7%(p, B1!(p)) <> 1 And b%(p, B3%(p, B1!(p)), 0) < 0 Then I1 = -1
    If B7%(p, B1!(p)) <> 1 And b%(p, B3%(p, B1!(p)), 0) > 0 Then I1 = 1
    If B7%(p, B1!(p)) <> 1 And b%(p, B3%(p, B1!(p)), 0) = 0 Then I1 = -1 * p%(D, P1%(D), 0)
    If B7%(p, B1!(p)) = 1 Then I1 = p%(p, P1%(p), 0)
End Sub


'------------------------------
'   GETFIELDNAME Subroutine
'------------------------------
' ...explanation...
Sub GETFIELDNAME (W%, D)
    If W% <> 1 Then Q$(4) = b$(D, B9%(D, W%))
    If W% = 1 Then Q$(4) = p$(D, P1%(D))
End Sub


'------------------------------
'   GETINFIELDER Subroutine
'------------------------------
' ...explanation...
Sub GETINFIELDER (W%, p, I1, D, S2%, P2)
    Call GETFIELDER(W%, p, I1, D)
    i = Int(Rnd(1) * 100) + 1
    If I1 = 1 Then W% = 3
    If I1 = 1 And i <= 92 Then W% = 4
    If I1 = 1 And i <= 72 Then W% = 6
    If I1 = 1 And i <= 32 Then W% = 5
    If I1 = -1 Then W% = 5
    If I1 = -1 And i <= 88 Then W% = 6
    If I1 = -1 And i <= 68 Then W% = 4
    If I1 = -1 And i <= 28 Then W% = 3
    If i <= 12 And S2% <> 20 Then W% = 1
    If i <= 4 Or i <= 12 And S2% = 20 Then W% = 2
    If S2% = 21 And W% = 2 Then W% = 1
    If P2 = 4 And W% = 6 Then W% = 1
    If P2 = 4 And W% = 4 Or S2% = 20 And W% = 1 Then W% = 2
    Call GETFIELDNAME(W%, D)
End Sub


'------------------------------
'   GETOUTFIELDER Subroutine
'------------------------------
' ...explanation...
Sub GETOUTFIELDER (W%, p, I1, D)
    Call GETFIELDER(W%, p, I1, D)
    i = Int(Rnd(1) * 100) + 1
    If I1 = 1 Then W% = 7
    If I1 = 1 And i <= 50 Then W% = 9
    If I1 = -1 Then W% = 9
    If I1 = -1 And i <= 50 Then W% = 7
    If i <= 30 Then W% = 8
    Q$(4) = b$(D, B9%(D, W%))
End Sub


'------------------------------
'   GETRPBP Subroutine
'------------------------------
' ...explanation...
Sub GETRPBP (Y%, Y$, D)
    Open "revised.pbp" For Random As #1 Len = 44
    Field #1, 44 As YY$
    Get #1, Y%
    Y$ = YY$
    Close 1

    3996 'PRINT Y$; " BEF", Y%, YY$
    If Right$(Y$, 1) = " " Then Y$ = Left$(Y$, Len(Y$) - 1): GoTo 3996
    If TGTBASE% = 3 And Left$(Y$, 2) = "Q1" Then Y$ = "Q2 " + Right$(Y$, Len(Y$) - 3)
    If TGTBASE% = 3 And Right$(Y$, 2) = "Q1" Then Y$ = Left$(Y$, Len(Y$) - 2) + "Q2"
    If Left$(Y$, 2) = "BB" Then Y$ = Q$(0) + Right$(Y$, Len(Y$) - 2)
    If Left$(Y$, 2) = "Q1" Then Y$ = Q$(1) + Right$(Y$, Len(Y$) - 2)
    If Left$(Y$, 2) = "Q2" Then Y$ = Q$(2) + Right$(Y$, Len(Y$) - 2)
    If Left$(Y$, 2) = "PP" Then Y$ = p$(D, P1%(D)) + Right$(Y$, Len(Y$) - 2)
    If Left$(Y$, 2) = "UU" Then Y$ = U$(1) + Right$(Y$, Len(Y$) - 2)
    If Left$(Y$, 2) = "XX" Then Y$ = b$(D, B9%(D, 5)) + " and " + b$(D, B9%(D, 6)) + Right$(Y$, Len(Y$) - 2)
    If Left$(Y$, 2) = "TT" Then Y$ = b$(D, B9%(D, 5)) + Right$(Y$, Len(Y$) - 2)
    If Left$(Y$, 2) = "FB" Then Y$ = b$(D, B9%(D, 3)) + Right$(Y$, Len(Y$) - 2)
    If Left$(Y$, 2) = "YY" Then Y$ = b$(D, B9%(D, 4)) + " and " + b$(D, B9%(D, 3)) + Right$(Y$, Len(Y$) - 2)
    If Left$(Y$, 2) = "ZZ" Then Y$ = b$(D, B9%(D, 4)) + " and " + b$(D, B9%(D, 6)) + Right$(Y$, Len(Y$) - 2)
    If Left$(Y$, 2) = "Q4" Then Y$ = Q$(4) + Right$(Y$, Len(Y$) - 2)
    If Right$(Y$, 3) = " PP" Then Y$ = Left$(Y$, Len(Y$) - 2) + p$(D, P1%(D))
    If Right$(Y$, 3) = " BB" Then Y$ = Left$(Y$, Len(Y$) - 2) + Q$(0)
    If Right$(Y$, 2) = "Q1" Then Y$ = Left$(Y$, Len(Y$) - 2) + Q$(1)
    If Right$(Y$, 2) = "Q2" Then Y$ = Left$(Y$, Len(Y$) - 2) + Q$(2)
    If Right$(Y$, 2) = "UU" Then Y$ = Left$(Y$, Len(Y$) - 2) + U$(1)
    If Right$(Y$, 2) = "Q4" Then Y$ = Left$(Y$, Len(Y$) - 2) + Q$(4)
    If Right$(Y$, 3) = " TT" Then Y$ = Left$(Y$, Len(Y$) - 2) + b$(D, B9%(D, 5))
    If Right$(Y$, 2) = "FB" Then Y$ = Left$(Y$, Len(Y$) - 2) + b$(D, B9%(D, 3))
    If Right$(Y$, 3) = " XX" Then Y$ = Left$(Y$, Len(Y$) - 2) + b$(D, B9%(D, 5)) + " and " + b$(D, B9%(D, 6))
    If Right$(Y$, 2) = "YY" Then Y$ = Left$(Y$, Len(Y$) - 2) + b$(D, B9%(D, 3)) + " and " + b$(D, B9%(D, 4))
    If Right$(Y$, 3) = " ZZ" Then Y$ = Left$(Y$, Len(Y$) - 2) + b$(D, B9%(D, 6)) + " and " + b$(D, B9%(D, 4))
    'PRINT Y$; " AFT"
End Sub


'------------------------------
'   GROUNDERPBP Subroutine
'------------------------------
' ...explanation...
Sub GROUNDERPBP (W%, D)
    If W% = 2 Then 3760
    Call RANDNUM(rn)
    Y% = Int(Rnd(1) * 140) + 1930
    If rn <= 35 Then 3752
    If W% = 1 Then Y% = Int(Rnd(1) * 160) + 2070
    If W% = 3 Then Y% = Int(Rnd(1) * 150) + 2230
    If W% = 4 Then Y% = Int(Rnd(1) * 160) + 2380
    If W% = 6 Then Y% = Int(Rnd(1) * 160) + 2540
    If W% = 5 Then Y% = Int(Rnd(1) * 150) + 2700

    3752 Call GETRPBP(Y%, Y$, D): Call STRIPRPBP(Y$, Y%, D)
    Print Y$; " ";

    3751 GoTo 3765

    3760 '*** in front of plate ***
    Y% = Int(Rnd(1) * 25) + 2870
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Print Y$
    Call DELAY

    3765 '
End Sub


'------------------------------
'   GROUNDERS Subroutine
'------------------------------
' ...explanation...
Sub GROUNDERS (W%, D)
    '*** grounders to infielders ***
    X$ = Q$(4)
    If W% = 2 Then 3953
    Y% = Int(Rnd(1) * 120) + 1420
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Print X$; " "; Y$
    Call DELAY
    GoTo 3954

    3953 ' field grounders in front of the plate
    Y% = Int(Rnd(1) * 13) + 2850
    Call GETRPBP(Y%, Y$, D): Call STRIPRPBP(Y$, Y%, D)
    If Left$(Y$, 2) = "QQ" Then Y$ = X$ + Right$(Y$, Len(Y$) - 2)
    Print Y$
    Call DELAY

    3954 '
End Sub


'------------------------------
'   HITS2GAP Subroutine
'------------------------------
' ...explanation...
Sub HITS2GAP (W%, p, I1, D)
    Call GETFIELDER(W%, p, I1, D): i = Int(Rnd(1) * 100) + 1
    If I1 = 1 Then W% = 7
    If I1 = 1 And i <= 15 Then W% = 9
    If I1 = -1 Then W% = 9
    If I1 = -1 And i <= 15 Then W% = 7
    If i <= 5 Then W% = 8
    Q$(4) = b$(D, B9%(D, W%))
End Sub


'------------------------------
'   HOLDSTATUS Subroutine
'------------------------------
' ...explanation...
Sub HOLDSTATUS (H0%)
    Locate 17, 77: Color 15, 2: Print H0$(H0%): Color , 0
End Sub


'------------------------------
'   INCBATDF Subroutine
'------------------------------
' ...explanation...
Sub INCBATDF (D, I5, I6)
    B8%(D, I5, I6) = B8%(D, I5, I6) + 1
    B5%(D, I5, I6) = B5%(D, I5, I6) + 1
End Sub


'------------------------------
'   INCBATOFF Subroutine
'------------------------------
' ...explanation...
Sub INCBATOFF (p, I5, I6)
    B8%(p, I5, I6) = B8%(p, I5, I6) + 1
    B5%(p, I5, I6) = B5%(p, I5, I6) + 1
    If I6 > 8 Or I6 = 2 Or I6 = 3 Then 105
    If P%(1 - p, P1%(1 - p), 0) = 1 Then 105
    If I6 >= 4 Then CSS%(p, I5, I6 - 2) = CSS%(p, I5, I6 - 2) + 1: GoTo 105
    CSS%(p, I5, I6) = CSS%(p, I5, I6) + 1

105 End Sub


'------------------------------
'   INCPITOFF Subroutine
'------------------------------
' ...explanation...
Sub INCPITOFF (p, I5, I6)
    P8%(p, I5, I6) = P8%(p, I5, I6) + 1
    P5%(p, I5, I6) = P5%(p, I5, I6) + 1
End Sub


'------------------------------
'   INCREMENTHIT Subroutine
'------------------------------
' ...explanation...
Sub INCREMENTHIT (p, D, MO)
    If B7%(p, B1!(p)) <> 1 Then I5 = B3%(p, B1!(p)): I6 = 15: Call INCBATOFF(p, I5, I6): GoTo 3646
    I5 = P1%(p): I6 = 37: Call INCPITOFF(p, I5, I6)

    3646 I5 = P1%(D): I6 = 13: Call ADDPIT(D, I5, I6)
    If MO > 0 Then MO = MO - 1
End Sub


'------------------------------
'   INJPIT Subroutine
'------------------------------
' ...explanation...
Sub INJPIT (p, D)
    '*** Defensive Pitcher Ejected/Injured ***
    If u6 = 2 Or u6 = 1 And p <> u9 Then 2755
    Print "You must replace "; p$(D, P1%(D)): Call DELAY: GoTo 2799

    2755 Call RELIEVERS

    2799 '
End Sub


'------------------------------
'   INJURYLENGTH Subroutine
'------------------------------
' ...explanation...
Sub INJURYLENGTH (IJL%, D, po%, u6, p, u9, P9, W5, W6)
    IJL% = IJL% + 1
    IJ$(IJL%) = b$(D, B9%(D, po%))
    Call DELAY: Print b$(D, B9%(D, po%)); " is injured for"
    '*** Determine Injury Length ***
    il = 0
    If b%(D, B9%(D, po%), 3) = 162 Then Print " remainder of game": GoTo 2115
    GoSub 2116
    If il = 0 Then 2115
    If b%(D, B9%(D, po%), 3) = 161 Then Print " this game and next game": il = 1: GoTo 2115
    il = Int(Rnd(1) * (162 - b%(D, B9%(D, po%), 3))) + 1
    Print il; " games"

    2115 b%(D, B9%(D, po%), 32) = b%(D, B9%(D, po%), 32) + il
    Call DELAY: Call DELAY
    Call EJECTIONINJURY(u6, p, u9, D, po%, P9, W5, W6)
    GoTo 2120

    2116 ct = 0
    For I = 0 To 22
        For I1 = 22 To 25
            If b%(D, I, I1) = po% And b%(D, I, 32) = 0 And I <> B9%(D, po%) Then ct = ct + 1
            If ct > 3 Then il = 1: GoTo 2117
        Next
    Next
    Print " remainder of game": il = 0

    2117 Return

    2120
End Sub


'------------------------------
'   INNDISP Subroutine
'------------------------------
' ...explanation...
Sub INNDISP (I2, i)
    If I2 < 4 Then Locate , 3 * I2 + 7
    If I2 > 3 And I2 < 7 Then Locate , 3 * I2 + 8
    If I2 > 6 And I2 < 10 Then Locate , 3 * I2 + 9
    If I2 > 9 And I2 < 13 Then Locate , 3 * (I2 - 9) + 7
    If I2 > 12 And I2 < 16 Then Locate , 3 * (I2 - 9) + 8
    If I2 > 15 And I2 < 19 Then Locate , 3 * (I2 - 9) + 9
    If I2 > 18 And I2 < 22 Then Locate , 3 * (I2 - 18) + 7
    If I2 > 21 And I2 < 25 Then Locate , 3 * (I2 - 18) + 8
    If I2 > 24 And I2 < 28 Then Locate , 3 * (I2 - 18) + 9
    Print Using "##"; s%(i, I2);
End Sub


'------------------------------
'   LDRIVE Subroutine
'------------------------------
' ...explanation...
Sub LDRIVE ()
    Call RANDNUM(rn)
    If rn <= 20 Then X$ = "rips"
    If rn > 20 And rn <= 40 Then X$ = "hammers"
    If rn > 40 And rn <= 60 Then X$ = "lashes"
    If rn > 60 And rn <= 80 Then X$ = "lines"
    If rn > 80 Then X$ = "drives"
    Print " "; X$; " ";
End Sub


'------------------------------
'   LET2NUM Subroutine
'------------------------------
' ...explanation...
Sub LET2NUM (i$)
    If UCase$(i$) = "A" Then i$ = "10"
    If UCase$(i$) = "B" Then i$ = "11"
    If UCase$(i$) = "C" Then i$ = "12"
    If UCase$(i$) = "D" Then i$ = "13"
    If UCase$(i$) = "E" Then i$ = "14"
    If UCase$(i$) = "F" Then i$ = "15"
    If UCase$(i$) = "G" Then i$ = "16"
    If UCase$(i$) = "H" Then i$ = "17"
    If UCase$(i$) = "I" Then i$ = "18"
    If UCase$(i$) = "J" Then i$ = "19"
    If UCase$(i$) = "K" Then i$ = "20"
    If UCase$(i$) = "L" Then i$ = "21"
    If UCase$(i$) = "M" Then i$ = "22"
End Sub


'------------------------------
'   LONGFLY Subroutine
'------------------------------
' ...explanation...
Sub LONGFLY (D, W%)
    Y% = Int(Rnd(1) * 60) + 1310
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Print Y$; " "; C$(W%): Call DELAY
    If WF! < 1 And Rnd(1) > WF! Then Print "The wind is bringing it back...": Call DELAY: GoTo 8055
    If WF! > 1 And Rnd(1) <= 1 - WF! Then Print "It's carrying well in the breeze...": Call DELAY
    Y% = Int(Rnd(1) * 50) + 1370
    Call GETRPBP(Y%, Y$, D)
    Call STRIPRPBP(Y$, Y%, D)
    Print Y$
    Call DELAY
    Call RANDNUM(rn)
    If (l%(1, 13) = 21 Or l%(1, 13) = 27) And W% = 7 Then 8059
    If rn <= 5 Then Print Q$(4); " leaps"
    If rn > 5 And rn <= 10 Then Print Q$(4); " against the wall"
    If rn > 10 And rn <= 20 Then Print Q$(4); " jumps at the wall"
    If rn > 20 And rn <= 30 Then Print Q$(4); " climbs the wall"

    8059 Call DELAY

    8055 Rem
End Sub


'------------------------------
'   MAINSCREEN Subroutine
'------------------------------
' ...explanation...
Sub MAINSCREEN (D, p, BC%, U%, MO)
    For I5 = 5 To 13
        Locate I5, 1
        Print Space$(44);
    Next I5
    Locate 5, 1
    Locate 21, 48: Color 15, 2: Print Tab(62); Chr$(219); Tab(79);: Color 7, 0
    Locate 10, 1: Color l%(D, 11), l%(D, 12)
    Print p$(D, P1%(D)); " "; B1$(p%(D, P1%(D), 0) + 2): Color 15, 0
    Call DISPBAVG(D)
    Color 1: For X = 5 To 13: Locate X, 21: Print Chr$(179);: Next
    Locate 11, 1: Color 2, 0: Print "W-L ERA ";: Color 15, 0
    Print Using "##"; p%(D, P1%(D), 1);: Print "-";: Print Using "##"; p%(D, P1%(D), 2);
    Print " ";: Print Using "##.##"; p%(D, P1%(D), 10) / 100
    Color 2, 0
    Print "  IP  H  BB  K GAME": Color 15, 0
    If P8%(D, P1%(D), 0) = 0 Then Print " 0.0";: GoTo 338
    Print Using "##"; Int(P8%(D, P1%(D), 0) / 3);
    Print ".";: Print Using "#"; P8%(D, P1%(D), 0) - (Int(P8%(D, P1%(D), 0) / 3) * 3);

    338 Print Using " ##  ## ##"; P8%(D, P1%(D), 1); P8%(D, P1%(D), 4); P8%(D, P1%(D), 5)
    Locate 5, 1
    J = B3%(p, B1!(p)): Color l%(p, 11), l%(p, 12)
    If B7%(p, B1!(p)) = 1 Then X$ = p$(p, P1%(p)): Print X$; " "; B1$(p%(p, P1%(p), 0) + 2);: Call PITPLACEMENT(p, X$): GoTo 335
    X$ = b$(p, J): Print X$; " "; B1$(b%(p, J, 0) + 2);
    If b%(p, J, 0) < 0 Or b%(p, J, 0) = 0 And p%(D, P1%(D), 0) > 0 Then Locate 21, 64
    X = Len(X$): If b%(p, J, 0) > 0 Or b%(p, J, 0) = 0 And p%(D, P1%(D), 0) < 0 Then Locate 21, 51 + 10 - X
    Print X$

    335 Locate 6, 1: Color 2, 0: Print " AVG HR  BB   K": Color 15, 0
    If B7%(p, B1!(p)) = 1 Then 336
    If b%(p, J, 4) = 0 Then Print ".000  0   0   0";: GoTo 337
    Print Using ".### ## ### ###"; b%(p, J, 6) / b%(p, J, 4); b%(p, J, 9); b%(p, J, 11); b%(p, J, 12): GoTo 337

    336 If p%(p, P1%(p), 11) <> 999 Then Print Using ".###"; p%(p, P1%(p), 11) / 1000: GoTo 337
    If p%(p, P1%(p), 20) = 0 Then Print ".000 0";: GoTo 337
    Print Using ".### ## ### ###"; p%(p, P1%(p), 22) / p%(p, P1%(p), 20); p%(p, P1%(p), 25); p%(p, P1%(p), 27); p%(p, P1%(p), 28)

    337 Locate 8, 2: If B7%(p, B1!(p)) = 1 Then 332
    Print B8%(p, B3%(p, B1!(p)), 1); "-"; B8%(p, B3%(p, B1!(p)), 0);: GoTo 333

    332 Print P8%(p, P1%(p), 24); "-"; P8%(p, P1%(p), 23);

    333 Print " TODAY"
    Color 14, 0: Locate 3, 58: Print O%(0): Locate 2, 58: Print U%: Locate 1, 58: Print BC%
    Color 15, 2: Locate 22, 46: Print "INFIELD:"
    Locate 23, 46
    If INFPOS% = 0 Then Print "NORMAL    "
    If INFPOS% = 1 Then Print "CORNERS IN"
    If INFPOS% = 2 Then Print "INFIELD IN"
    Call HOLDSTATUS(H0%)
    BK$ = "        "
    Locate 13, 58: Color 15, 2: Print Tab(68);: Locate 14, 58: Print BK$: Locate 13, 58
    I2 = 2: X = 58: Call DISPRUN(I2, p, X)
    If O%(0) <> 3 Then MO = 0
    For WK = 1 To 3
        If B0%(WK, 0) > 0 Then MO = MO + 1
    Next
    Locate 18, 47: Color 15, 2: Print Tab(57);: Locate 19, 47: Print BK$: Locate 18, 47
    I2 = 3: X = 47: Call DISPRUN(I2, p, X)
    Locate 18, 69: Color 15, 2: Print Tab(79);: Locate 19, 70: Print BK$: Locate 18, 69
    I2 = 1: X = 70: Call DISPRUN(I2, p, X)
    Color 15, 0
End Sub


'------------------------------
'   BLANKLINES Subroutine
'------------------------------
' ...explanation...
Sub BLANKLINES ()
    For I5 = 15 To 24
        Locate , 1
        Locate I5
        Print Space$(44);
    Next I5
    Locate 15
    Locate , 1
End Sub


'------------------------------
'   NEWPITCHER Subroutine
'------------------------------
' ...explanation...
Sub NEWPITCHER
    V0 = i
    If S1%(D) <> -1 And P6%(D) > 1 Then I5 = P1%(D): I6 = 22: Call ADDPIT(D, I5, I6)
    P1%(D) = V0
    P6%(D) = P6%(D) + 1
    P%(D, V0, 15) = P6%(D)
    P9 = D
    Call PITSTAM(P9)
    For V0 = 1 To 9
        If B7%(D, V0) = 1 Or B7%(D, V0) = 10 Then
            B3%(D, V0) = P1%(D)
            B7%(D, V0) = 1
            B9%(D, 1) = P1%(D)
            P9 = D
            W5 = P9
            W6 = P9
            VV(P9) = V0
            VV1(P9) = V0
            Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)
        END IF
    NEXT V0
    VV(P9)=1
    VV1(P9)=9
    B9%(D, 1) = P1%(D)
    CALL CHECKSAVE(D, p, S4%)
    W5 = 1 - P9
    W6 = 1 - P9
    VV(1 - P9) = 1
    VV1(1 - P9) = 9
    CALL BLANKLINES
    LOCATE 15, 1
    CALL RANDNUM(rn)
    IF rn <= 50 THEN PRINT "Hold the phone...": CALL DELAY
    PRINT M$(D); " is making a pitching change"
    CALL DELAY: CALL DELAY
    Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)
    CALL FLDDISP (BC%, p, U%, D): CALL MAINSCREEN (D, p, BC%, U%, MO): PPH = 0

8895 pz=1
END SUB


'------------------------------
'   NOJUMP Subroutine
'------------------------------
' ...explanation...
SUB NOJUMP (D)
    Y% = INT(RND(1) * 20) + 1050
    CALL GETRPBP(Y%, Y$, D)
      CALL STRIPRPBP (Y$,Y%,D)
    PRINT Y$:CALL DELAY:CALL DELAY
END SUB


'------------------------------
'   OFFPIT Subroutine
'------------------------------
' ...explanation...
SUB OFFPIT (P9, I5, I6)
    P8%(P9, I5, I6) = P8%(P9, I5, I6) + 1: P5%(P9, I5, I6) = P5%(P9, I5, I6) + 1
END SUB


'------------------------------
'   OUTATFIRST Subroutine
'------------------------------
' ...explanation...
SUB OUTATFIRST (W%, D, fbu%, FB2P%)
    CALL PITCHERNAME(W%, D)
    CALL GROUNDERS(W%, D)
    CALL RANDNUM(rn)
    IF W% = 3 AND rn <= 94 THEN PRINT "he takes it to the bag unassisted": fbu% = 1: GOTO 3745
    IF W% = 3 THEN W% = 1: CALL PITCHERNAME(W%, D): PRINT "He flips it to "; Q$(4); " covering": FB2P% = 1: W% = 3
    IF W% = 4 THEN CALL SECOND2FIRST(D)
    IF W% = 5 OR W% = 6 THEN CALL THROW2FIRST(D)

3745 '
END SUB


'------------------------------
'   OUTFIELDERR Subroutine
'------------------------------
' ...explanation...
SUB OUTFIELDERR ()
    '*** outfielders in trouble ***
    CALL RANDNUM(rn)
    IF rn <= 20 THEN PRINT Q$(4); " can't find it"
    IF rn > 20 AND rn <= 40 THEN PRINT Q$(4); " misjudges it"
    IF rn > 40 AND rn <= 60 THEN PRINT Q$(4); " turns the wrong way"
    IF rn > 60 AND rn <= 80 THEN PRINT Q$(4); " loses it"
    IF rn > 80 THEN PRINT Q$(4); " doesn't see it"
    CALL DELAY
END SUB


'------------------------------
'   OUTFLDLOCATION Subroutine
'------------------------------
' ...explanation...
SUB OUTFLDLOCATION (W%)
    CALL RANDNUM(rn)
    IF W% = 7 OR W% = 8 AND rn > 50 THEN PRINT "lcf"
    IF W% = 9 OR W% = 8 AND rn <= 50 THEN PRINT "rcf"
END SUB


'------------------------------
'   OUTFLDNAME Subroutine
'------------------------------
' ...explanation...
SUB OUTFLDNAME (W%, D)
    W% = 9: i = INT(RND(1) * 100) + 1
    IF i <= 25 THEN W% = 8
    IF i <= 5 THEN W% = 7
    Q$(4) = b$(D, B9%(D, W%))
END SUB


'------------------------------
'   PICKEDOFF Subroutine
'------------------------------
' ...explanation...
SUB PICKEDOFF (D, i)
    '*** picked off ***
    CALL BLANKLINES
    CALL DELIVERY(D): CALL RANDNUM(rn)
    IF rn <= 33 THEN PRINT "NO, "; p$(D, P1%(D)); " throws to "; H$(i - 1)
    IF rn > 33 AND rn <= 66 THEN PRINT "quick move to "; H$(i - 1)
    IF rn > 66 THEN PRINT "pickoff throw to "; H$(i - 1)
    CALL DELAY: CALL RANDNUM(rn)
    IF rn <= 50 THEN PRINT Q$(i - 1); " is picked off base!"
    IF rn > 50 THEN PRINT Q$(i - 1); " is caught napping"
    CALL DELAY: I8 = INT(RND(1) * 100) + 1
    IF I8 <= 25 THEN PRINT "he can't believe it"
    IF I8 > 25 AND I8 <= 50 THEN PRINT "what a teriffic move by "; p$(D, P1%(D))
    CALL DELAY
END SUB


'------------------------------
'   PINCHRUNNER Subroutine
'------------------------------
' ...explanation...
SUB PINCHRUNNER (MS%, A1, S4%, I2, p, PR%, BC%, U%, D, MO)
    ' *** CHECK FOR PINCH RUNNER ***
    i0% = 0
    IF A1 > 1 OR A1 < -2 OR INNING% < 8 THEN 8999
    I2=1
    IF S4% = 1 OR S4% = 5 THEN I2 = 1
    IF S4% = 2 OR S4% = 4 OR S4% = 6 THEN I2 = 2
    ' J REPRESENTS THE SPOT IN THE BATTING ORDER
    ' j1 represents the base
    J = B0%(I2, 0):J1 = I2
    IF J = 0 THEN 8999
    IF MG%(P,771) < > 999 THEN 8000
    FOR I1=772 TO 777
    IF MG%(P,I1) < > -1 AND B%(P,MG%(P,I1),21)=0 THEN I1=MG%(P,I1):GOTO 8001
    MG%(P,I1)=-1
    NEXT
    GOTO 8999

8001 IF B7%(p, J) = 1 THEN 8010
    FOR I = 0 TO 5
    IF MG%(P,I*4+779) = B3%(p, J) THEN 8003
    NEXT
    GOTO 8999

8003 'FOUND A MATCH FOR THE RUNNER ON BASE
    CALL RANDNUM (RN)
    IF INNING%>=MG%(P,I*4+780) AND B%(P,MG%(P,I*4+781),21)=0 AND RN<=MG%(P,I*4+782) THEN B%(P,MG%(P,I*4+781),21)=40+J:GOTO 8993
    GOTO 8999

8010 'PINCH RUNNING FOR THE PITCHER
    IF MG%(P,803)<>999 THEN 8999
    CALL RANDNUM (RN)
    IF P%(P,P1%(P),31)<=MG%(P,804) AND INNING%>=MG%(P,805) AND RN<=MG%(P,806) THEN 8993
    IF P%(P,P1%(P),31)<=MG%(P,807) AND INNING%>=MG%(P,808) AND RN<=MG%(P,809) THEN 8993
    GOTO 8999

8000 IF B7%(p, J) = 1 AND P%(P,P1%(P),31)>4 THEN 8999
    IF B7%(P,J)<>1 AND b%(p, B3%(p, J), 16) > 3 THEN 8999
    I1=-1
    FOR i = 0 TO 22
    IF b$(p, i) = "XXX" OR b%(p, i, 21) > 0 THEN 8992
    FOR I2 = 22 TO 25
    IF B%(P,I,I2) < > -1 AND B%(P,I,I2) = B7%(P,J) AND B7%(P,J) < > 1 THEN I1 = I
    NEXT
    IF b%(p, i, 16) > 5 THEN PR%(i0%) = i: i0% = i0% + 1

8992 NEXT
    IF i0% = 0 OR I1 = -1 AND B7%(P,J) < > 1 THEN 8999
    IF B7%(P,J) < > 1 THEN B%(P,I1,21) = 40 + J
    rn = INT(RND(1) * i0%)
    I1 = PR%(rn)

8993 I2 = J
    q$(j1) = b$(p,i1):b%(p, I1, 21) = 1: B3%(p, I2) = I1: B9%(p, B7%(p, I2)) = I1
    IF B7%(p, I2) = 1 OR B7%(p, I2) = 10 THEN B9%(p, 1) = 99: B9%(p, 0) = I2: B7%(p, I2) = 10
    D0%(p) = D0%(p) + 1: X0%(p, 0, D0%(p)) = B3%(p, I2)
    X0%(p, 1, D0%(p)) = 11:' WAS EQUAL TO B7%(p, I2)
    X0%(p, 2, D0%(p)) = (I2 * 10) + (D0%(p) - 9)
    W5 = p: W6 = p: VV(p) = I2: VV1(p) = I2
    FOR xx = 22 TO 25
    IF B7%(p, I2) = b%(p, I1, xx) THEN b%(p, I1, 15) = b%(p, I1, 33 + (xx - 22) * 2): b%(p, I1, 17) = b%(p, I1, 34 + (xx - 22) * 2): b%(p, I1, 19) = b%(p, I1, xx + 4): GOTO 8995
    NEXT

8995 CALL BLANKLINES
LOCATE 15, 1: PRINT M$(p); " is sending in a pinch runner": PR% = 1
    CALL DELAY: CALL DELAY
    Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)
    CALL FLDDISP(BC%, p, U%, D): CALL MAINSCREEN(D, p, BC%, U%, MO): MS% = 1
    VV(P)=1:VV1(P)=9

8999 '
END SUB


'------------------------------
'   PITCHERNAME Subroutine
'------------------------------
' ...explanation...
SUB PITCHERNAME (W%, D)
    IF W% = 1 THEN Q$(4) = p$(D, P1%(D))
    IF W% <> 1 THEN Q$(4) = b$(D, B9%(D, W%))
END SUB


'------------------------------
'   PITCHOUT Subroutine
'------------------------------
' ...explanation...
SUB PITCHOUT (S4%, TGTBASE%, Q0)
    IF S4% = 5 OR TGTBASE% <> 2 THEN 4883: REM*** PITCH OUT ***
    PJ = INT(RND(1) * 100) + 1
    IF PJ<=8 THEN PRINT "...PITCH OUT!!!": CALL DELAY: Q0 = Q0 - 200

4883 '
END SUB


'------------------------------
'   PITDISP Subroutine
'------------------------------
' ...explanation...
SUB PITDISP (P9)
    CLS
    COLOR 14: PRINT "#"; : COLOR l%(P9, 11), l%(P9, 12): PRINT A$(P9); : COLOR 14, 0
    LOCATE , 18: PRINT "T  IP   H   G GS CG SV HR  BB  SO  W- L   ERA  H G%"
    AA = 0: BB = 21
    FOR i = AA TO BB: IF p%(P9, i, 15) > 0 THEN 206
    COLOR 2, 0
    IF i <= 9 THEN PRINT USING "#"; i;
    IF i > 9 THEN PRINT X$(i - 10);
    COLOR 15, 0
    LOCATE , 3: PRINT p$(P9, i); : LOCATE , 18: PRINT B1$(p%(P9, i, 0) + 2);
    PRINT USING " ### ### ### ## ## ## ## ### ### ##"; p%(P9, i, 6); p%(P9, i, 7); p%(P9, i, 4); p%(P9, i, 5); p%(P9, i, 16); p%(P9, i, 3); p%(P9, i, 13); p%(P9, i, 8); p%(P9, i, 9); p%(P9, i, 1); : PRINT "-";
    PRINT USING "##"; p%(P9, i, 2);
    LOCATE , 59: PRINT USING "##.## # ##"; p%(P9, i, 10) / 100; p%(P9, i, 18); p%(P9, i, 12)

206 NEXT i
END SUB


'------------------------------
'   PITOFF Subroutine
'------------------------------
' ...explanation...
SUB PITOFF (p, I5, I6)
    P8%(p, I5, I6) = P8%(p, I5, I6) - 1: P5%(p, I5, I6) = P5%(p, I5, I6) - 1
END SUB


'------------------------------
'   PITPLACEMENT Subroutine
'------------------------------
' ...explanation...
SUB PITPLACEMENT (p, X$)
    IF p%(p, P1%(p), 0) < 0 THEN LOCATE 21, 64
    IF p%(p, P1%(p), 0) > 0 THEN LOCATE 21, 51
    PRINT X$
END SUB


'------------------------------
'   PITSTAM Subroutine
'------------------------------
' ...explanation...
SUB PITSTAM (P9)
    IF p%(P9, P1%(P9), 4) = 0 THEN S8%(P9, 0) = 3
    IF p%(P9, P1%(P9), 4)<>0 THEN S8%(P9, 0) = INT(((p%(P9, P1%(P9), 8) + p%(P9, P1%(P9), 7)) / p%(P9, P1%(P9), 4)) + .5)
    IF S8%(P9, 0) < 3 THEN S8%(P9, 0) = 3
    S8%(P9, 1) = 3
    IF P6%(P9) > 1 THEN S8%(P9, 1) = 0
     IF CGERA%>0 THEN S8%(P9,0)=S8%(P9,0)+1
    IF CGERA%>0 AND P6%(P9)>1 THEN S8%(P9, 1) = 1
    '1955 - IF RUNS=1 AND HIT+BB INCREMENT BY ONE
     IF INNING% <= 5 AND S6%(P9, 0) - S6%(1 - P9, 0) > 0 THEN P2%(P9) = P1%(P9)
END SUB


'------------------------------
'   PITSTRAT Subroutine
'------------------------------
' ...explanation...
SUB PITSTRAT
      A1 = S6%(D, 0) - S6%(p, 0)
    pz=0
    ' if there is no middle relievers in the profile and less than the 7th
    ' then go back and find one the old fashioned way
    IF MG%(D,60)<>999 AND INNING%<=7 THEN 8195
      'if no closers set up or no closing strategy defined, skip out
    IF INNING%>=8 AND MG%(D,520)<>999 AND MG%(D,90)<>999 OR MG%(D,581)<>999 THEN 8195
      'if still needing middle relief
    IF INNING%<=7 THEN 8115

' we have defined a closing/setup possibility
' identify the stratgey
    I2=0
    FOR I = 582 TO 587
    I2 = I2 + MG%(D,I)
    NEXT
    I3 = INT(RND(1) * I2) + 1
    I2 = 0
    FOR I=582 TO 587
    I2=I2+MG%(D,I)
    IF I3<=I2 THEN SN%=I:GOTO 8111
    NEXT
    GOTO 8195

'strategy identified, now

8111 SF%=0
    IF A1 < 1 THEN 8195
    IF A1 > 0 AND A1 <= 2 THEN SF%=1
    IF S4% = 0 AND A1 <= 2 THEN SF%=1
    IF S4% > 0 AND S4% < 4 AND A1 <= 3 THEN SF%=1
    IF S4% > 3 AND S4% < 7 AND A1 <= 4 THEN SF%=1
    IF S4% = 7 AND A1 <= 5 THEN SF%=1
    IF S4% = 0 AND O%(0) = 0 AND A1 <= 3 THEN SF%=1
      IF B1!(P)<=7 THEN FOR I=0 TO 2:I3=I3+B%(P,B3%(P, B1!(P)+I),0):NEXT
    IF B1!(P)=8 THEN FOR I=0 TO 1:I3=I3+B%(P,B3%(P, B1!(P)+I),0):NEXT:I3=I3+B%(P,B3%(P, 1),0)
    IF B1!(P)=9 THEN FOR I=1 TO 2:I3=I3+B%(P,B3%(P, I),0):NEXT:I3=I3+B%(P,B3%(P, 9),0)

8112 IF I3=0 THEN I3=INT(RND(1)*3)-1
    IF I3=0 THEN 8112
      IF INNING%=8 AND MG%(D,588)=8 AND MG%(D,589)=0 AND SF%=1 AND (SN%=582 OR SN%=587) THEN 8114
    IF INNING%=8 AND MG%(D,588)=8 AND MG%(D,589)=1 AND SF%=1 AND (SN%=582 OR SN%=587) THEN 8113
    IF INNING%>=9 AND SF%=1 AND (SN%=582 OR SN%=587) THEN 8113
      IF INNING%=8 AND MG%(D,588)=8 AND MG%(D,589)=0 AND A1>0 AND SN%=583 THEN 8114
    IF INNING%=8 AND MG%(D,588)=8 AND MG%(D,589)=1 AND A1>0 AND SN%=583 THEN 8113
    IF INNING%>=9 AND A1>0 AND SN%=583 THEN 8113
      IF INNING%=8 AND MG%(D,588)=8 AND MG%(D,589)=0 AND A1>=0 AND SN%=584 THEN 8114
    IF INNING%=8 AND MG%(D,588)=8 AND MG%(D,589)=1 AND A1>=0 AND SN%=584 THEN 8113
    IF INNING%>=9 AND A1>=0 AND SN%=584 THEN 8113
      IF S8%(D, 0) <= P8%(D, P1%(D), 4) + P8%(D, P1%(D), 1) AND S8%(D, 1) <= P8%(D, P1%(D), 2) AND INNING%=8 AND MG%(D,588)=8 AND MG%(D,589)=0 AND A1>0 AND SN%=585 THEN 8114
    IF S8%(D, 0) <= P8%(D, P1%(D), 4) + P8%(D, P1%(D), 1) AND S8%(D, 1) <= P8%(D, P1%(D), 2) AND INNING%=8 AND MG%(D,588)=8 AND MG%(D,589)=1 AND A1>0 AND SN%=585 THEN 8113
    IF S8%(D, 0) <= P8%(D, P1%(D), 4) + P8%(D, P1%(D), 1) AND S8%(D, 1) <= P8%(D, P1%(D), 2) AND INNING%>=9 AND A1>0 AND SN%=585 THEN 8113
      IF S8%(D, 0) <= P8%(D, P1%(D), 4) + P8%(D, P1%(D), 1) AND S8%(D, 1) <= P8%(D, P1%(D), 2) AND INNING%=8 AND MG%(D,588)=8 AND MG%(D,589)=0 AND A1>=0 AND SN%=586 THEN 8114
    IF S8%(D, 0) <= P8%(D, P1%(D), 4) + P8%(D, P1%(D), 1) AND S8%(D, 1) <= P8%(D, P1%(D), 2) AND INNING%=8 AND MG%(D,588)=8 AND MG%(D,589)=1 AND A1>=0 AND SN%=586 THEN 8113
    IF S8%(D, 0) <= P8%(D, P1%(D), 4) + P8%(D, P1%(D), 1) AND S8%(D, 1) <= P8%(D, P1%(D), 2) AND INNING%>=9 AND A1>=0 AND SN%=586 THEN 8113
      GOTO 8195

8114
    I2=0
    IF I3<0 THEN I1=81
    IF I3>0 THEN I1=84
    FOR I=I1 TO I1+2
    IF MG%(D,I)>=0 AND P%(D,MG%(D,I),15)=0 THEN I2=I2+MG%(D,I+10)
    NEXT
    I3 = INT (RND(1) * I2) + 1 : I2 = 0
    FOR I=I1 TO I1+2
    IF MG%(D,I)>=0 AND P%(D,MG%(D,I),15)=0 THEN I2=I2+MG%(D,I+10)
    IF I3<=I2 THEN V0=MG%(D,I):MG%(D,I)=-1:I=V0:CALL NEWPITCHER:SU%(D,0)=-1:GOTO 8195
    NEXT
    'NO SETUP MAN FOUND
    'GOTO 8195

8113
    I2=0
    IF I3<0 THEN I1=521
    IF I3>0 THEN I1=524
    FOR I=I1 TO I1+2
    IF MG%(D,I)>=0 AND P%(D,MG%(D,I),15)=0 THEN I2=I2+MG%(D,I+10)
    NEXT
    I3=INT(RND(1)*I2)+1
    I2=0
    FOR I=I1 TO I1+2
    IF MG%(D,I)>=0 AND P%(D,MG%(D,I),15)=0 THEN I2=I2+MG%(D,I+10)
    IF I3<=I2 THEN V0=MG%(D,I):MG%(D,I)=-1:I=V0:CALL NEWPITCHER:SU%(D,1)=-1:GOTO 8195
    NEXT
    'NO CLOSER FOUND
    'GOTO 8195
    SU%(D,0)=-1:SU%(D,1)=-1

8115 I2=0
    FOR I=61 TO 70
    IF MG%(D,I)>=0 AND P%(D,MG%(D,I),15)=0 THEN I2=I2+MG%(D,I+10)
    NEXT
    I3=INT(RND(1)*I2)+1
    I2=0
    FOR I=61 TO 70
    IF MG%(D,I)>=0 AND P%(D,MG%(D,I),15)=0 THEN I2=I2+MG%(D,I+10)
    IF I3<=I2 THEN V0=MG%(D,I):MG%(D,I)=-1:I=V0:CALL NEWPITCHER: GOTO 8195
    NEXT
    'NO MIDDLE RELIEVER FOUND
    GOTO 8195

8195 '
END SUB


'------------------------------
'   PITSWAP Subroutine
'------------------------------
' ...explanation...
SUB PITSWAP (i)
    IF i = 4 THEN V = 3: CALL SOMESTATS(V, p, F%, D): V = 2: CALL SOMESTATS(V, p, F%, D): V = 1: CALL SOMESTATS(V, p, F%, D)
    IF i = 3 THEN V = 2: CALL SOMESTATS(V, p, F%, D): V = 1: CALL SOMESTATS(V, p, F%, D)
    IF i = 2 THEN V = 2: CALL SOMESTATS(V, p, F%, D): V = 1: CALL SOMESTATS(V, p, F%, D)
END SUB


'------------------------------
'   PLAYERNAME Subroutine
'------------------------------
' ...explanation...
SUB PLAYERNAME (p)
    IF B7%(p, B1!(p)) = 1 THEN Q$(0) = p$(p, P1%(p)): GOTO 8002
    Q$(0) = b$(p, B3%(p, B1!(p)))

8002 FOR i = 1 TO 3
    IF B0%(i, 0) > 0 AND B7%(p, B0%(i, 0)) <> 1 THEN Q$(i) = b$(p, B3%(p, B0%(i, 0)))
    IF B0%(i, 0) > 0 AND B7%(p, B0%(i, 0)) = 1 THEN Q$(i) = p$(p, P1%(p))
    NEXT i
END SUB


'------------------------------
'   PLYRHRT Subroutine
'------------------------------
' ...explanation...
SUB PLYRHRT (p, P9, W5, W6, BC%, U%, D, MO)
    '*** Offensive Player Ejected/Injured ***
    IF u6 = 2 OR u6 = 1 AND p = u9 THEN 2805
    PRINT "You must replace "; Q$(0); " with a pinch-hitter": CALL DELAY: GOTO 2849

2805 FOR i = 0 TO 22: IF b%(p, i, 21) > 0 OR b$(p, i) = "XXX" THEN 2808
    IF B7%(p, B1!(p)) <> b%(p, i, 22) AND B7%(p, B1!(p)) <> b%(p, i, 23) AND B7%(p, B1!(p)) <> b%(p, i, 24) AND B7%(p, B1!(p)) <> b%(p, i, 25) THEN 2808

2807 PRINT Q$(0); " will be replaced by "; b$(p, i): CALL DELAY
    D0%(p) = D0%(p) + 1: X0%(p, 0, D0%(p)) = i: X0%(p, 1, D0%(p)) = B7%(p, B1!(p)): X0%(p, 2, D0%(p)) = (B1!(p) * 10) + (D0%(p) - 9)
    b%(p, i, 21) = 1: B3%(p, B1!(p)) = i: B9%(p, B7%(p, B1!(p))) = i: IF B7%(p, B1!(p)) = 1 OR B7%(p, B1!(p)) = 10 THEN B9%(p, 1) = 99: B9%(p, 0) = B1!(p): B7%(p, B1!(p)) = 10
    P9 = p: W5 = P9: W6 = P9: VV(P9) = B1!(p): VV1(P9) = B1!(p)
    Call HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)
    VV(P9)=1:VV1(P9)=9
    CALL FLDDISP(BC%, p, U%, D): CALL MAINSCREEN(D, p, BC%, U%, MO): LOCATE 15, 1
    Q$(0) = b$(p, B3%(p, B1!(p))): IF B7%(p, B1!(p)) = 1 THEN Q$(0) = p$(p, P1%(D))
    GOTO 2849

2808 NEXT i
    FOR i = 0 TO 22: IF b%(p, i, 21) > 0 OR b$(p, i) = "XXX" THEN 2810
    GOTO 2807

2810 NEXT i

2849 '
END SUB


'------------------------------
'   POPUP Subroutine
'------------------------------
' ...explanation...
SUB POPUP ()
    ' *** POPUP LINEUPS FOR TEAMS ***
    J = 11
    LOCATE 8, 7: COLOR l%(1, 11), l%(1, 12): PRINT " Ö"; STRING$(62, 196); "· ";
    FOR II = 1 TO J: LOCATE 8 + II, 7: PRINT " º"; STRING$(62, 32); "º "; : NEXT
    LOCATE 9 + J, 7: PRINT " Ó"; STRING$(62, 196); "½ ";
    LOCATE 9, 14: PRINT A$(0); TAB(40); A$(1)
    FOR J = 0 TO 1
    FOR X = 1 TO 9: LOCATE X + 9, 9 + J * 26
    IF B1!(J) = X THEN PRINT "->";
    LOCATE , 11 + J * 26
    IF B7%(J, X) <> 1 THEN 841
    PRINT B1$(p%(J, P1%(J), 0) + 2); TAB(14 + J * 26); LEFT$(p$(J, P1%(J)), 10); " p"; TAB(28 + J * 26);
    IF p%(J, P1%(J), 11) <> 999 THEN PRINT USING " .###"; p%(J, P1%(J), 11) / 1000: GOTO 842
    IF p%(J, P1%(J), 20) = 0 THEN PRINT " .000": GOTO 842
    IF p%(J, P1%(J), 20) = p%(J, P1%(J), 22) THEN PRINT "1.000": GOTO 842
    PRINT USING " .###"; p%(J, P1%(J), 22) / p%(J, P1%(J), 20)
    GOTO 842

841 PRINT B1$(b%(J, B3%(J, X), 0) + 2); TAB(14 + J * 26); LEFT$(b$(J, B3%(J, X)), 10); " "; C$(B7%(J, X)); TAB(28 + J * 26);
    IF b%(J, B3%(J, X), 4) = 0 THEN PRINT " .000": GOTO 842
    IF b%(J, B3%(J, X), 6) = b%(J, B3%(J, X), 4) THEN PRINT "1.000": GOTO 842
    PRINT USING " .###"; b%(J, B3%(J, X), 6) / b%(J, B3%(J, X), 4)

842 NEXT: NEXT: COLOR 15, 0

    LOCATE 24, 1: PRINT "Hit any key to continue";
843 I$ = GetKeyPress$

END SUB


'------------------------------
'   POPUPBAT Subroutine
'------------------------------
' ...explanation...
SUB POPUPBAT (WK, M)
    IF TS%(WK,0)=999 THEN LOCATE 4,56:PRINT "VS LHP  .000";
    IF TS%(WK,0)=999 AND B%(WK,M,42)<>0 THEN LOCATE 4,64:PRINT USING ".###";B%(WK,M,43)/B%(WK,M,42)
    IF TS%(WK,0)=999 THEN LOCATE 5,56:PRINT "VS RHP  .000";
    IF TS%(WK,0)=999 AND B%(WK,M,49)<>0 THEN LOCATE 5,64:PRINT USING ".###";B%(WK,M,50)/B%(WK,M,49)
    LOCATE 8, 6: PRINT "SEASON"; : LOCATE , 15
    IF b%(WK, M, 4) = 0 THEN PRINT ".---  .---":GOTO 734
    PRINT USING ".###  .### ### ### ### ### ## ## ## ### ### ### "; b%(WK, M, 6) / b%(WK, M, 4); (b%(WK, M, 6) + b%(WK, M, 11)) / (b%(WK, M, 4) + b%(WK, M, 11)); b%(WK, M, 3); b%(WK, M, 4); b%(WK, M, 5); b%(WK, M, 6); b%(WK, M, 7); b%(WK, M, 8); b%( _
WK, M, 9); b%(WK, M, 10);
    PRINT USING "### ### ### ##"; b%(WK, M, 11); b%(WK, M, 12); b%(WK, M, 13); b%(WK, M, 14)

734 LOCATE , 6: PRINT "LEAGUE";
    IF B5%(WK, M, 0) = 0 OR B5%(WK, M, 1) = 0 THEN LOCATE , 15: PRINT ".000"; : GOTO 735
    IF B5%(WK, M, 0) = B5%(WK, M, 1) THEN LOCATE , 14: PRINT "1.000"; : GOTO 735
    LOCATE , 15: PRINT USING ".###"; B5%(WK, M, 1) / B5%(WK, M, 0);

735 IF B5%(WK, M, 0) + B5%(WK, M, 7) = 0 THEN LOCATE , 21: PRINT ".000"; : GOTO 736
    IF B5%(WK, M, 1) + B5%(WK, M, 7) = B5%(WK, M, 0) + B5%(WK, M, 7) THEN LOCATE , 20: PRINT "1.000"; : GOTO 736
    LOCATE , 21: PRINT USING ".###"; (B5%(WK, M, 1) + B5%(WK, M, 7)) / (B5%(WK, M, 0) + B5%(WK, M, 7));

736 LOCATE , 26: PRINT USING "### ### ### ### ## ## ## ### ### ### ### ## ## ##"; B5%(WK, M, 14); B5%(WK, M, 0); B5%(WK, M, 2); B5%(WK, M, 1); B5%(WK, M, 4); B5%(WK, M, 5); B5%(WK, M, 6); B5%(WK, M, 3); B5%(WK, M, 7); B5%(WK, M, 8); B5%(WK, M, 9);  _
B5%(WK, M, 10); B5%(WK, M, 12); B5%(WK, M, 13)
    LOCATE , 6: PRINT "GAME";
    IF B8%(WK, M, 0) = 0 OR B8%(WK, M, 1) = 0 THEN LOCATE , 15: PRINT ".000"; : GOTO 737
    IF B8%(WK, M, 0) = B8%(WK, M, 1) THEN LOCATE , 14: PRINT "1.000"; : GOTO 737
    LOCATE , 15: PRINT USING ".###"; B8%(WK, M, 1) / B8%(WK, M, 0);

737 IF B8%(WK, M, 0) + B8%(WK, M, 7) = 0 THEN LOCATE , 21: PRINT ".000"; : GOTO 738
    IF B8%(WK, M, 1) + B8%(WK, M, 7) = B8%(WK, M, 0) + B8%(WK, M, 7) THEN LOCATE , 20: PRINT "1.000"; : GOTO 738
    LOCATE , 21: PRINT USING ".###"; (B8%(WK, M, 1) + B8%(WK, M, 7)) / (B8%(WK, M, 0) + B8%(WK, M, 7));

738 LOCATE , 26: PRINT USING "### ### ### ### ## ## ## ### ### ### ### ## ## ##"; B8%(WK, M, 14); B8%(WK, M, 0); B8%(WK, M, 2); B8%(WK, M, 1); B8%(WK, M, 4); B8%(WK, M, 5); B8%(WK, M, 6); B8%(WK, M, 3); B8%(WK, M, 7); B8%(WK, M, 8); B8%(WK, M, 9);  _
B8%(WK, M, 10); B8%(WK, M, 12); B8%(WK, M, 13)
END SUB


'------------------------------
'   POPUPPIT Subroutine
'------------------------------
' ...explanation...
SUB POPUPPIT (WK, M)
    LOCATE 14, 3: : COLOR l%(WK, 11), l%(WK, 12): PRINT " "; CHR$(201); STRING$(71, 205); CHR$(187); " "
    FOR X = 1 TO 7: LOCATE , 3: PRINT " "; CHR$(186); STRING$(71, 32); CHR$(186); " ": NEXT
    LOCATE , 3: PRINT " "; CHR$(200); STRING$(71, 205); CHR$(188); " "
    IF TS%(WK,0)=999 THEN LOCATE 15,56:PRINT "VS LHB  .000";
    IF TS%(WK,0)=999 AND P%(WK,M,51)<>0 THEN LOCATE 15,64:PRINT USING ".###";P%(WK,M,52)/P%(WK,M,51)
    IF TS%(WK,0)=999 THEN LOCATE 16,56:PRINT "VS RHB  .000";
    IF TS%(WK,0)=999 AND P%(WK,M,58)<>0 THEN LOCATE 16,64:PRINT USING ".###";P%(WK,M,59)/P%(WK,M,58)
    LOCATE 15, 6: PRINT "Stats for "; p$(WK, M)
    LOCATE , 6: PRINT "THROWS: "; B1$(p%(WK, M, 0) + 2); "    "; : PRINT USING "G/A%: ##     HOLD: #"; p%(WK, M, 12); p%(WK, M, 18)
    LOCATE , 3: PRINT " "; CHR$(204); STRING$(71, 205); CHR$(185); " "
    LOCATE , 6: PRINT "          W  L SV   ERA  G GS CG   IP    H  BB  SO   R  ER HR"
    LOCATE , 6: PRINT "SEASON   "; : PRINT USING "## ## ## ##.## ## ## ## ###   ### "; p%(WK, M, 1); p%(WK, M, 2); p%(WK, M, 3); p%(WK, M, 10) / 100; p%(WK, M, 4); p%(WK, M, 5); p%(WK, M, 16); p%(WK, M, 6); p%(WK, M, 7);
    PRINT USING "### ###         ##"; p%(WK, M, 8); p%(WK, M, 9); p%(WK, M, 13)
    LOCATE , 6: PRINT "LEAGUE   "; : PRINT USING "## ## ## "; P5%(WK, M, 6); P5%(WK, M, 7); P5%(WK, M, 12);
    IF P5%(WK, M, 3) = 0 OR P5%(WK, M, 0) = 0 THEN PRINT " 0.00"; : GOTO 805
    PRINT USING "##.##"; P5%(WK, M, 3) / (P5%(WK, M, 0) / 3) * 9;

805 PRINT USING " ## ## ## "; P5%(WK, M, 8); P5%(WK, M, 9); P5%(WK, M, 10);
    IF P5%(WK, M, 0) = 0 THEN PRINT "  0.0"; : GOTO 806
    PRINT USING "###"; INT(P5%(WK, M, 0) / 3);
    PRINT "."; : PRINT USING "#"; P5%(WK, M, 0) - (INT(P5%(WK, M, 0) / 3) * 3);

806 PRINT USING " ### ### ### ### ### ##"; P5%(WK, M, 1); P5%(WK, M, 4); P5%(WK, M, 5); P5%(WK, M, 2); P5%(WK, M, 3); P5%(WK, M, 14)
    LOCATE , 6: PRINT "GAME     "; : PRINT USING "## ## ## "; P8%(WK, M, 6); P8%(WK, M, 7); P8%(WK, M, 12);
    IF P8%(WK, M, 3) = 0 OR P8%(WK, M, 0) = 0 THEN PRINT " 0.00"; : GOTO 807
    PRINT USING "##.##"; P8%(WK, M, 3) / (P8%(WK, M, 0) / 3) * 9;

807 PRINT USING " ## ## ## "; P8%(WK, M, 8); P8%(WK, M, 9); P8%(WK, M, 10);
    IF P8%(WK, M, 0) = 0 THEN PRINT "  0.0"; : GOTO 808
    PRINT USING "###"; INT(P8%(WK, M, 0) / 3);
    PRINT "."; : PRINT USING "#"; P8%(WK, M, 0) - (INT(P8%(WK, M, 0) / 3) * 3);

808 PRINT USING " ### ### ### ### ### ##"; P8%(WK, M, 1); P8%(WK, M, 4); P8%(WK, M, 5); P8%(WK, M, 2); P8%(WK, M, 3); P8%(WK, M, 14)
END SUB


'------------------------------
'   POPUPSTATS Subroutine
'------------------------------
' ...explanation...
SUB POPUPSTATS ()
    J = B3%(p, B1!(p))
    LOCATE 3, 3: COLOR l%(p, 11), l%(p, 12): PRINT " "; CHR$(201); STRING$(71, 205); CHR$(187); " "
    FOR X = 1 TO 7: LOCATE , 3: PRINT " "; CHR$(186); STRING$(71, 32); CHR$(186); " ": NEXT
    LOCATE , 3: PRINT " "; CHR$(200); STRING$(71, 205); CHR$(188); " "
    LOCATE 4, 6: PRINT "Stats for ";
    IF B7%(p, B1!(p)) = 1 AND p%(p, P1%(p), 11) <> 999 THEN PRINT p$(p, P1%(p)): GOTO 510
    IF B7%(p, B1!(p)) = 1 THEN PRINT p$(p, P1%(p)): LOCATE , 6: PRINT "BATS: "; B1$(p%(p, P1%(p), 0) + 2); "    "; : PRINT USING "G/A%: ##       BUNT: #       RUN: #"; 52; p%(p, P1%(p), 32); p%(p, P1%(p), 31): GOTO 510
    PRINT b$(p, J): LOCATE , 6: PRINT "BATS: "; B1$(b%(p, J, 0) + 2); "    "; : PRINT USING "G/A%: ##       BUNT: #       RUN: #"; b%(p, J, 18); b%(p, J, 30); b%(p, J, 16)

510 IF B7%(P, B1!(P)) = 1 AND TS%(P,0)=999 THEN LOCATE 4,56:PRINT "VS LHP  .000";
    IF B7%(P, B1!(P)) = 1 AND TS%(P,0)=999 AND P%(P,P1%(P),37)<>0 THEN LOCATE 4,64:PRINT USING ".###";P%(P,P1%(P),38)/P%(P,P1%(P),37)
    IF B7%(P, B1!(P)) = 1 AND TS%(P,0)=999 THEN LOCATE 5,56:PRINT "VS RHP  .000";
    IF B7%(P, B1!(P)) = 1 AND TS%(P,0)=999 AND P%(P,P1%(P),44)<>0 THEN LOCATE 5,64:PRINT USING ".###";P%(P,P1%(P),45)/P%(P,P1%(P),44)
    LOCATE 6, 3: PRINT " "; CHR$(204); STRING$(71, 205); CHR$(185); " "
    LOCATE , 6: PRINT "          AVG   OBP   G  AB   R   H 2B 3B HR RBI  BB  SO  SB CS HS LS"
    IF B7%(p, B1!(p)) = 1 AND p%(p, P1%(p), 11) <> 999 THEN LOCATE , 6: PRINT "SEASON"; : LOCATE , 15: PRINT USING ".###"; p%(p, P1%(p), 11) / 1000: GOTO 520
    IF B7%(p, B1!(p)) = 1 THEN 517
    WK = p
    M = J
    CALL POPUPBAT(WK, M)
    GOTO 621

517 LOCATE , 6: PRINT "SEASON"; : LOCATE , 15
    IF p%(p, P1%(p), 20) = 0 THEN PRINT ".---  .---":GOTO 520
    PRINT USING ".###  .### ### ### ### ### ## "; p%(p, P1%(p), 22) / p%(p, P1%(p), 20); (p%(p, P1%(p), 22) + p%(p, P1%(p), 27)) / (p%(p, P1%(p), 27) + p%(p, P1%(p), 20)); p%(p, P1%(p), 19); p%(p, P1%(p), 20); p%(p, P1%(p), 21); p%(p, P1%(p), 22);  _
p%(p, P1%(p), 23);
    PRINT USING "## ## ### ### ### ### ##"; p%(p, P1%(p), 24); p%(p, P1%(p), 25); p%(p, P1%(p), 26); p%(p, P1%(p), 27); p%(p, P1%(p), 28); p%(p, P1%(p), 29); p%(p, P1%(p), 30)

520 LOCATE , 6: PRINT "LEAGUE"; : J = P1%(p)
    IF P5%(p, J, 23) = 0 OR P5%(p, J, 24) = 0 THEN LOCATE , 15: PRINT ".000"; : GOTO 521
    IF P5%(p, J, 23) = P5%(p, J, 24) THEN LOCATE , 14: PRINT "1.000"; : GOTO 521
    LOCATE , 15: PRINT USING ".###"; P5%(p, J, 24) / P5%(p, J, 23);

521 IF P5%(p, J, 23) + P5%(p, J, 30) = 0 THEN LOCATE , 21: PRINT ".000"; : GOTO 522
    IF P5%(p, J, 24) + P5%(p, J, 30) = P5%(p, J, 23) + P5%(p, J, 30) THEN LOCATE , 20: PRINT "1.000"; : GOTO 522
    LOCATE , 21: PRINT USING ".###"; (P5%(p, J, 24) + P5%(p, J, 30)) / (P5%(p, J, 23) + P5%(p, J, 30));

522 LOCATE , 26: PRINT USING "### ### ### ### ## ## ## ### ### ### ### ## ## ##"; P5%(p, J, 8); P5%(p, J, 23); P5%(p, J, 25); P5%(p, J, 24); P5%(p, J, 27); P5%(p, J, 28); P5%(p, J, 29); P5%(p, J, 26); P5%(p, J, 30); P5%(p, J, 31); P5%(p, J, 32);  _
P5%(p, J, 33); P5%(p, J, 35); P5%(p, J, 36)
    LOCATE , 6: PRINT "GAME";
    IF P8%(p, J, 23) = 0 OR P8%(p, J, 24) = 0 THEN LOCATE , 15: PRINT ".000"; : GOTO 523
    IF P8%(p, J, 23) = P8%(p, J, 24) THEN LOCATE , 14: PRINT "1.000"; : GOTO 523
    LOCATE , 15: PRINT USING ".###"; P8%(p, J, 24) / P8%(p, J, 23);

523 IF P8%(p, J, 23) + P8%(p, J, 30) = 0 THEN LOCATE , 21: PRINT ".000"; : GOTO 524
    IF P8%(p, J, 24) + P8%(p, J, 30) = P8%(p, J, 23) + P8%(p, J, 30) THEN LOCATE , 20: PRINT "1.000"; : GOTO 524
    LOCATE , 21: PRINT USING ".###"; (P8%(p, J, 24) + P8%(p, J, 30)) / (P8%(p, J, 23) + P8%(p, J, 30));

524 LOCATE , 26: PRINT USING "### ### ### ### ## ## ## ### ### ### ### ## ## ##"; P8%(p, J, 8); P8%(p, J, 23); P8%(p, J, 25); P8%(p, J, 24); P8%(p, J, 27); P8%(p, J, 28); P8%(p, J, 29); P8%(p, J, 26); P8%(p, J, 30); P8%(p, J, 31); P8%(p, J, 32);  _
P8%(p, J, 33); P8%(p, J, 35); P8%(p, J, 36)

621 WK = D
    M = P1%(D)
    CALL POPUPPIT(WK, M)

    LOCATE 24, 1: PRINT "Hit any key to continue";
650 I$ = GetKeyPress$
    COLOR 7, 0
END SUB


'------------------------------
'   PUTOUT Subroutine
'------------------------------
' ...explanation...
SUB PUTOUT (i, D, p)
    IF B7%(p, B0%(i - 1, 0)) = 1 THEN I5 = P1%(p): I6 = 33: CALL INCPITOFF(P, I5, I6)
    IF B7%(p, B0%(i - 1, 0)) <> 1 THEN I5 = B3%(p, B0%(i - 1, 0)): I6 = 10: CALL INCBATOFF(P, I5, I6)
END SUB


'------------------------------
'   RANDNUM Subroutine
'------------------------------
' ...explanation...
SUB RANDNUM (rn)
    rn = INT(RND(1) * 100) + 1
END SUB


'------------------------------
'   RecordOut Subroutine
'------------------------------
' ...explanation...
SUB RecordOut (i, I3)
    PRINT Q$(i); " out @ "; H$(I3)
    B0%(i, 0) = 0: B0%(i, 1) = 0: B0%(i, 2) = 0
    Q$(i) = ""
    CALL DELAY
END SUB


'------------------------------
'   RecordRun Subroutine
'------------------------------
' ...explanation...
SUB RecordRun (sah%, i, D, F%, PQ, S2%, W%, INFPOS%)
    IF sah% = 0 THEN PRINT Q$(i); " scores"
    sah% = 0
    I5 = B0%(i, 1): I6 = 2: CALL ADDPIT (D, I5, I6)
    IF P1%(D) <> B0%(i, 1) THEN I5 = P1%(D): I6 = 18: CALL ADDPIT (D, I5, I6)
    IF P6%(p) = 1 THEN P8%(p, P1%(p), 20) = P8%(p, P1%(p), 20) + 1
    IF B7%(p, B0%(i, 0)) = 1 THEN I5 = P1%(p): I6 = 25: CALL INCPITOFF (P, I5, I6)
    IF B7%(p, B0%(i, 0)) <> 1 THEN I5 = B3%(p, B0%(i, 0)): I6 = 2: CALL INCBATOFF (P, I5, I6)
    IF F% = 1 AND O%(0) = 2 THEN PQ = 8: GOTO 4220
    IF F% = 1 AND W% <= 3 AND S2% <> 23 OR F% = 1 AND W% = 5 AND S2% <> 23 THEN PQ = 8: GOTO 4220
    IF F% = 1 AND W% = 4 AND INFPOS% = 2 THEN PQ = 8: GOTO 4220
    IF F% = 1 AND W% = 6 AND INFPOS% = 2 THEN PQ = 8: GOTO 4220
    IF S2% >= 4 AND S2% <= 6 THEN PQ = 8: GOTO 4220

4220 '
    IF PQ = 8 THEN 1825
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 26: CALL INCPITOFF(P, I5, I6)
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 3: CALL INCBATOFF (P, I5, I6)
    IF F% = 1 THEN PQ = 8

1825 s%(p, INNING%) = s%(p, INNING%) + 1: S6%(p, 0) = S6%(p, 0) + 1
    IF S6%(p, 0) - S6%(D, 0) = 1 THEN P2%(D) = B0%(i, 1): P2%(p) = P1%(p): S1%(1) = -1: S1%(0) = -1: GOTO 1155
    IF S6%(p, 0) - S6%(D, 0) = 0 AND S1%(D) <> -1 THEN I5 = P1%(D): I6 = 19: CALL ADDPIT(D, I5, I6): S1%(D) = -1

1155 B0%(i, 0) = 0: B0%(i, 1) = 0: B0%(i, 2) = 0: Q$(i) = "": CALL DELAY
    IF s%(p, INNING%) = 4 AND INT(RND(1)*100)+1<=25 THEN PRINT "They're tearin' up the peapatch!": CALL DELAY
    IF INNING% >= 9 AND p = 1 AND S6%(p, 0) - S6%(D, 0) = 1 AND F% = 0 AND O%(1) < 3 AND S2% <> 10 THEN CALL CHARGERUN (D,i)
    IF INNING% >= 9 AND p = 1 AND S6%(p, 0) - S6%(D, 0) = 1 AND S2% <> 10 THEN A5%(0) = 0: A5%(1) = 0: A5%(2) = 0: A5%(3) = 0
END SUB


'------------------------------
'   OPTIONS Subroutine
'------------------------------
' ...explanation...
SUB OPTIONS ()
DIM u6$(3)
    U6$(0) = "HUMAN OPPONENT      "
    U6$(1) = "COMPUTER VISIT TEAM "
    U6$(2) = "COMPUTER HOME TEAM  "
    U6$(3) = "COMPUTER VS COMPUTER"

IF U6 = 2 THEN U6 = 3:GOTO 170
IF U6 = 1 AND U9 = 1 THEN U6 = 2:GOTO 170
IF U6 = 1 AND U9 = 0 THEN U6 = 1

170 CLS

171 COLOR , 0: LOCATE 3, 1
    COLOR 14: PRINT "(1) "; : COLOR 15: PRINT U6$(U6)
    COLOR 14: PRINT "(2) "; : COLOR 15: PRINT USING "DISPLAY INTERVAL: #.# "; displayPause
    COLOR 14: PRINT "<ENTER> ";:COLOR 15:PRINT "RETURN TO GAME PLAY"

183 COLOR 7, 0
    LOCATE 24, 1: PRINT "Hit any key to continue";
    I$=GetKeyPress$
    I = VAL(I$)
    IF I < 0 OR I > 2 THEN 183
    if i = 0 then 184
    IF I = 1 THEN U6 = U6 + 1
    IF U6 > 3 THEN U6 = 0
    IF I = 1 THEN 171
    IF I = 2 THEN LOCATE 4, 22: INPUT displayPause: GOTO 171

184 IF U6 = 0 THEN 185
IF U6 = 3 THEN U6 = 2:GOTO 185
IF U6 = 2 THEN U6 = 1:u9 = 1:GOTO 185
U6 = 1:u9 = 0

185 '
END SUB

'------------------------------
'   CONVNAME Subroutine
'------------------------------
' ...explanation...
SUB CONVNAME (QQ,I)
    N$(I) = A$(I)
    FOR xx = 4 TO 11
    IF MID$(N$(I), xx, 1) = " " OR MID$(N$(I), xx, 1) = "." THEN MID$(N$(I), xx, 1) = "_"
    NEXT xx
    QQ = 8
    FOR xx = 11 TO 4 STEP -1
    IF MID$(N$(I), xx, 1) = "_" THEN QQ = xx - 4: GOTO 118
    GOTO 119

118 NEXT xx

119 '
END SUB


'------------------------------
'   DISPBAVG Subroutine
'------------------------------
' ...explanation...
SUB DISPBAVG (D)
    IF INNING% > 5 AND S8%(D, 0) < P8%(D, P1%(D), 4) + P8%(D, P1%(D), 1) AND S8%(D, 1) < P8%(D, P1%(D), 2) THEN LOCATE 10, 17: COLOR 30, 0: PRINT "-T-": COLOR 15, 0
    LOCATE 5, 1
    FOR X = 1 TO 9: COLOR 3, 0: LOCATE X + 4, 22
    IF B1!(p) = X THEN COLOR 11, 0
    LOCATE , 22: IF B7%(p, X) <> 1 THEN 358
    PRINT B1$(p%(p, P1%(p), 0) + 2); TAB(25); LEFT$(p$(p, P1%(p)), 10); " p"; TAB(39);
    IF p%(p, P1%(p), 11) <> 999 THEN PRINT USING " .###"; p%(p, P1%(p), 11) / 1000: GOTO 359
    IF p%(p, P1%(p), 20) = 0 THEN PRINT " .000": GOTO 359
    IF p%(p, P1%(p), 20) = p%(p, P1%(p), 22) THEN PRINT "1.000": GOTO 359
    PRINT USING " .###"; p%(p, P1%(p), 22) / p%(p, P1%(p), 20)
    GOTO 359

358 PRINT B1$(b%(p, B3%(p, X), 0) + 2); TAB(25); LEFT$(b$(p, B3%(p, X)), 10); " "; C$(B7%(p, X)); TAB(39);
    IF b%(p, B3%(p, X), 4) = 0 THEN PRINT " .000": GOTO 359
    IF b%(p, B3%(p, X), 6) = b%(p, B3%(p, X), 4) THEN PRINT "1.000": GOTO 359
    PRINT USING " .###"; b%(p, B3%(p, X), 6) / b%(p, B3%(p, X), 4)

359 NEXT: COLOR 15, 0
END SUB


'------------------------------
'   GETSTATS Subroutine
'------------------------------
' ...explanation...
SUB GETSTATS ()
    I = 0

100 COLOR 15, 0: CLS : CALL CONVNAME (QQ,I): F$ = MID$(N$(I), 4, QQ): R$ = F$ + "." + LEFT$(N$(I), 2)
    
102 FILENAME$ = D$(1) + R$
    IF NOT _FILEEXISTS(FILENAME$) THEN 110
OPEN D$(1) + R$ FOR INPUT AS #1
    INPUT #1, A$: INPUT #1, W2%: INPUT #1, L2%
    FOR I1 = 0 TO 22: INPUT #1, K$: INPUT #1, K%: NEXT I1
    FOR I1 = 0 TO 21: INPUT #1, K$: INPUT #1, K%: NEXT I1
    FOR I1 = 0 TO 22: FOR I2 = 0 TO 21: INPUT #1, B5%(I, I1, I2): NEXT: NEXT
    FOR I1 = 0 TO 21: FOR I2 = 0 TO 41: INPUT #1, P5%(I, I1, I2): NEXT: NEXT

110 CLOSE #1
    IF I = 0 THEN I = 1: GOTO 100
END SUB


'------------------------------
'   HITTINGLINES Subroutine
'------------------------------
' ...explanation...
SUB HITTINGLINES '(L%(), P%(), P1%(), B7%(), B%(), VV(), VV1(), B3%(), B4%(), K9!(), WF!)
    RANDOMIZE TIMER
    CLS 
	PRINT "Please Wait..."
    PRINT
    PRINT "Calculating Pitcher/Batter Park Effects..."
    FOR I = 0 TO 1
    I1 = 1 - I

'CALCULATE BASE ON BALLS PERCENTAGES
     FOR I3 = VV(I) TO VV1(I)
    I6! = l%(I1, 3) / 1000
    IF p%(I1, P1%(I1), 6) * 3 * .94 + p%(I1, P1%(I1), 7) + p%(I1, P1%(I1), 8)=0 THEN I2!=0:GOTO 221
    I2! = p%(I1, P1%(I1), 8) / (p%(I1, P1%(I1), 6) * 3 * .94 + p%(I1, P1%(I1), 7) + p%(I1, P1%(I1), 8))
    'I2! = p%(I1, P1%(I1), 8) / (((p%(I1, P1%(I1), 6) * 3) * .94) + p%(I1, P1%(I1), 7) + p%(I1, P1%(I1), 8))

221 GOSUB 500
     IF TS%(I1,0)=999 AND P%(I1, P1%(I1), 89)<>0 THEN I6! = SA%(I1,TY%*6+ 3) / 1000:I2! = P%(I1, P1%(I1),56+PY%*7)*.9/ (P%(I1, P1%(I1),51+PY%*7) + P%(I1, P1%(I1),56+PY%*7)*.9)
     IF B7%(I, I3) = 1 AND p%(I, P1%(I), 11) <> 999 THEN I7! = .037: GOTO 223
    IF B7%(I, I3) = 1 AND (p%(I, P1%(I), 27) + p%(I, P1%(I), 20) = 0) THEN I7! = 0: GOTO 223
    IF B7%(I, I3) = 1 AND TS%(I,0)=999 AND P%(I, P1%(I),37+BY%*7) + P%(I, P1%(I),42+BY%*7) = 0 THEN I7! = 0: GOTO 223
    IF B7%(I, I3) = 1 AND TS%(I,0)<>999 THEN I7! = p%(I, P1%(I), 27) / (p%(I, P1%(I), 27) + p%(I, P1%(I), 20)): GOTO 223
    IF B7%(I, I3) = 1 AND TS%(I,0)=999 THEN I7! = P%(I, P1%(I),42+BY%*7)*.9 / (P%(I, P1%(I),42+BY%*7)*.9 + P%(I, P1%(I),37+BY%*7)): GOTO 223
     IF b%(I, B3%(I, I3), 4) + b%(I, B3%(I, I3), 11) = 0 THEN I7! = 0: GOTO 223
    IF TS%(I,0)=999 AND b%(I, B3%(I, I3), 47+BY%*7) + b%(I, B3%(I, I3), 42+BY%*7) = 0 THEN I7! = 0: GOTO 223
    IF TS%(I,0)=999 AND B%(I, B3%(I ,I3), 80) <>0 THEN I7! = b%(I, B3%(I, I3), 47+BY%*7)*.9 / (b%(I, B3%(I, I3), 42+BY%*7) + b%(I, B3%(I, I3), 47+BY%*7)*.9):GOTO 223
    I7! = b%(I, B3%(I, I3), 11) / (b%(I, B3%(I, I3), 4) + b%(I, B3%(I, I3), 11))

223 CALL NORMALIZE (I7!, I2!, I6!, K8!)
    B4%(I, 5, I3) = K8!
    NEXT I3

' CALCULATE STRIKEOUT PERCENTAGES
    FOR I3 = VV(I) TO VV1(I)
    IF p%(I1, P1%(I1), 6) = 0 THEN I2!=0:GOTO 222
    I2! = p%(I1, P1%(I1), 9) / ((p%(I1, P1%(I1), 6) * 3) * .94)

222 I6! = l%(I1, 2) / 1000
    GOSUB 500
    IF TS%(I1,0)=999 AND P%(I1, P1%(I1), 89)<>0 AND P%(I1, P1%(I1),51+PY%*7) - P%(I1, P1%(I1),52+PY%*7) = 0 THEN I2!=0:GOTO 224
    IF TS%(I1,0)=999 AND P%(I1, P1%(I1), 89)<>0 THEN I2! = P%(I1, P1%(I1),57+PY%*7) / (P%(I1, P1%(I1),51+PY%*7) - P%(I1, P1%(I1),52+PY%*7))

224 IF TS%(I1,0)=999 AND P%(I1, P1%(I1), 89)<>0 THEN I6! = SA%(I1,TY%*6+ 2) / 1000
     IF B7%(I, I3) = 1 AND p%(I, P1%(I), 11) <> 999 THEN I7! = .42: GOTO 282
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 20) - p%(I, P1%(I), 22) = 0 THEN I7! = 0: GOTO 282
    IF B7%(I, I3) = 1 AND TS%(I,0)=999 AND P%(I, P1%(I),37+BY%*7) - P%(I, P1%(I),38+BY%*7)=0 THEN I7! = 0: GOTO 282
    IF B7%(I, I3) = 1 AND TS%(I,0)=999 THEN I7! = P%(I, P1%(I),43+BY%*7) / (P%(I, P1%(I),37+BY%*7) - P%(I, P1%(I),38+BY%*7)): GOTO 282
    IF B7%(I, I3) = 1 THEN I7! = p%(I, P1%(I), 28) / (p%(I, P1%(I), 20) - p%(I, P1%(I), 22)): GOTO 282
     IF b%(I, B3%(I, I3), 4) = 0 OR b%(I, B3%(I, I3), 4) - b%(I, B3%(I, I3), 6) = 0 THEN I7! = 0: GOTO 282
    IF TS%(I,0)=999 AND B%(I, B3%(I ,I3), 80) <>0 AND b%(I, B3%(I, I3), 42+BY%*7) - b%(I, B3%(I, I3), 43+BY%*7) = 0 THEN I7! = 0: GOTO 282
    IF TS%(I,0)=999 AND B%(I, B3%(I ,I3), 80) <>0 THEN I7! = b%(I, B3%(I, I3), 48+BY%*7) / (b%(I, B3%(I, I3), 42+BY%*7) - b%(I, B3%(I, I3), 43+BY%*7)):GOTO 282
    I7! = b%(I, B3%(I, I3), 12) / (b%(I, B3%(I, I3), 4) - b%(I, B3%(I, I3), 6))

282 'IF I7!>=1 THEN I7%=.8
    CALL NORMALIZE (I7!, I2!, I6!, K8!)
    B4%(I, 4, I3) = K8!
    NEXT I3

' CALCULATE THE BATTING AVERAGE
     FOR I3 = VV(I) TO VV1(I)
    I2! = l%(I1, 1) / 1000
    I6! = p%(I1, P1%(I1), 14) / 1000
    IF p%(I1, P1%(I1), 6) + p%(I1, P1%(I1), 7)=0 THEN I7!=0:GOTO 283
    I7! = p%(I1, P1%(I1), 7) / (((p%(I1, P1%(I1), 6) * 3) * .94) + p%(I1, P1%(I1), 7))

283 CALL NORMALIZE (I7!, I2!, I6!, K8!)
    i9! = K8! / 1000
    GOSUB 500
     IF TS%(I1,0) = 999 AND P%(I1, P1%(I1), 89)<>0 THEN I6! = P%(I1, P1%(I1), TY%*6 + 65) / 1000
    IF TS%(I1,0) = 999 AND P%(I1, P1%(I1), 89)<>0 AND P%(I1, P1%(I1),51+PY%*7)=0 THEN I7! = 0:GOTO 225
    IF TS%(I1,0) = 999 AND P%(I1, P1%(I1), 89)<>0 THEN I7! = P%(I1, P1%(I1),52+PY%*7) / P%(I1, P1%(I1),51+PY%*7)

225 IF TS%(I1,0) = 999 AND P%(I1, P1%(I1), 89)<>0 THEN I2! = SA%(I1,TY%*6+ 1) / 1000
    IF TS%(I1,0) = 999 AND P%(I1, P1%(I1), 89)<>0 THEN CALL NORMALIZE (I7!, I2!, I6!, K8!)
    IF TS%(I1,0) = 999 AND P%(I1, P1%(I1), 89)<>0 THEN i9! = K8! / 1000
     IF B7%(I, I3) = 1 AND p%(I, P1%(I), 11) <> 999 THEN I7! = p%(I, P1%(I), 11) / 1000: I6! = p%(I, P1%(I), 14) / 1000: GOTO 228
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 20) = 0 THEN I7! = 0:GOTO 227
    IF B7%(I, I3) = 1 AND TS%(I,0) = 999 AND P%(I, P1%(I),37+BY%*7) = 0 THEN I7! = 0:GOTO 227
    IF B7%(I, I3) = 1 AND TS%(I,0) = 999 THEN I7! = P%(I, P1%(I),38+BY%*7) / P%(I, P1%(I),37+BY%*7):GOTO 227
    IF B7%(I, I3) = 1 THEN I7! = p%(I, P1%(I), 22) / p%(I, P1%(I), 20)

227 IF B7%(I, I3) = 1 AND TS%(I,0) = 999 THEN I6! = P%(I, P1%(I), TY%*6 + 65) / 1000:GOTO 228
    IF B7%(I, I3) = 1 THEN I6! = p%(I, P1%(I), 14) / 1000: GOTO 228
     IF b%(I, B3%(I, I3), 4) = 0 THEN I7! = 0: GOTO 230
    IF TS%(I,0) = 999 AND B%(I, B3%(I ,I3), 80)<>0 AND b%(I, B3%(I, I3), 42+BY%*7) = 0 THEN I7! = 0:GOTO 230
    IF TS%(I,0) = 999 AND B%(I, B3%(I ,I3), 80) <>0 THEN I7! = b%(I, B3%(I, I3), 43+BY%*7) / b%(I, B3%(I, I3), 42+BY%*7):GOTO 230
    I7! = b%(I, B3%(I, I3), 6) / b%(I, B3%(I, I3), 4)

230 I6! = b%(I, B3%(I, I3), 20) / 1000
    IF TS%(I,0) = 999 AND B%(I, B3%(I ,I3), 80) <>0 THEN I6! = b%(I, B3%(I, I3), 56+TY%*6) / 1000

228 I2! = l%(I, 1) / 1000
    IF TS%(I,0) = 999 AND B%(I, B3%(I ,I3), 80) <>0 THEN I2! = SA%(I,TY%*6+ 1) / 1000
    CALL NORMALIZE (I7!, I2!, I6!, K8!)
    I7! = K8! / 1000
    I6! = l%(I, 1) / 1000
    IF TS%(I,0) = 999 AND B%(I, B3%(I ,I3), 80) <>0 THEN I6! = SA%(I,TY%*6+ 1) / 1000
    I2! = i9!
    CALL NORMALIZE (I7!, I2!, I6!, K8!)
    B4%(I, 0, I3) = K8!
'------------------------------
'    PRINT B$(I, B3%(I, I3)),B4%(I, 0, I3)
    NEXT I3
'222 I$=GetKeyPress$
' CALCULATE THE EXTRA BASE HITS RATIOS
     FOR I3 = VV(I) TO VV1(I)
    GOSUB 500
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 11) <> 999 THEN B4%(I, 1, I3) = (130 * (i9! * 1000)) / l%(I1, 1): B4%(I, 2, I3) = (19 * (i9! * 1000)) / l%(I1, 1): B4%(I, 3, I3) = 37: GOTO 235
    E2! = (i9! * 1000) / l%(I1, 1)
    IF TS%(I1,0) =999 THEN E2! = (I9! * 1000) / SA%(I1,TY%*6+ 1)
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 22) = 0 THEN B4%(I, 1, I3) = 0: B4%(I, 2, I3) = 0: B4%(I, 3, I3) = 0: GOTO 235
    IF B7%(I, I3) <> 1 AND b%(I, B3%(I, I3), 6) =0 THEN B4%(I, 1, I3) = 0: B4%(I, 2, I3) = 0: B4%(I, 3, I3) = 0: GOTO 235
    IF B7%(I, I3) = 1 AND TS%(I,0) = 999 AND P%(I, P1%(I),38+BY%*7) = 0 THEN B4%(I, 1, I3) = 0: B4%(I, 2, I3) = 0: B4%(I, 3, I3) = 0: GOTO 235
     IF B7%(I, I3) = 1 AND TS%(I,0) = 999 THEN B4%(I, 1, I3) = INT((P%(I, P1%(I),39+BY%*7) / P%(I, P1%(I),38+BY%*7)) * 1000) * E2!:' doubles times  * .95
    IF B7%(I, I3) = 1 AND TS%(I,0) = 999 THEN B4%(I, 2, I3) = INT((P%(I, P1%(I),40+BY%*7) / P%(I, P1%(I),38+BY%*7)) * 1000) * E2!
    IF B7%(I, I3) = 1 AND TS%(I,0) = 999 THEN B4%(I, 3, I3) = INT((P%(I, P1%(I),41+BY%*7) / P%(I, P1%(I),38+BY%*7)) * 1000): GOTO 235
     IF B7%(I, I3) = 1 THEN B4%(I, 1, I3) = INT((p%(I, P1%(I), 23) / p%(I, P1%(I), 22)) * 1000) * E2!:' doubles times  * .95
    IF B7%(I, I3) = 1 THEN B4%(I, 2, I3) = INT((p%(I, P1%(I), 24) / p%(I, P1%(I), 22)) * 1000) * E2!
    IF B7%(I, I3) = 1 THEN B4%(I, 3, I3) = INT((p%(I, P1%(I), 25) / p%(I, P1%(I), 22)) * 1000): GOTO 235
     IF b%(I, B3%(I, I3), 6) = 0 THEN B4%(I, 1, I3) = 0: B4%(I, 2, I3) = 0: B4%(I, 3, I3) = 0: GOTO 235
    IF TS%(I,0) = 999 AND B%(I, B3%(I ,I3), 80) <>0 AND b%(I, B3%(I, I3), 43+BY%*7) = 0 THEN B4%(I, 1, I3) = 0: B4%(I, 2, I3) = 0: B4%(I, 3, I3) = 0: GOTO 235
     IF TS%(I,0) = 999 AND B%(I, B3%(I ,I3), 80) <>0 THEN B4%(I, 1, I3) = INT((b%(I, B3%(I, I3), 44+BY%*7) / b%(I, B3%(I, I3), 43+BY%*7)) * 1000) * E2!:'see note on pitchers * .95
    IF TS%(I,0) = 999 AND B%(I, B3%(I ,I3), 80) <>0 THEN B4%(I, 2, I3) = INT((b%(I, B3%(I, I3), 45+BY%*7) / b%(I, B3%(I, I3), 43+BY%*7)) * 1000) * E2!
    IF TS%(I,0) = 999 AND B%(I, B3%(I ,I3), 80) <>0 THEN B4%(I, 3, I3) = INT((b%(I, B3%(I, I3), 46+BY%*7) / b%(I, B3%(I, I3), 43+BY%*7)) * 1000):GOTO 235
     B4%(I, 1, I3) = INT((b%(I, B3%(I, I3), 7) / b%(I, B3%(I, I3), 6)) * 1000) * E2!:'see note on pitchers * .95
    B4%(I, 2, I3) = INT((b%(I, B3%(I, I3), 8) / b%(I, B3%(I, I3), 6)) * 1000) * E2!
    B4%(I, 3, I3) = INT((b%(I, B3%(I, I3), 9) / b%(I, B3%(I, I3), 6)) * 1000)

235 I6! = l%(I1, 4) / 1000
    I7! = B4%(I, 3, I3) / 1000
    I2! = 0
    IF p%(I1, P1%(I1), 7)<>0 THEN I2! = p%(I1, P1%(I1), 13) / p%(I1, P1%(I1), 7)
    IF TS%(I1,0) = 999 AND P%(I1, P1%(I1), 89)<>0 THEN I6! = SA%(I1,TY%*6+ 4) / 1000
    IF TS%(I1,0) = 999 AND P%(I1, P1%(I1), 89)<>0 AND P%(I1, P1%(I1),52+PY%*7)<>0 THEN I2! = P%(I1, P1%(I1),55+PY%*7) / P%(I1, P1%(I1),52+PY%*7)
    CALL NORMALIZE (I7!, I2!, I6!, K8!)
    B4%(I, 3, I3) = K8!
    NEXT I3
' ADJUST LEFTY/RIGHTY THE OLD WAY
     I4 = p%(I1, P1%(I1), 0)
    FOR I3 = VV(I) TO VV1(I)
    IF TS%(I,0)=999 AND B%(I, B3%(I ,I3), 80) <>0 THEN 236
    I2 = b%(I, B3%(I, I3), 0)
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 0) = -1 AND p%(I1, P1%(I1), 0) = 1 THEN A = 1.04: A1 = .88: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 0) = -1 AND p%(I1, P1%(I1), 0) = -1 THEN A = .93: A1 = 1.16: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 0) = 1 AND p%(I1, P1%(I1), 0) = -1 THEN A = 1.02: A1 = .98: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 0) = 1 AND p%(I1, P1%(I1), 0) = 1 THEN A = .97: A1 = 1.1: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) <> 1 AND I2 = -2 AND I4 = 1 THEN A = 1.04: A1 = .96: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) <> 1 AND I2 = -2 AND I4 = -1 THEN A = .78: A1 = 1.22: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) <> 1 AND I2 = 2 AND I4 = 1 THEN A = .78: A1 = 1.22: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) <> 1 AND I2 = 2 AND I4 = -1 THEN A = 1.04: A1 = .96: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) <> 1 AND I2 = -1 AND I4 = -1 THEN A = .93: A1 = 1.16: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) <> 1 AND I2 = -1 AND I4 = 1 THEN A = 1.04: A1 = .88: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) <> 1 AND I2 = 1 AND I4 = 1 THEN A = .97: A1 = 1.1: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) <> 1 AND I2 = 1 AND I4 = -1 THEN A = 1.02: A1 = .98: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) <> 1 AND I2 = 0 AND I4 = -1 THEN A = 1.01: A1 = .86: CALL LRADJ (A!, A1!)
    IF B7%(I, I3) <> 1 AND I2 = 0 AND I4 = 1 THEN A = .99: A1 = .93: CALL LRADJ (A!, A1!)

236 B4%(I, 6, I3) = B4%(I, 3, I3): B4%(I, 7, I3) = B4%(I, 3, I3)
    NEXT I3

' ADJUST AVERAGES FOR THE HOME TEAM
     FOR I3 = VV(I) TO VV1(I)
    IF I = 1 THEN B4%(I, 0, I3) = B4%(I, 0, I3) + 5
    IF I <> 1 THEN B4%(I, 0, I3) = B4%(I, 0, I3) - 5
    NEXT I3

' CALCULATE THE HOME PARK FACTORS
     IF N = 2 THEN 273
    FOR I2 = VV(I) TO VV1(I)
    IF I = 1 THEN B4%(I, 1, I2) = INT(B4%(I, 1, I2) * (l%(I, 6) / 100) + .5): B4%(I, 2, I2) = INT(B4%(I, 2, I2) * (l%(I, 7) / 100) + .5)
    IF I <> 1 THEN B4%(I, 1, I2) = INT(B4%(I, 1, I2) * (l%(I1, 6) / 100) * ((200 - l%(I, 6)) / 100) + .5): B4%(I, 2, I2) = INT(B4%(I, 2, I2) * (l%(I1, 7) / 100) * ((200 - l%(I, 7)) / 100) + .5)
    IF K9(I) > 1000 THEN I3! = 100: I6! = INT(K9(I) / 1000) * WF!: I7! = (K9(I) - INT((K9(I) / 1000)) * 1000) * WF!
    IF K9(I1) > 1000 THEN I4! = 100: K8! = INT(K9(I1) / 1000) * WF!: i9! = (K9(I1) - INT((K9(I1) / 1000)) * 1000) * WF!
    IF K9(I) < 1000 THEN I3! = K9(I) * WF!: I6! = I3!: I7! = I3!
    IF K9(I1) < 1000 THEN I4! = K9(I1) * WF!: K8! = I4!: i9! = I4!
    IF I = 1 THEN B4%(I, 3, I2) = INT((B4%(I, 3, I2) * (I3! / 100)) + .5): B4%(I, 6, I2) = INT((B4%(I, 6, I2) * (I6! / 100)) + .5): B4%(I, 7, I2) = INT((B4%(I, 7, I2) * (I7! / 100)) + .5)
    IF I<>1 THEN B4%(I, 3, I2)=INT((B4%(I, 3, I2)*(I4! / 100) * ((200 - I3!) / 100)) + .5): B4%(I, 6, I2) = INT((B4%(I, 6, I2) * (K8! / 100) * ((200 - I6!) / 100)) + .5): B4%(I, 7, I2) = INT((B4%(I, 7, I2) * (i9! / 100) * ((200-I7!)/100))+ .5)
    NEXT I2
    NEXT I
    GOTO 273

500 II = b%(I, B3%(I, I3), 0)
    I4 = p%(I1, P1%(I1), 0)
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 0) = -1 AND I4 = 1 THEN TY%=1
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 0) = -1 AND I4 = -1 THEN TY%=0
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 0) = 1 AND I4 = -1 THEN TY%=2
    IF B7%(I, I3) = 1 AND p%(I, P1%(I), 0) = 1 AND I4 = 1 THEN TY%=3
    IF B7%(I, I3) <>1 AND II<0 AND I4=1 THEN TY%=1
    IF B7%(I, I3) <>1 AND II<0 AND I4=-1 THEN TY%=0
    IF B7%(I, I3) <>1 AND II>0 AND I4=-1 THEN TY%=2
    IF B7%(I, I3) <>1 AND II>0 AND I4=1 THEN TY%=3
    IF B7%(I, I3) <>1 AND II=0 AND I4=1 THEN TY%=1
    IF B7%(I, I3) <>1 AND II=0 AND I4=-1 THEN TY%=2
    IF TY%=0 OR TY%=1 THEN PY%=0
    IF TY%=2 OR TY%=3 THEN PY%=1
    IF TY%=0 OR TY%=2 THEN BY%=0
    IF TY%=1 OR TY%=3 THEN BY%=1
    RETURN

273 '
END SUB


'------------------------------
'   LRADJ Subroutine
'------------------------------
' ...explanation...
SUB LRADJ (A!, A1!)
    FOR I6 = 0 TO 3
    B4%(I, I6, I3) = B4%(I, I6, I3) * A!
    NEXT I6
    B4%(I, 5, I3) = B4%(I, 5, I3) * A!: ' NEWLY ADDED
    B4%(I, 4, I3) = B4%(I, 4, I3) * A1!
END SUB


'------------------------------
'   NORMALIZE Subroutine
'------------------------------
' ...explanation...
SUB NORMALIZE (I7!, I2!, I6!, K8!)
     I0! = (I7! * I2! * (1 - I6!))
    IF (I0! + ((1 - I7!) * (1 - I2!) * I6!))=0 THEN K8!=0:GOTO 15
    K8! = I0! / (I0! + ((1 - I7!) * (1 - I2!) * I6!))

15  K8! = INT((K8! * 1000) + .0005)

END SUB


'------------------------------
'   BASEONBALLS Subroutine
'------------------------------
' ...explanation...
SUB BASEONBALLS (S2%,D2,D,P)
    S2% = 2
    CALL BLANKLINES
	bv = INT(RND(1) * 100) + 1: CALL RANDNUM (RN)
    IF D2 = 2 AND bv <= 50 THEN PRINT Q$(0); " is walked intentionally..."
    IF D2 = 2 AND bv > 50 THEN PRINT Q$(0); " is given a purpose pass..."
    IF D2 = 2 THEN S8%(D, 0) = S8%(D, 0) + 1: CALL DELAY: GOTO 3241
    IF RN <= 30 THEN PRINT "Full count...": CALL DELAY
    CALL DELIVERY (D)
      Y% = INT(RND(1) * 80) + 780
    CALL GETRPBP (Y%,Y$,D): CALL STRIPRPBP (Y$,Y%,D)
    PRINT Y$
    CALL DELAY
        Y% = INT(RND(1) * 30) + 860
    CALL GETRPBP (Y%,Y$,D): CALL STRIPRPBP (Y$,Y%,D)
    PRINT Y$
    call delay

3241 call randnum(rn)
    if s4% = 7 and  rn<=30 then PRINT "that forces a run in":call delay
    rn=int(rnd(1)*4)+1
    if s4%>3 and s4%<7 and rn=1 then print "and the bases are loaded!":call delay
    if s4%>3 and s4%<7 and rn=2 then print "and the sacks are jammed!":call delay
    if s4%>3 and s4%<7 and rn=3 then print "and the bases are full!":call delay
    if s4%>3 and s4%<7 and rn=4 then print "and that loads them up!":call delay
      I5 = P1%(D): I6 = 4: CALL ADDPIT (D,I5,I6)
    IF B7%(P, B1!(P)) = 1 THEN I5 = P1%(P): I6 = 30: CALL INCPITOFF (P,I5,I6): GOTO 3243
    I5 = B3%(P, B1!(P)): I6 = 7: CALL INCBATOFF (P,I5,I6)

3243 '
END SUB


'------------------------------
'   HITBYPITCH Subroutine
'------------------------------
' ...explanation...
SUB HITBYPITCH (S2%,D)
    S2% = 1
    CALL BLANKLINES
    CALL DELIVERY (D)
    y% = INT(RND(1) * 20) + 720
    CALL GETRPBP(Y%, Y$, D): CALL STRIPRPBP (Y$,Y%,D)
    PRINT Y$
    CALL DELAY
    y% = INT(RND(1) * 11) + 740
    CALL GETRPBP(Y%, Y$, D): CALL STRIPRPBP (Y$,Y%,D)
    PRINT Y$
    CALL DELAY
    y% = INT(RND(1) * 20) + 760
    CALL GETRPBP(Y%, Y$, D): CALL STRIPRPBP (Y$,Y%,D)
    PRINT Y$
    CALL DELAY
    call randnum(rn)
    if rn<=50 and s4% = 7 then print "tough way to get an RBI":call delay
END SUB


'------------------------------
'   WILDPITCH Subroutine
'------------------------------
' ...explanation...
SUB WILDPITCH (S2%,D)
    S2% = 6
    CALL RANDNUM (RN)
    IF RN <= 16 THEN PRINT "and it gets away from "; B$(D, B9%(D, 2))
    IF RN > 16 AND RN <= 32 THEN PRINT "pitch is WAY high, and "; B$(D, B9%(D, 2)); " can't get it"
    IF RN > 32 AND RN <= 48 THEN PRINT "It's in the dirt": CALL DELAY: PRINT "The runners move up 90 ft."
    IF RN > 48 AND RN <= 64 THEN PRINT "It bounces in front of the plate": CALL DELAY: PRINT "it's past the catcher": CALL DELAY: PRINT "the runners advance"
    IF RN > 64 AND RN <= 80 THEN PRINT "it's over "; B$(D, B9%(D, 2)); "'s head"
    IF RN > 67 THEN PRINT "wild pitch by "; P$(D, P1%(D)): CALL DELAY: GOTO 3235
    CALL RANDNUM (RN)
    CALL DELAY
    IF RN <= 33 THEN PRINT "It's ruled a wild pitch"
    IF RN > 33 AND RN <= 66 THEN PRINT "score it a wild pitch"
    IF RN > 66 THEN PRINT "credit "; P$(D, P1%(D)); " with a wild pitch"
    CALL DELAY

3235 '
END SUB


'------------------------------
'   RELIEVERS Subroutine
'------------------------------
' ...explanation...
SUB RELIEVERS
    CALL PITSTRAT
    if pz=1 then pz=0:goto 8885
    I2 = 0
    A1 = S6%(D, 0) - S6%(p, 0)
    FOR I = 0 TO 21
    A2 = p%(D, i, 4) - p%(D, i, 5) - p%(d, i, 3)*1.3
    IF p%(D, i, 15) > 0 OR P$(D, i) = "XXX" OR A2=0 THEN 8874
    IF INNING% <= 7 AND A2 > 0 THEN I2 = I2 + A2
    IF INNING% > 7 AND A1 < 0 AND A2 > 0 THEN I2 = I2 + A2
    IF INNING% > 7 AND A1 >= 0 THEN I2 = I2 + p%(D, i, 3)

8874 NEXT i
    I3 = INT(RND(1) * I2) + 1
    I2 = 0
    FOR i = 0 TO 21
    A2 = p%(D, i, 4) - p%(D, i, 5) - p%(d, i, 3)*1.3
    IF p%(D, i, 15) > 0 OR p$(D, i) = "XXX" OR A2 = 0 THEN 8883
    IF INNING% <= 7 AND A2 > 0 AND I3 <= I2 + A2 THEN CALL NEWPITCHER: GOTO 8885
    IF INNING% <= 7 AND A2 > 0 THEN I2 = I2 + A2: GOTO 8883
      IF INNING% > 7 AND A1 < 0 AND A2 > 0 AND I3 <= I2 + A2 THEN CALL NEWPITCHER: GOTO 8885
    IF INNING% > 7 AND A1 < 0 AND A2 > 0 THEN I2 = I2 + A2: GOTO 8883
    IF INNING% > 7 AND A1 >= 0 AND I3 > I2 AND I3 <= I2 + p%(D, i, 3) THEN CALL NEWPITCHER: GOTO 8885
    IF INNING% > 7 AND A1 >= 0 THEN I2 = I2 + p%(D, i, 3)

8883 NEXT i
    FOR i = 0 TO 21
    IF p%(D, i, 15) = 0 AND p$(D, i) <> "XXX" THEN CALL NEWPITCHER: GOTO 8885
    NEXT i

8885 '
END SUB


'------------------------------
'   REPLACEMENTS Subroutine
'------------------------------
' ...explanation...
SUB REPLACEMENTS (I7%, I8%, i9%)
    ' REPLACEMENT AVERAGE CALCS, I7%,I8%,I9%
    FOR xx = 22 TO 25
    IF B7%(I7%, I8%) = b%(I7%, i9%, xx) THEN b%(I7%, i9%, 15) = b%(I7%, i9%, 33 + (xx - 22) * 2): b%(I7%, i9%, 17) = b%(I7%, i9%, 34 + (xx - 22) * 2): b%(I7%, i9%, 19) = b%(I7%, i9%, xx + 4): GOTO 7110
    NEXT
    J1 = B7%(I7%, I8%)
    IF J1 = 2 THEN J2 = 1: J3 = 0: J4 = 910 + INT(RND(1) * 10) + 1
    IF J1 = 3 THEN J2 = 0: J3 = 3: J4 = 960 + INT(RND(1) * 10) + 1
    IF J1 = 4 THEN J2 = 0: J3 = 3: J4 = 912 + INT(RND(1) * 10) + 1
    IF J1 = 5 OR J1 = 6 THEN J2 = 0: J3 = 3: J4 = 902 + INT(RND(1) * 10) + 1
    IF J1 >= 7 THEN J2 = 2: J3 = 2: J4 = 972 + INT(RND(1) * 10) + 1
    b%(I7%, i9%, 15) = J2
    b%(I7%, i9%, 17) = J3
    b%(I7%, i9%, 19) = J4

7110 '
END SUB


'------------------------------
'   SCOREBOARD Subroutine
'------------------------------
' ...explanation...
SUB SCOREBOARD ()
    '***INCREMENT THE HIT TOTAL ON THE SCOREBOARD***
    COLOR 14, 0: S6%(p, 1) = S6%(p, 1) + 1
    LOCATE p + 2, 43: PRINT USING "##"; S6%(p, 1);
    COLOR 15, 0
END SUB


'------------------------------
'   SECOND2FIRST Subroutine
'------------------------------
' ...explanation...
SUB SECOND2FIRST (D)
    '*** throw to 1st from 2nd ***
    Y% = INT(RND(1) * 30) + 1540
    CALL GETRPBP(Y%, Y$, D): CALL STRIPRPBP(Y$, Y%, D)
    PRINT Y$; " to first"
    CALL DELAY
END SUB


'------------------------------
'   SINGLEPBP Subroutine
'------------------------------
' ...explanation...
SUB SINGLEPBP (S2%, D, W%)
    '*** play by play for a single s2%=7, s2%=12 ***
    if s2% = -12 then s2% = 12:goto 8014
    CALL DELIVERY(D)
    CALL RANDNUM(rn)
    IF S2% = 12 THEN PRINT Q$(0); " beats out an infield single": GOTO 8013
    IF rn <= 50 THEN Y% = INT(RND(1) * 50) + 1610: CALL GETRPBP(Y%, Y$, D): CALL STRIPRPBP(Y$, Y%, D): PRINT Y$; " "; C$(W%): GOTO 8013
    IF W% = 7 THEN Y% = INT(RND(1) * 70) + 1660
    IF W% = 9 THEN Y% = INT(RND(1) * 70) + 1730
    IF W% = 8 THEN Y% = INT(RND(1) * 90) + 1800
    CALL GETRPBP(Y%, Y$, D): CALL STRIPRPBP(Y$, Y%, D)
    PRINT Y$

8013 CALL DELAY:CALL DELAY

8014 END SUB


'------------------------------
'   SINGLEROUTINE Subroutine
'------------------------------
' ...explanation...
SUB SINGLEROUTINE (W%, p, I1, D, S2%, P2)
    CALL GETOUTFIELDER (W%, p, I1, D)
    CALL BLANKLINES
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF(P, I5, I6): I6 = 1: CALL INCBATOFF(P, I5, I6)
    I5 = P1%(D): I6 = 1: CALL ADDPIT(D, I5, I6)
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF(P, I5, I6): I6 = 24: CALL INCPITOFF(P, I5, I6)
    if h7% > sn then CALL SINGLEPBP(S2%, D, W%)
    FOR I = 0 TO 3
    A5%(I) = 1
    NEXT I
    IF S2% = 12 OR B0%(2, 0) = 0 THEN 3075
    H6% = INT(RND(1) * 100) + 1
    IF B7%(p, B0%(2, 0)) <> 1 THEN BR% = b%(p, B3%(p, B0%(2, 0)), 16)
    IF B7%(p, B0%(2, 0)) = 1 THEN BR% = p%(p, P1%(p), 31)
    IF O%(0) = 0 AND W% = 7 THEN I3= 16 + BR% * 3
    IF O%(0) = 1 AND W% = 7 THEN I3= 36 + BR% * 3
    IF O%(0) = 2 AND W% = 7 THEN I3= 79 + BR% * 3
    IF O%(0) = 0 AND W% = 8 THEN I3= 49 + BR% * 3
    IF O%(0) = 1 AND W% = 8 THEN I3= 61 + BR% * 3
    IF O%(0) = 2 AND W% = 8 THEN I3= 82 + BR% * 3
    IF O%(0) = 0 AND W% = 9 THEN I3= 27 + BR% * 3
    IF O%(0) = 1 AND W% = 9 THEN I3= 44 + BR% * 3
    IF O%(0) = 2 AND W% = 9 THEN I3= 79 + BR% * 3
    IF H6% <= I3 OR P2 = 2 AND S2% <> 12 THEN A5%(2) = 2

3075 IF B0%(1, 0) = 0 OR S2% = 12 OR B0%(2, 0) > 0 AND A5%(2) = 1 THEN 3092
    H6% = INT(RND(1) * 100) + 1
    BR% = b%(p, B3%(p, B0%(1, 0)), 16)
    IF B7%(p, B0%(1, 0)) = 1 THEN BR% = p%(p, P1%(p), 31)
    I3 = 0
    IF O%(0) = 0 AND W% = 7 THEN I3=  6 + BR% * 3
    IF O%(0) = 1 AND W% = 7 THEN I3= 10 + BR% * 3
    IF O%(0) = 2 AND W% = 7 THEN I3= 11 + BR% * 3
    IF O%(0) = 0 AND W% = 8 THEN I3= 25 + BR% * 3
    IF O%(0) = 1 AND W% = 8 THEN I3= 26 + BR% * 3
    IF O%(0) = 2 AND W% = 8 THEN I3= 45 + BR% * 3
    IF O%(0) = 0 AND W% = 9 THEN I3= 38 + BR% * 3
    IF O%(0) = 1 AND W% = 9 THEN I3= 40 + BR% * 3
    IF O%(0) = 2 AND W% = 9 THEN I3= 62 + BR% * 3
    IF H6% <= I3 OR P2 = 2 AND S2% <> 12 THEN A5%(1) = 2

3092 CALL ADVANCEMENT(p, D, S2%, F%,I3)
END SUB


'------------------------------
'   SOMESTATS Subroutine
'------------------------------
' ...explanation...
SUB SOMESTATS (V, p, F%, D)
    IF B0%(V, 0) > 0 AND B7%(p, B0%(V, 0)) = 1 AND F% = 0 THEN I5 = P1%(p): I6 = 32: CALL INCPITOFF(P, I5, I6)
    IF B0%(V, 0) > 0 AND B7%(p, B0%(V, 0)) <> 1 AND F% = 0 THEN I5 = B3%(p, B0%(V, 0)): I6 = 9: CALL INCBATOFF(P, I5, I6)
END SUB


'------------------------------
'   SQUEEZECHOICE Subroutine
'------------------------------
' ...explanation...
SUB SQUEEZECHOICE (SH)
    '*** SQUEEZE ***
    IF u6 = 2 OR u6 = 1 AND p = u9 THEN SH = 2: GOTO 4242
    LOCATE 15, 1: PRINT "1 - SQUEEZE PLAY": PRINT "2 - BUNT FOR SACRIFICE/HIT"
4241 i$ = GetKeyPress$
    SH = VAL(i$): IF SH < 1 OR SH > 2 THEN 4241

4242 '
END SUB


'------------------------------
'   STEAL3RD Subroutine
'------------------------------
' ...explanation...
SUB STEAL3RD (TGTBASE%, AA, Q0, H0%, D)
    IF TGTBASE% = 3 AND AA >= 24 THEN Q0 = 830: ' *** SUCCESS OF 3B STEAL ***
    IF TGTBASE% = 3 AND AA < 24 THEN Q0 = 700
    IF TGTBASE% = 4 THEN Q0 = Q0 * .5
    ' *** H0%=0, runner not held ***
    IF H0% = 0 THEN Q0 = Q0 + 50: GOTO 4874
    IF H0% = 1 THEN Q0 = Q0 - ((p%(D, P1%(D), 18) - 5) * 25):' - 50

4874 REM
END SUB


'------------------------------
'   STEALCHANCE Subroutine
'------------------------------
' ...explanation...
SUB STEALCHANCE (AA, I2, TGTBASE%,CHANCE%)
DIM DD AS SINGLE
DIM TT AS SINGLE
DIM RR AS SINGLE
DIM SS AS SINGLE
DIM GG AS SINGLE
DIM I1 AS SINGLE
    AA = b%(p, I2, 13)
    BB = b%(p, I2, 13) + b%(p, I2, 14)
    CC = b%(p, I2, 7): ' *** CHANCE TO STEAL 2B & 3B ***
    IF AA <= 43 THEN DD = .16: GOTO 4853
    IF AA <= 60 THEN DD = .21: GOTO 4853
    DD = .3

4853 TT = CC + BB - (BB * DD): ' *** TOTAL CHANCES TO STEAL 3RD ***
    RR = (TT * .19) * 1.4: ' *** "      "      "   "     "  1 OUT ***
    SS = (TT * .56) * 1.4: ' ***                            0 OUT ***
    GG = RR + SS:    ' ***                            (0,1 OUT) ***
    IF TGTBASE% = 3 THEN 4862
    FF = b%(p, I2, 6) + b%(p, I2, 11) - b%(p, I2, 9)
    IF FF=0 THEN I1=0:GOTO 4868
    IF AA >= 12 THEN I1 = INT(((BB - BB * DD) / FF) * 1500)
    IF AA < 12 THEN I1 = INT((BB / FF) * 1500)
    IF I1 < 0 THEN I1 = 0
    GOTO 4868

4862 IF BB < 10 AND O%(0) = 0 THEN I1 = 0
    IF BB < 10 AND O%(0) = 1 THEN I1 = 10
    IF O%(0) = 2 OR TT=0 THEN I1 = 0
    IF BB >= 10 AND O%(0) = 1 THEN I1 = BB * DD / TT * 1000
    IF BB >= 10 AND O%(0) = 0 THEN I1 = BB * DD / TT * 1000
    IF I1 < 0 THEN I1 = 0

4868 CHANCE%=I1
    '
END SUB


'------------------------------
'   STRIKEOUT Subroutine
'------------------------------
' ...explanation...
SUB STRIKEOUT (U%, D)
    '*** strikeout pbp ***
    IF U% = 3 THEN BV = 20: GOTO 3770
    BV = INT(RND(1) * 100): CALL RANDNUM(rn)
    IF rn <= 20 THEN PRINT "FULL COUNT...": CALL DELAY
    CALL DELIVERY(D)
    IF BV = 1 THEN PRINT "Strike Three!!": PRINT Q$(0); " turns to "; U$(1): CALL DELAY: PRINT "he says he tees them up higher than that": PRINT "at the country club!!": CALL DELAY: GOTO 3774
    IF BV = 2 THEN PRINT "Strike three...": CALL DELAY: PRINT Q$(0); " stands there like a house": PRINT "by the side of the road": CALL DELAY: CALL DELAY: GOTO 3774
    IF BV > 2 AND BV <= 5 THEN PRINT Q$(0); " looks at a called strike three": CALL DELAY: PRINT "and turns to glare at "; U$(1): CALL DELAY: PRINT M$(p); " is barking from the dugout!!": GOTO 3774
      CALL RANDNUM(RN)
    IF RN<=25 THEN
        Y% = INT(RND(1) * 40) + 890
    ELSE
        Y% = INT(RND(1) * 80) + 930
    END IF
    CALL GETRPBP(Y%, Y$, D): CALL STRIPRPBP(Y$, Y%, D)
    PRINT Y$: CALL DELAY

3770 Y% = INT(RND(1) * 40) + 1010
    CALL GETRPBP(Y%, Y$, D): CALL STRIPRPBP(Y$, Y%, D)
    PRINT Y$

3774 CALL DELAY
    CALL RANDNUM(rn)
    IF rn <= 20 THEN PRINT "Number"; P8%(D, P1%(D), 5) + 1; "for "; p$(D, P1%(D))
    IF rn > 20 AND rn <= 40 THEN PRINT "That's"; P8%(D, P1%(D), 5) + 1; "for "; p$(D, P1%(D))
    IF RN = 41 THEN PRINT Q$(0)+" is not a happy man"
    IF RN = 42 THEN PRINT Q$(0)+" has had better AB's"
    CALL DELAY
END SUB


'------------------------------
'   STRIKEOUTCS Subroutine
'------------------------------
' ...explanation...
SUB STRIKEOUTCS (SO)
    IF SO = 7 THEN B1!(p) = B1!(p) + 1
END SUB


'------------------------------
'   STRIPRPBP Subroutine
'------------------------------
' ...explanation...
SUB STRIPRPBP (Y$, Y%, D)

3991 FOR BH% = 1 TO LEN(Y$)
    IF ASC(MID$(Y$, BH%, 1)) > 122 OR ASC(MID$(Y$, BH%, 1)) < 32 THEN CALL GETRPBP(Y%, Y$, D): GOTO 3991
    NEXT
END SUB


'------------------------------
'   TAGADVANCE Subroutine
'------------------------------
' ...explanation...
SUB TAGADVANCE (S2%, I8, D)
    IF S2% = 7 AND I8 = 2 AND B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 27: CALL INCPITOFF(P, I5, I6): GOTO 3394
    IF S2% = 7 AND I8 = 2 AND B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 4: CALL INCBATOFF(P, I5, I6): GOTO 3394
    IF S2% = 8 AND I8 = 3 AND B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 28: CALL INCPITOFF(P, I5, I6): P8%(p, P1%(p), 27) = P8%(p, P1%(p), 27) - 1: P5%(p, P1%(p), 27) = P5%(p, P1%(p), 27) - 1: GOTO 3394
    IF S2% = 8 AND I8 = 3 AND B7%(p, B1!(p)) <> 1 THEN I3 = 4: I4 = 5: I5 = B3%(p, B1!(p))
    IF S2% = 9 AND I8 = 4 THEN I3 = 5: I4 = 6: I5 = B3%(p, B1!(p))
    IF S2% = 8 AND I8 = 3 OR S2% = 9 AND I8 = 4 THEN 3393
    GOTO 3394

3393 IF P%(D,P1%(D),0) = 1 THEN 3392
    CSS%(P, I5, I3 - 2) = CSS%(P, I5, I3 - 2) - 1
    CSS%(P, I5, I4 - 2) = CSS%(P, I5, I4 - 2) + 1

3392 B8%(p, I5, I3) = B8%(p, I5, I3) - 1
    B5%(p, I5, I3) = B5%(p, I5, I3) - 1
    B8%(p, I5, I4) = B8%(p, I5, I4) + 1
    B5%(p, I5, I4) = B5%(p, I5, I4) + 1

3394 '
END SUB


'------------------------------
'   THROW2FIRST Subroutine
'------------------------------
' ...explanation...
SUB THROW2FIRST (D)
    '*** throw to 1st from 3rd/ss ***
    Y% = INT(RND(1) * 40) + 1570
    CALL GETRPBP(Y%, Y$, D)
    CALL STRIPRPBP(Y$, Y%, D)
    PRINT Y$; " to first"
    CALL DELAY
END SUB


'------------------------------
'   TIRING Subroutine
'------------------------------
' ...explanation...
SUB TIRING (P9)
    'tired on runs and hits
    IF S8%(P9, 0) <= P8%(P9, P1%(P9), 4) + P8%(P9, P1%(P9), 1) AND S8%(P9, 1) <= P8%(P9, P1%(P9), 2) THEN 9756
    IF S8%(P9, 1) > 0 AND (S8%(P9, 0) <= P8%(P9, P1%(P9), 4) + P8%(P9, P1%(P9), 1) OR S8%(P9, 1) <= P8%(P9, P1%(P9), 2)) THEN 9755
    IF S8%(P9, 1) > 0 THEN 9754
    IF P8%(P9, P1%(P9), 4) + P8%(P9, P1%(P9), 1) < 3 AND P8%(P9, P1%(P9), 2) = 0 THEN 9754
    IF P8%(P9, P1%(P9), 4) + P8%(P9, P1%(P9), 1) > 2 AND P8%(P9, P1%(P9), 0) >= 5 THEN 9755

9754 PRINT p$(P9, P1%(P9)); " seems to be OK!!"; : GOTO 9757

9755 PRINT p$(P9, P1%(P9)); " is tiring!!"; : GOTO 9757

9756 CALL RANDNUM(rn)
    IF rn <= 50 AND S8%(P9, 1) > 0 AND INNING% < 6 OR S8%(P9, 1) = 0 AND P8%(P9, P1%(P9), 4) + P8%(P9, P1%(P9), 1) > 4 THEN PRINT p$(P9, P1%(P9)); " just doesn't have it today"; : GOTO 9757
    IF rn > 50 AND S8%(P9, 1) > 0 AND INNING% < 6 OR S8%(P9, 1) = 0 AND P8%(P9, P1%(P9), 4) + P8%(P9, P1%(P9), 1) > 4 THEN PRINT p$(P9, P1%(P9)); " ain't got nuthin' on his fastball folks!"; : GOTO 9757
    PRINT p$(P9, P1%(P9)); " is tired!!";

9757 '
END SUB


'------------------------------
'   TRIPLEPLAY Subroutine
'------------------------------
' ...explanation...
SUB TRIPLEPLAY (D)
    CALL BLANKLINES
	Q$(4) = b$(D, B9%(D, 5))
    PRINT "grounder to "; Q$(4); " @ 3B": CALL DELAY
    PRINT Q$(2); " OUT @ 3B": CALL DELAY
    PRINT Q$(1); " OUT @ 2B": CALL DELAY
    PRINT Q$(0); " OUT @ 1B": CALL DELAY:
    PRINT "--- TRIPLE PLAY !!! ---": CALL DELAY: CALL DELAY
    O%(0) = 3
    I5 = P1%(D): I6 = 0: FOR i = 1 TO 3: CALL ADDPIT(D, I5, I6): NEXT i
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF(P, I5, I6)
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF(P, I5, I6)
END SUB


'------------------------------
'   TRYFOREXTRABASE Subroutine
'------------------------------
' ...explanation...
SUB TRYFOREXTRABASE (LN%, S2%, P2, Z2%, D, W%, sah%, SB%,I8,I9)
    IF LN% = 3308 THEN LN% = 0: GOTO 3308
    I8 = 0: H6% = INT(RND(1) * 100) + 1
    IF S2% = 8 AND B0%(2, 0) > 0 AND H6% < 6 AND B0%(3, 0) = 0 AND b%(p, B3%(p, B0%(2, 0)), 8) > 0 THEN I8 = 3
    IF S2% = 9 AND B0%(3, 0) > 0 AND H6% <= 2 AND b%(p, B3%(p, B0%(3, 0)), 9) > 0 THEN I8 = 4
    IF S2% = 7 AND B0%(3, 0) > 0 AND P2 = 2 AND H6% >= 6 AND H6% <= b%(p, B3%(p, B0%(3, 0)), 16) THEN I8 = 4
    IF S2% = 7 AND B0%(3, 0) > 0 AND Z2% = B0%(3, 0) AND P2 <> 2 AND H6% <= b%(p, B3%(p, B0%(3, 0)), 16) * 12 THEN I8 = 4
    E2% = 10
    IF B0%(2,0)>0 THEN E2%=E2% + b%(p, B3%(p, B0%(2, 0)), 16)
    IF S2% = 7 AND B0%(2, 0) > 0 AND P2 <> 2 AND H6% <= E2% AND B0%(3, 0) = 0 AND I8 = 0 THEN I8 = 3
    IF S2% = 7 AND B0%(1, 0) > 0 AND B0%(2, 0) = 0 AND I8 = 0 AND H6% <= b%(p, B3%(p, B0%(1, 0)), 16) AND b%(p, B3%(p, B0%(1, 0)), 7) > 0 THEN I8 = 2
    IF I8 = 0 THEN 3385

3308 IF u6 = 2 OR u6 = 1 AND p = u9 THEN 3310
    PRINT Q$(I8 - 1);
    IF S2% < 10 THEN PRINT " try for "; H$(I8); " (YN) "
    IF S2% > 10 THEN PRINT " tag up (YN) "
    PRINT "against "; Q$(4)

3310 ';" Arm:";B%(D,B9%(D,W%),15)
    i$ = "N": A1 = S6%(p, 0) - S6%(D, 0)
    IF (u6 = 2 OR u6 = 1 AND p = u9) AND A1 > -2 AND A1 < 2 AND S2% <> 19 THEN i$ = "Y": GOTO 3312
    IF (u6 = 2 OR u6 = 1 AND p = u9) AND A1 < 0 AND (INNING% >= 7 OR S2% = 19) THEN i$ = "N": GOTO 3312
    IF S2% = 8 AND O%(0) = 2 AND I8 = 3 AND (u6 = 2 OR u6 = 1 AND p = u9) THEN i$ = "N"
    IF u6 = 2 OR u6 = 1 AND p = u9 THEN 3312
3311 i$ = GetKeyPress$

3312 IF UCASE$(i$) <> "Y" THEN i9 = 1: GOTO 3385
    PRINT Q$(I8 - 1); " is "; : IF S2% < 10 THEN PRINT "going for "; H$(I8)
    IF S2% > 10 THEN PRINT "tagging"
    CALL DELAY
    IF S2% = 7 AND I8 = 2 OR S2% > 10 AND S4% = 3 THEN 3317
    IF u6 = 2 OR u6 = 1 AND D = u9 THEN 3322
    PRINT Q$(4); " throw to "; H$(I8); " (YN) "

3322 CALL RANDNUM (RN)
    IF (u6 = 2 OR u6 = 1 AND D = u9) AND MG%(D,766)=999 AND I8=4 AND INNING%>=MG%(D,767) AND MG%(D,767)<>0 AND MG%(D,768)<=S6%(D, 0) - S6%(P, 0) THEN I$="N":GOTO 3316
    IF (u6 = 2 OR u6 = 1 AND D = u9) AND MG%(D,766)=999 AND I8=4 AND INNING%>=MG%(D,769) AND MG%(D,769)<>0 AND MG%(D,770)<=S6%(D, 0) - S6%(P, 0) THEN I$="N":GOTO 3316
    IF u6 = 2 OR u6 = 1 AND D = u9 THEN i$ = "Y": GOTO 3316
3315 i$ = GetKeyPress$

3316 i9 = 0: IF UCASE$(i$) <> "Y" THEN i9 = 1: PRINT "No throw is made": CALL DELAY: GOTO 3380

3317 CALL BLANKLINES
	PRINT "Here comes the throw by "; Q$(4)
    FOR i = 1 TO 3: PRINT "."; : CALL DELAY: NEXT i: PRINT " "
    CALL FLDERR (F%, W%, D, I3, SB%, S2%, p): IF F% = 1 THEN 3385
    I4 = INT(RND(1) * 1000) + 1: A = b%(p, B3%(p, B0%(I8 - 1, 0)), 16)
    IF B7%(p, B0%((I8 - 1), 0)) = 1 THEN A = p%(p, P1%(p), 31)
    A = A - 5: A = A * 50
    IF S2% = 17 THEN b = ((b%(D, B9%(D, W%), 15) - 5) * 25): I3 = 1000 + A - b:' WAS 800
    IF S2% = 18 THEN b = ((b%(D, B9%(D, W%), 15) - 5) * 25): I3 = 800 + A - b:' WAS 650
    IF S2% = 19 OR S2% < 10 THEN b = ((b%(D, B9%(D, W%), 15) - 5) * 25): I3 = 500 + A - b
    IF I4 <= I3 THEN 3380
    A5%(I8 - 1) = 11: O%(0) = O%(0) + 1: O%(1) = O%(1) + 1: I5 = P1%(D): I6 = 0: CALL ADDPIT(D, I5, I6)
    CALL RANDNUM (rn)
    IF rn <= 4 AND I8 = 4 THEN PRINT Q$(I8 - 1); " collides with "; b$(D, B9%(D, 2)): CALL DELAY: PRINT b$(D, B9%(D, 2)); " hangs on!!": GOTO 3377
    IF rn <= 50 AND I8 <> 4 THEN PRINT Q$(I8 - 1); " doesn't make it!": GOTO 3377
    IF rn <= 80 THEN PRINT "throw is perfect!": GOTO 3377
    IF rn <= 90 THEN PRINT "This will be close": GOTO 3377
    PRINT "Close play.....": CALL DELAY
    IF I8 < 4 THEN PRINT U$(I8 + 1);
    IF I8 = 4 THEN PRINT U$(1);
    PRINT " makes the call..."

3377 CALL DELAY: CALL CREDITASSIST (W%, D): CALL ADVANCEMENT (p, D, S2%, F%,I3): CALL CREDITPUTOUT(2, FB2P%, AST%, D): W% = 2
    IF O%(0) = 3 OR S2% > 10 THEN 3385

3371 I5 = INT(RND(1) * 100) + 1
    A1 = S6%(p, 0) - S6%(D, 0)
    IF A1 < -2 OR A1 < 0 AND INNING% > 8 THEN 3376
      '*** RUNNER ON 2ND GUNNED AT 3RD ON THROW HOME ***
    IF I8 - 1 > 2 AND I5 <= 15 AND B0%(2, 0) > 0 THEN
        CALL CREDITASSIST (W%, D)
        PRINT "runner is trying for 3rd...": CALL DELAY
        A5%(2) = 11
        O%(0) = O%(0) + 1: O%(1) = O%(1) + 1
        W% = 5: CALL CREDITREGPO(W%, D)
        I5 = P1%(D): I6 = 0
        CALL ADDPIT(D , I5, I6)
    END IF
      '*** RUNNER ON 1ST GUNNED AT 2ND ON THROW TO HOME OR 3RD ***
    I5 = INT(RND(1) * 100) + 1
    IF I8 - 1 > 1 AND I5 <= 15 AND B0%(1, 0) > 0 AND A5%(2) <> 11 THEN
        CALL CREDITASSIST(W%, D)
        W% = 6: CALL CREDITREGPO(W%, D)
        PRINT "runner is trying for 2nd...":CALL DELAY
        A5%(1) = 11
        O%(0) = O%(0) + 1: O%(1) = O%(1) + 1
        I5 = P1%(D): I6 = 0
        CALL ADDPIT(D, I5, I6)
    END IF
    I5 = INT(RND(1) * 100) + 1
    IF B0%(2,0)>0 AND I8 - 1 > 2 AND A5%(2) <> 11 AND I5 > (80 - b%(p, B3%(p, B0%(2, 0)), 16) * 2) AND i9 = 0 THEN A5%(2) = 1: PRINT "runner is trying for 3rd...": CALL DELAY: PRINT "He's safe!": CALL DELAY
    I5 = INT(RND(1) * 10) + 1
    IF B0%(1,0)>0 AND A5%(1)<>11 AND (S4%=4 OR S4%=7 AND I8-1>1 AND I5>(10 - b%(p, B3%(p, B0%(1, 0)), 16)) AND i9 = 0) THEN A5%(1) = 1: PRINT "runner is trying for 2nd...": CALL DELAY: PRINT "He's in there!": CALL DELAY: GOTO 3376
    I5 = INT(RND(1) * 100) + 1
    IF B0%(1,0)>0 AND I8-1>1 AND I5>(80-b%(p,B3%(p,B0%(1, 0)),16)*2) AND i9=0 AND A5%(1)<>11 THEN PRINT "runner safe at 2nd on the throw": CALL DELAY: A5%(1) = 1

3376 CALL ADVANCEMENT(p, D, S2%, F%,I3): i9 = 0: GOTO 3385

3380 A5%(I8 - 1) = 1: IF i9 = 1 THEN 3379
    CALL RANDNUM (rn)
    IF rn <= 4 AND I8 = 4 THEN PRINT Q$(I8 - 1); " collides with "; b$(D, B9%(D, 2)): CALL DELAY: PRINT "He knocks the ball loose!!": GOTO 3379
    IF rn <= 50 AND I8 <> 4 THEN PRINT Q$(I8 - 1); " beats the throw!": GOTO 3379
    IF rn <= 60 THEN PRINT Q$(I8 - 1); " is ahead of the throw": GOTO 3379
    IF rn <= 80 THEN PRINT "throw is off line": GOTO 3379
    IF rn <= 90 THEN PRINT Q$(I8 - 1); " slides under the tag": GOTO 3379
    PRINT "Close play...": CALL DELAY
    IF I8 <> 4 THEN PRINT U$(I8 + 1);
    IF I8 = 4 THEN PRINT U$(1);
    PRINT " makes the call..."

3379 CALL DELAY: PRINT Q$(I8 - 1); " is safe @ "; H$(I8): CALL DELAY
    IF I8 = 4 THEN sah% = 1
    CALL TAGADVANCE(S2%, I8, D): IF S2% < 10 THEN 3371
    IF S2% > 10 AND B7%(p, B1!(p)) = 1 THEN P8%(p, P1%(p), 23) = P8%(p, P1%(p), 23) - 1: P5%(p, P1%(p), 23) = P5%(p, P1%(p), 23) - 1: I5 = P1%(p): I6 = 41: CALL INCPITOFF(P, I5, I6): I5 = P1%(D): I6 = 16: CALL ADDPIT(D, I5, I6): GOTO 3385
    IF S2% > 10 AND B7%(p, B1!(p)) <> 1 THEN 3381
    GOTO 3385

3381 B8%(p, B3%(p, B1!(p)), 0) = B8%(p, B3%(p, B1!(p)), 0) - 1
    B5%(p, B3%(p, B1!(p)), 0) = B5%(p, B3%(p, B1!(p)), 0) - 1
    IF P%(D,P1%(D),0) = 1 THEN 3382
    CSS%(P, B3%(p, B1!(p)), 0) = CSS%(P, B3%(p, B1!(p)), 0) - 1

3382 I5 = B3%(p, B1!(p)): I6 = 19: CALL INCBATOFF(P, I5, I6): I5 = P1%(D)
    I6 = 16: CALL ADDPIT(D, I5, I6): GOTO 3371

3385 '
END SUB


'------------------------------
'   VIEWTEAM Subroutine
'------------------------------
' ...explanation...
SUB VIEWTEAM ()

700 CLS
    COLOR 12: PRINT TAB(20); "SELECT TEAM TO VIEW DETAILED STATS FOR:": PRINT : PRINT
    COLOR 14, 0: PRINT "(0) "; : COLOR l%(0, 11), l%(0, 12): PRINT A$(0): PRINT
    COLOR 14, 0: PRINT "(1) "; : COLOR l%(1, 11), l%(1, 12): PRINT A$(1): PRINT
    COLOR 14, 0: PRINT "(2) "; : COLOR 15: PRINT "RETURN TO PLAY"
701 i$ = GetKeyPress$
    WK = VAL(i$): IF WK < 0 OR WK > 2 THEN 701
    IF WK = 2 THEN 850
    CLS
    COLOR 14: PRINT "(1) "; : COLOR 15: PRINT "VIEW PITCHERS": PRINT
    COLOR 14: PRINT "(2) "; : COLOR 15: PRINT "VIEW HITTERS": PRINT
    COLOR 14: PRINT "(3) "; : COLOR 15: PRINT "RETURN TO PLAY"
706 i$ = GetKeyPress$
    Q = VAL(i$): IF Q < 1 OR Q > 3 THEN 706
    IF Q = 3 THEN 850
    IF Q = 1 THEN 800

725 CLS
    COLOR 12: PRINT "VIEW BATTERS (AVAILABLE PLAYERS HIGHLIGHTED)"
    FOR i = 0 TO 10: COLOR 3, 0
    IF b%(WK, i, 21) = 0 THEN COLOR 11
    LOCATE i + 5, 5: PRINT USING "##"; i; : PRINT " "; b$(WK, i); TAB(40);
    COLOR 3
    IF b%(WK, i + 12, 21) = 0 THEN COLOR 11
    PRINT USING "##"; i + 12; : PRINT " "; b$(WK, i + 12): COLOR 3: NEXT
    IF b%(WK, 11, 21) = 0 THEN COLOR 11
    LOCATE , 5: PRINT USING "##"; 11; : PRINT " "; b$(WK, 11)
    COLOR 3

730 COLOR 15: LOCATE 20, 1: PRINT "# TO VIEW (0-22) (23 TO CONTINUE) "; : INPUT M
    IF M < 0 OR M > 23 THEN 730
    IF M = 23 THEN 700
    LOCATE 3, 3: COLOR l%(WK, 11), l%(WK, 12): PRINT " "; CHR$(201); STRING$(71, 205); CHR$(187); " "
    FOR X = 1 TO 7: LOCATE , 3: PRINT " "; CHR$(186); STRING$(71, 32); CHR$(186); " ": NEXT
    LOCATE , 3: PRINT " "; CHR$(200); STRING$(71, 205); CHR$(188); " "
    LOCATE 4, 6: PRINT "Stats for ";
    PRINT b$(WK, M): LOCATE , 6: PRINT "BATS: "; B1$(b%(WK, M, 0) + 2); "    "; : PRINT USING "G/A%: ##       BUNT: #       RUN: #"; b%(WK, M, 18); b%(WK, M, 30); b%(WK, M, 16)
    LOCATE , 3: PRINT " "; CHR$(204); STRING$(71, 205); CHR$(185); " "
    LOCATE , 6: PRINT "          AVG   OBP   G  AB   R   H 2B 3B HR RBI  BB  SO  SB CS HS LS"
    CALL POPUPBAT(WK, M)
790 i$ = GetKeyPress$
    COLOR 7, 0: GOTO 725

800 CLS
    COLOR 12: PRINT "VIEW PITCHERS (AVAILABLE PLAYERS HIGHLIGHTED)"
    FOR i = 0 TO 10: COLOR 3, 0
    IF p%(WK, i, 15) = 0 THEN COLOR 11
    LOCATE i + 5, 5: PRINT USING "##"; i; : PRINT " "; p$(WK, i); TAB(40);
    COLOR 3
    IF p%(WK, i + 11, 15) = 0 THEN COLOR 11
    PRINT USING "##"; i + 11; : PRINT " "; p$(WK, i + 11): COLOR 3: NEXT

801 COLOR 15: LOCATE 20, 1: PRINT "# TO VIEW (0-21) (22 TO CONTINUE) "; : INPUT M
    IF M < 0 OR M > 22 THEN 801
    IF M = 22 THEN 700
    CALL POPUPPIT(WK, M)
830 i$ = GetKeyPress$
    COLOR 7, 0: GOTO 800

850 '
END SUB


'------------------------------
'   WALLDOUBLE Subroutine
'------------------------------
' ...explanation...
SUB WALLDOUBLE (HW%, W%)
    '*** doubles off of a wall ***
    BV = INT(RND(1) * 100) + 1: rn = INT(RND(1) * 100) + 1

3781 IF BV <= 40 AND HW% = 0 THEN PRINT "It's in the gap and to the wall": GOTO 3785
    IF BV <= 65 AND rn <= 25 AND (l%(1, 13) = 8 OR l%(1, 13) = 40) THEN PRINT "It's off the ivy!": GOTO 3785
    IF BV <= 65 AND rn <= 50 AND l%(1, 13) = 21 AND W% = 7 THEN PRINT "It hits off the Green Monster!": GOTO 3785
    IF BV <= 65 AND l%(1, 13) = 27 AND W% = 7 THEN PRINT "It hits off the screen!": GOTO 3785
    IF BV <= 65 THEN PRINT "It's off the wall": GOTO 3785
    IF BV <= 85 AND HW% = 0 THEN 3788
    IF BV <= 90 AND HW% = 0 THEN PRINT "It's to the wall": CALL DELAY: PRINT Q$(0); " slides into second": PRINT "with a stand-up double!!": GOTO 3785
    IF rn <= 25 AND l%(1, 13) = 21 THEN PRINT "It's off the Green Monster!": GOTO 3785
    IF l%(1, 13) = 27 AND W% = 7 THEN PRINT "It's off the screen...": GOTO 3785
    PRINT "It's off the top of the wall...": GOTO 3785

3788 IF W% = 8 THEN BV = 39: GOTO 3781
    PRINT "It's past "; Q$(4): CALL DELAY: PRINT "It goes into the corner...": GOTO 3785

3785 '
END SUB


'------------------------------
'   WHICHRUNNER Subroutine
'------------------------------
' ...explanation...
SUB WHICHRUNNER (i, S4%, D5)
    IF i = 4 THEN A5%(3) = 1
    IF S4% <> 4 THEN 4297
    CALL BLANKLINES
	LOCATE 15, 1: PRINT "WHICH RUNNER DO YOU WANT TO GO AFTER"
    PRINT "1 - "; b$(p, B3%(p, B0%(2, 0)))
    IF B7%(p, B0%(1, 0)) <> 1 THEN PRINT "2 - "; b$(p, B3%(p, B0%(1, 0)))
    IF B7%(p, B0%(1, 0)) = 1 THEN PRINT "2 - "; p$(p, P1%(p))
    IF u6 = 2 OR u6 = 1 AND p <> u9 THEN D5 = INT(RND(1) * 2) + 1: i$ = STR$(D5): GOTO 4296
4295 i$ = GetKeyPress$

4296 D5 = VAL(i$): CALL BLANKLINES
	LOCATE 15, 1: IF D5 = 2 THEN i = 2: D5 = 3: I2 = B3%(p, B0%(1, 0)): IF B7%(p, B0%(1, 0)) = 1 THEN Q$(i - 1) = p$(p, P1%(p))
    D5 = 0

4297 '
END SUB


'------------------------------
'   WHOSON1ST Subroutine
'------------------------------
' ...explanation...
SUB WHOSON1ST (S4%)
    S4% = 0: I1 = B0%(1, 0): I2 = B0%(2, 0): I3 = B0%(3, 0)
    IF I1 > 0 AND I2 = 0 AND I3 = 0 THEN S4% = 1
    IF I1 = 0 AND I2 > 0 AND I3 = 0 THEN S4% = 2: REM*** RUNNER ON 2ND ***
    IF I1 = 0 AND I2 = 0 AND I3 > 0 THEN S4% = 3: REM*** RUNNER ON 3RD ***
    IF I1 > 0 AND I2 > 0 AND I3 = 0 THEN S4% = 4: REM*** 1ST AND 2ND ***
    IF I1 > 0 AND I2 = 0 AND I3 > 0 THEN S4% = 5: REM*** 1ST AND 3RD ***
    IF I1 = 0 AND I2 > 0 AND I3 > 0 THEN S4% = 6: REM*** 2ND AND 3RD ***
    IF I1 > 0 AND I2 > 0 AND I3 > 0 THEN S4% = 7: REM*** BASES LOADED ***
END SUB


'------------------------------
'   FOULBALL Subroutine
'------------------------------
' ...explanation...
SUB FOULBALL ()
    call randnum(rn)
    if rn<=50 then
        Y% = INT(RND(1) * 20) + 3130
        CALL GETRPBP (Y%,Y$,D): CALL STRIPRPBP (Y$,Y%,D)
        PRINT Y$
        CALL DELAY
        PRINT "foul ball!!"
        call delay
    else
        Y% = INT(RND(1) * 10) + 3150
        CALL GETRPBP (Y%,Y$,D): CALL STRIPRPBP (Y$,Y%,D)
        PRINT Y$
        CALL DELAY
        Y% = INT(RND(1) * 10) + 3160
        CALL GETRPBP (Y%,Y$,D): CALL STRIPRPBP (Y$,Y%,D)
        PRINT Y$
        CALL DELAY
    end if
END SUB

'------------------------------
'   RAREPLAYS Subroutine
'------------------------------
' ...explanation...
SUB RAREPLAYS (H6%, H7%)
IF H7% = 20 THEN H7% = 0: GOTO 2008

2000 CALL BLANKLINES
	H6% = INT(RND(1) * 100) + 1
    IF H6% = 1 THEN PRINT b$(D, B9%(D, 2)); " is arguing ball and strike calls": CALL DELAY
    IF H6% = 1 THEN PRINT U$(1); " has heard enough": CALL DELAY
    IF H6% = 1 THEN PRINT b$(D, B9%(D, 2)); " has been ejected!!": X$ = b$(D, B9%(D, 2)): CALL EJECTINC (EJ%,X$): CALL DELAY: po% = 2: CALL EJECTIONINJURY (U6,P,U9,D,PO%,P9,W5,W6): GOTO 2850
    IF H6% <= 3 THEN PRINT p$(D, P1%(D)); " steps off the mound"
    IF H6% <= 3 THEN PRINT "after that last call": CALL DELAY: PRINT "He is shouting at "; U$(1): CALL DELAY
    IF H6% <= 3 THEN PRINT U$(1); " does not appreciate what he hears...": CALL DELAY: PRINT p$(D, P1%(D)); " has been ejected!!"
    IF H6% <= 3 THEN X$ = p$(D, P1%(D)): CALL EJECTINC (EJ%,X$): CALL DELAY: CALL INJPIT (P,D): GOTO 2850
    IF H6% = 4 AND B7%(p, B1!(p)) <> 1 THEN PRINT Q$(0); " is unhappy with that last call": CALL DELAY: PRINT "He is venting his opinion to "; U$(1): CALL DELAY: PRINT "Thats it!! "; U$(1); " has ejected "; Q$(0); "!!"
    IF H6% = 4 AND B7%(p, B1!(p)) <> 1 THEN X$ = Q$(0): CALL EJECTINC (EJ%,X$):CALL DELAY: CALL PLYRHRT (P,P9,W5,W6,BC%,U%,D,MO)
    IF H6% = 4 AND B7%(p, B1!(p)) <> 1 THEN 2850
    IF H6% = 4 THEN PRINT Q$(0); " did not like that": PRINT "last call at all!!": CALL DELAY: GOTO 2850
    IF H6% > 5 THEN 2005
    PRINT Q$(0); " hits a slow roller to first"
    CALL DELAY: PRINT b$(D, B9%(D, 3)); " fields it cleanly"
    CALL DELAY: PRINT "He flips it to "; p$(D, P1%(D)); " covering just in time!"
    CALL DELAY: PRINT "Wait... "; U$(2); " rules safe!!": CALL DELAY
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF (P,I5,I6): I6 = 1: CALL INCBATOFF (P,I5,I6)
    I5 = P1%(D): I6 = 1: CALL ADDPIT (D,I5,I6)
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF (P,I5,I6): I6 = 24: CALL INCPITOFF (P,I5,I6)
    FOR i = 0 TO 3: a5%(i) = 1: NEXT i: CALL ADVANCEMENT (P,D,S2%,F%,I3): CALL SCOREBOARD
    CALL BLANKLINES
	PRINT m$(D); " charges from the dugout": CALL DELAY
    PRINT m$(D); ", "; p$(D, P1%(D)); ","
    PRINT b$(D, B9%(D, 2)); ", and "; b$(D, B9%(D, 3))
    PRINT "are going at it with "; U$(2)
    CALL DELAY: CALL DELAY: CALL DELAY
    PRINT U$(3); " and "; U$(1); " come in to help out": CALL DELAY
    PRINT "This argument is out of control now!!": CALL DELAY
    PRINT "What is this!!": CALL DELAY
    PRINT "All of them have been ejected!!!"
    X$ = p$(D, P1%(D)): CALL EJECTINC (EJ%,X$)
    X$ = b$(D, B9%(D, 2)): CALL EJECTINC (EJ%,X$)
    X$ = b$(D, B9%(D, 3)): CALL EJECTINC (EJ%,X$)
    X$ = m$(D): CALL EJECTINC (EJ%,X$)
    CALL DELAY: po% = 2: CALL EJECTIONINJURY (U6,P,U9,D,PO%,P9,W5,W6): po% = 3: CALL EJECTIONINJURY (U6,P,U9,D,PO%,P9,W5,W6): CALL INJPIT (P,D): GOTO 2850

2005 IF H6% > 7 THEN 2007
    PRINT Q$(0); " sends a long one"
    PRINT "down the left field line": CALL DELAY
    PRINT "It may go...": CALL DELAY: PRINT "HOME RUN!!!": CALL DELAY
    PRINT "Wait!!! "; : CALL DELAY: PRINT U$(4); " is calling it foul!!": CALL DELAY
	CALL BLANKLINES
    PRINT Q$(0); " is arguing vehemently"
    PRINT "with "; U$(1); " and "; U$(4): CALL DELAY
    PRINT m$(p); " charges from the dugout": CALL DELAY
    PRINT "He and "; Q$(0); " are really going"
    PRINT "at it with the umpires!!": CALL DELAY: CALL DELAY
    PRINT Q$(0); " has just been tossed!!": X$ = Q$(0): CALL EJECTINC (EJ%,X$): CALL DELAY
    CALL PLYRHRT (P,P9,W5,W6,BC%,U%,D,MO): GOTO 2850

2007 IF H6% = 8 THEN PRINT U$(1); " has just ejected "; p$(D, P1%(D))
    IF H6% = 8 THEN PRINT "for wetting the ball!!": CALL EJECTINC (EJ%,X$): EJ$(EJ%) = p$(D, P1%(D)): CALL DELAY: CALL DELAY: CALL INJPIT (P,D): GOTO 2850
    IF H6% = 9 THEN PRINT "Here's the 3-2 pitch...": CALL DELAY: PRINT "Time called...": PRINT U$(1); " is calling it ball 4": CALL DELAY: PRINT "He says "; p$(D, P1%(D)); " went to his mouth": CALL DELAY: GOTO 2850
    IF H6% > 15 THEN 2006
    PRINT Q$(0); " hits the deck on a high"
    PRINT "and tight pitch from "; p$(D, P1%(D)): CALL DELAY: CALL DELAY
    PRINT Q$(0); " charges the mound!": CALL DELAY
    PRINT "Both dugouts have emptied...": CALL DELAY
    PRINT "It's a bench-clearing brawl!": CALL DELAY
    CALL BLANKLINES
	PRINT "It will take a few minutes to clean this up": CALL DELAY: i = INT(RND(1) * 3) + 1
    IF i = 1 THEN PRINT p$(D, P1%(D)); " has been ejected": X$ = p$(D, P1%(D)): CALL EJECTINC (EJ%,X$): CALL DELAY: CALL INJPIT (P,D): GOTO 2850
    IF i = 2 THEN PRINT Q$(0); " has been ejected": X$ = Q$(0): CALL EJECTINC (EJ%,X$): CALL DELAY: CALL PLYRHRT (P,P9,W5,W6,BC%,U%,D,MO): GOTO 2850
    PRINT Q$(0); " and "; p$(D, P1%(D)); " have been ejected": X$ = Q$(0): CALL EJECTINC (EJ%,X$): X$ = p$(D, P1%(D)): CALL EJECTINC (EJ%,X$): CALL DELAY: CALL INJPIT (P,D): CALL PLYRHRT (P,P9,W5,W6,BC%,U%,D,MO): GOTO 2850

2006 IF H6% > 21 THEN 2010

2008 H6%=21:CALL BLANKLINES
	IF RD = 0 AND (PC% = 0 OR PC% = 4) THEN PRINT Q$(0); " fouls the pitch out of play": CALL DELAY: GOTO 2850
    tm = INT(RND(1) * 59) + 2: COLOR 0, 7: PRINT "The game has been halted by rain": FOR i = 1 TO 3: CALL DELAY: NEXT
    PRINT "Rain delay lasted"; tm; " minutes": CALL DELAY: CALL DELAY
    RD% = 1
    IF tm > 28 THEN PRINT "Pitchers have lost effectiveness during delay": CALL DELAY: PRINT "Their arms have stiffened up": CALL DELAY: CALL DELAY: FOR i = 0 TO 1: s8%(i, 0) = s8%(i, 0) - 2: NEXT
    GOTO 2850

2010 IF H6% > 24 THEN 2015
    IF s4% = 0 AND L%(1, 13) = 14 THEN PRINT Q$(0); " steps out of the box as a jet passes over": CALL DELAY: GOTO 2850
    IF s4% = 0 THEN PRINT U$(1); " calls time to get some new baseballs": CALL DELAY: GOTO 2850
    PRINT b$(D, B9%(D, 2)); " rifles the ball to ";
    IF s4% = 1 THEN PRINT "1st...": CALL DELAY: i = 2: GOTO 2012
    IF s4% = 2 OR s4% = 4 THEN PRINT "2nd base...": CALL DELAY: i = 3: GOTO 2012
    PRINT "3rd base...": CALL DELAY: i = 4

2012 PRINT Q$(i - 1); " is picked off base!"
    a5%(i - 1) = 10: O%(0) = O%(0) + 1: O%(1) = O%(1) + 1: W% = 2
    CALL CREDITASSIST (W%,D): CALL ADVANCEMENT (P,D,S2%,F%,I3): CALL CREDITPUTOUT (I3,FB2P%,AST%,D)
    I5 = P1%(D): I6 = 0: CALL ADDPIT (D,I5,I6)
    IF O%(0) >= 3 THEN B1!(p)=B1!(p)-1:H6%=5:GOTO 2850

2015 IF H6% > 29 THEN 2020
    PRINT Q$(0); " pops it up near the 3rd base stands": CALL DELAY
    PRINT "A fan interferes...": CALL DELAY
    PRINT b$(D, B9%(D, 6)); " makes a great catch!!": W% = 6: CALL CREDITREGPO (W%,D)
    O%(0) = O%(0) + 1: O%(1) = O%(1) + 1: CALL DELAY
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF (P,I5,I6)
    I5 = P1%(D): I6 = 0: CALL ADDPIT (D,I5,I6)
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF (P,I5,I6)
    CALL DELAY: GOTO 2850

2020 IF H6% <= 31 THEN PRINT Q$(0); " pops it up foul near the stands": CALL DELAY
    IF H6% <= 30 THEN PRINT b$(D, B9%(D, 2)); " runs into the stands!!": po% = 2: GOTO 2099
    IF H6% <= 31 THEN PRINT b$(D, B9%(D, 3)); " gives chase and runs into the stands!!": po% = 3: GOTO 2099
    IF H6% = 32 THEN PRINT Q$(0); " pops it up foul down the rf line": CALL DELAY: PRINT b$(D, B9%(D, 4)); " crashes into the wall going for it": po% = 4: GOTO 2099
    IF H6% = 33 THEN PRINT Q$(0); " pops it up foul by"
    IF H6% = 33 THEN PRINT "the 3rd base dugout": CALL DELAY
    IF H6% = 33 THEN PRINT b$(D, B9%(D, 5)); " falls in trying to make the catch!!": CALL DELAY: po% = 5: GOTO 2099
    IF H6% = 34 THEN PRINT Q$(0); " pops it up foul"
    IF H6% = 34 THEN PRINT "down the lf line": CALL DELAY
    IF H6% = 34 THEN PRINT b$(D, B9%(D, 6)); " tumbles over the railing"
    IF H6% = 34 THEN PRINT "trying to make the catch!": CALL DELAY: CALL DELAY: po% = 6: GOTO 2099
    IF H6% > 37 THEN 2023
    PRINT Q$(0); " lines one to deep left field": CALL DELAY: PRINT b$(D, B9%(D, 7)); " races back...": CALL DELAY: PRINT "He slams into the wall and is down!!": CALL DELAY
    op% = 7: PRINT b$(D, B9%(D, 8)); " comes over and gets the ball in": CALL DELAY

2021 I5 = P1%(D): I6 = 1: CALL ADDPIT (D,I5,I6)
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF (P,I5,I6): I6 = 1: CALL INCBATOFF (P,I5,I6): I6 = 4: CALL INCBATOFF (P,I5,I6)
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF (P,I5,I6): I6 = 24: CALL INCPITOFF (P,I5,I6): I6 = 27: CALL INCPITOFF (P,I5,I6)
    FOR i = 0 TO 3: a5%(i) = 2: NEXT i: a5%(3) = 1: a5%(1) = 3: CALL ADVANCEMENT (P,D,S2%,F%,I3): CALL SCOREBOARD: CALL BLANKLINES: po% = op%: GOTO 2098

2023 IF H6% > 40 THEN 2025
    PRINT Q$(0); " drives a sinking liner"
    PRINT "into deep center": CALL DELAY
    PRINT b$(D, B9%(D, 8)); " gets a good jump on it": CALL DELAY
    PRINT "He crashes into the wall and"
    PRINT "the ball bounces away!!": CALL DELAY
    PRINT "The runners are circling the bases": CALL DELAY
    PRINT b$(D, B9%(D, 9)); " retrieves the ball": CALL DELAY
    I5 = P1%(D): I6 = 1: CALL ADDPIT (D,I5,I6): I6 = 14: CALL ADDPIT (D,I5,I6): W% = 8
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF (P,I5,I6): I6 = 1: CALL INCBATOFF (P,I5,I6): I6 = 6: CALL INCBATOFF (P,I5,I6)
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF (P,I5,I6): I6 = 24: CALL INCPITOFF (P,I5,I6): I6 = 29: CALL INCPITOFF (P,I5,I6)
    a5%(0) = 4: a5%(1) = 3: a5%(2) = 2: a5%(3) = 1: CALL ADVANCEMENT (P,D,S2%,F%,I3): PRINT "It's an inside the park HOME RUN!!!": CALL DELAY: CALL DELAY: CALL SCOREBOARD: CALL BLANKLINES: po% = 8: GOTO 2098

2025 IF H6% > 43 THEN 2027
    PRINT Q$(0); " lifts a deep drive into right": CALL DELAY: PRINT b$(D, B9%(D, 9)); " races back...": CALL DELAY: PRINT "He slams into the wall and is down!!": CALL DELAY
    I5 = P1%(D): I6 = 1: CALL ADDPIT (D,I5,I6): W% = 9: PRINT b$(D, B9%(D, 8)); " comes over to get the ball back in": CALL DELAY
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF (P,I5,I6): I6 = 1: CALL INCBATOFF (P,I5,I6): I6 = 5: CALL INCBATOFF (P,I5,I6)
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF (P,I5,I6): I6 = 24: CALL INCPITOFF (P,I5,I6): I6 = 28: CALL INCPITOFF (P,I5,I6)
    a5%(0) = 3: a5%(1) = 3: a5%(2) = 2: a5%(3) = 1: CALL ADVANCEMENT (P,D,S2%,F%,I3): PRINT "Triple!!": CALL DELAY: CALL DELAY: CALL SCOREBOARD: CALL BLANKLINES: po% = 9: GOTO 2098

2027 IF H6% > 44 THEN 2030
    I5 = P1%(D): I6 = 1: CALL ADDPIT (D,I5,I6): W% = INT(RND(1) * 3) + 7: PRINT Q$(0); " hits a sinking liner into "; c$(W%): CALL DELAY
    PRINT b$(D, B9%(D, W%)); " dives for the catch...": CALL DELAY
    PRINT "the ball rolls free!": CALL DELAY
    PRINT b$(D, B9%(D, W% - 1)); " gets the loose ball in": CALL DELAY
    op% = W%: GOTO 2021

2030 IF H6% = 45 THEN PRINT Q$(0); " is hit by a pitch and injured": CALL DELAY: CALL PLYRHRT (P,P9,W5,W6,BC%,U%,D,MO): GOTO 2850
    IF H6% <= 49 THEN PRINT b$(D, B9%(D, 2)); " is injured by a foul tip!": CALL DELAY: po% = 2: GOTO 2099
    IF H6% > 58 THEN 2037
    i = INT(RND(1) * 3) + 7
    IF i = 9 THEN hi1 = 3: hi2 = 9: hi3 = 8
    IF i = 8 THEN hi1 = 4: hi2 = 8: hi3 = 7
    IF i = 7 THEN hi1 = 6: hi2 = 7: hi3 = 8
    PRINT Q$(0); " hits a weak fly into short "; c$(i): CALL DELAY
    PRINT b$(D, B9%(D, hi1)); " goes out": CALL DELAY
    PRINT b$(D, B9%(D, hi2)); " is charging in": CALL DELAY
    PRINT "They collide and the ball rolls free!!": CALL DELAY
    PRINT b$(D, B9%(D, hi3)); " gets it back in"
    CALL DELAY
    I5 = P1%(D): I6 = 1: CALL ADDPIT (D,I5,I6)
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF (P,I5,I6): I6 = 1: CALL INCBATOFF (P,I5,I6): I6 = 4: CALL INCBATOFF (P,I5,I6)
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF (P,I5,I6): I6 = 24: CALL INCPITOFF (P,I5,I6): I6 = 27: CALL INCPITOFF (P,I5,I6)
    FOR i = 0 TO 3: a5%(i) = 2: NEXT i: a5%(3) = 1: a5%(1) = 3: CALL ADVANCEMENT (P,D,S2%,F%,I3): CALL SCOREBOARD
    CALL BLANKLINES: po% = hi1: CALL INJURYLENGTH (IJL%,D,PO%,U6,P,U9,P9,W5,W6): po% = hi2: CALL INJURYLENGTH (IJL%,D,PO%,U6,P,U9,P9,W5,W6): H6% = 5: GOTO 2850

2037 IF H6% <= 61 THEN PRINT Q$(0); " fouls the pitch off his foot": CALL DELAY: PRINT "He is injured": CALL DELAY: CALL PLYRHRT (P,P9,W5,W6,BC%,U%,D,MO): H6% = 1: GOTO 2850
    IF H6% > 64 THEN 2040
    PRINT Q$(0); " pops it up in foul along the 3b line": CALL DELAY: PRINT "It drifts into foul territory": CALL DELAY
    PRINT b$(D, B9%(D, 5)); " and "; p$(D, P1%(D)); " chase after it and collide!!": CALL DELAY
    PRINT b$(D, B9%(D, 5)); " is down and injured": CALL DELAY: po% = 5: GOTO 2099

2040 IF H6% > 70 THEN 2045
    PRINT Q$(0); : I5 = P1%(D): I6 = 1: CALL ADDPIT (D,I5,I6): W% = 8: CALL LONGFLY (D,W%)
    PRINT b$(D, B9%(D, 7)); " collides with "; b$(D, B9%(D, 8)); "!!": CALL DELAY
    PRINT "both fielders are down... ": CALL DELAY
    PRINT b$(D, B9%(D, 6)); " gets the ball back in": CALL DELAY
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF (P,I5,I6): I6 = 1: CALL INCBATOFF (P,I5,I6): I6 = 4: CALL INCBATOFF (P,I5,I6)
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF (P,I5,I6): I6 = 24: CALL INCPITOFF (P,I5,I6): I6 = 27: CALL INCPITOFF (P,I5,I6)
    a5%(0) = 2: a5%(1) = 3: a5%(2) = 2: a5%(3) = 1
    CALL ADVANCEMENT (P,D,S2%,F%,I3): PRINT "Double!!": CALL SCOREBOARD
    CALL BLANKLINES: po% = 7: CALL INJURYLENGTH (IJL%,D,PO%,U6,P,U9,P9,W5,W6)
    po% = 8: CALL INJURYLENGTH (IJL%,D,PO%,U6,P,U9,P9,W5,W6): H6% = 5
    GOTO 2850

2045 IF H6% > 85 THEN 2055
    PRINT Q$(0); " lines it off ";
    i = INT(RND(1) * 5) + 1: ON i GOTO 2046, 2047, 2047, 2047, 2047

2046 PRINT "the leg of "; p$(D, P1%(D)): CALL DELAY
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF (P,I5,I6): I6 = 1: CALL INCBATOFF (P,I5,I6)
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF (P,I5,I6): I6 = 24: CALL INCPITOFF (P,I5,I6)
    I5 = P1%(D): I6 = 1: CALL ADDPIT (D,I5,I6)
    FOR i = 0 TO 3: a5%(i) = 1: NEXT: CALL ADVANCEMENT (P,D,S2%,F%,I3): CALL SCOREBOARD: CALL BLANKLINES
    PRINT "He reaches on a single": CALL DELAY: PRINT p$(D, P1%(D)); " is down and in pain!": CALL DELAY
    CALL INJPIT (P,D): H6% = 5: GOTO 2850

2047 po% = i + 1: PRINT "of "; b$(D, B9%(D, po%)); " for a single": CALL DELAY: CALL DELAY
    IF B7%(p, B1!(p)) <> 1 THEN I5 = B3%(p, B1!(p)): I6 = 0: CALL INCBATOFF (P,I5,I6): I6 = 1: CALL INCBATOFF (P,I5,I6)
    IF B7%(p, B1!(p)) = 1 THEN I5 = P1%(p): I6 = 23: CALL INCPITOFF (P,I5,I6): I6 = 24: CALL INCPITOFF (P,I5,I6)
    I5 = P1%(D): I6 = 1: CALL ADDPIT (D,I5,I6)
    FOR i = 0 TO 3: a5%(i) = 1: NEXT: CALL ADVANCEMENT (P,D,S2%,F%,I3): CALL SCOREBOARD: CALL BLANKLINES
    PRINT b$(D, B9%(D, po%)); " is down and injured": CALL DELAY
    CALL INJURYLENGTH (IJL%,D,PO%,U6,P,U9,P9,W5,W6): H6% = 5: GOTO 2850

2055 IF H6% <= 89 THEN PRINT p$(D, P1%(D)); " is motioning for "; m$(D); " to come out": CALL DELAY: PRINT "It appears he has a blister": CALL DELAY: PRINT "He will have to leave the game": CALL DELAY: CALL INJPIT (P,D): H6% = 1: GOTO 2850
    IF H6% = 90 THEN PRINT Q$(0); " takes a mighty swing!": CALL DELAY: PRINT "It looks like he injured himself": CALL DELAY: CALL PLYRHRT (P,P9,W5,W6,BC%,U%,D,MO): H6% = 1: GOTO 2850
    IF H6% = 91 THEN PRINT "Time is called": CALL DELAY: PRINT "Morganna strikes again!!": CALL DELAY: H6% = 1: GOTO 2850
    PRINT U$(1); " calls time to dust off the plate": CALL DELAY: H6% = 1: GOTO 2850

2098 CALL INJURYLENGTH (IJL%,D,PO%,U6,P,U9,P9,W5,W6): H6% = 5: GOTO 2850

2099 CALL INJURYLENGTH (IJL%,D,PO%,U6,P,U9,P9,W5,W6): H6% = 1: GOTO 2850

2850 '
END SUB
