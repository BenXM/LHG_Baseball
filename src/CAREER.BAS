'$INCLUDE: 'Config.BI'
'$INCLUDE: 'KeyInput.BI'
'$INCLUDE: 'QPProEqu.BI'

_Title "Full Count Baseball - Career Files"
''$ExeIcon:'./lhg_fcbase.ico'
'_Icon	
_AllowFullScreen

DEFINT A-Z
DECLARE SUB TITLE ()

DIM B$(100), P$(80), P1%(80), B1%(100), B0%(100, 23), P0%(80, 42)
DIM T(22), T1(23), BR$(100), PR$(80), PR1%(80), BR1%(100)
DIM BR0%(100, 17), PR0%(80, 16), TR(14), TR1(15)
DIM BLYR(15), BL$(15), BLL(15) AS SINGLE, PLYR(15), PL$(15), PLL(15) AS SINGLE
DIM D$(3), menuItems$(8), AVG AS SINGLE, SLG AS SINGLE, OBP AS SINGLE, EV AS SINGLE
REDIM PRS%(15, 80, 17), BRS%(15, 100, 18)

OPEN "DEV.BAS" FOR INPUT AS #1
	FOR I = 0 TO 3
		INPUT #1, D$(I)
	NEXT
CLOSE #1

2 CLS : CH = 0: TMR = 4175: TMR1 = 6875: NB = -1: NP = -1: JX = 0: VV = 0

3 CALL TITLE
	menuItems$(1) = "CREATE AND MERGE INITIAL CAREER STAT STATS"
	menuItems$(2) = "MERGE/UPDATE CAREER STATS                 "
	menuItems$(3) = "VIEW/PRINT CAREER STATS                   "
	menuItems$(4) = "EDIT CAREER STATS                         "
	menuItems$(5) = "VIEW/PRINT TEAM CAREER LEADERS (SEASON)   "
	menuItems$(6) = "UPDATE TEAM CAREER LEADERS (CAREER)       "
	menuItems$(7) = "RETURN TO MAIN MENU                       "
	SELECTION% = 1
	Count% = 7
	Start% = 1
	SCANCODE% = 7
	FileFGColr% = 15:FileBGColr% = 1
	HiLiteFGColr% = 0:HiLiteBGColr% = 7
	Spacing% = 1
	Row% = 6
	Column% = 17
CALL box0(5, 16, 13, 59, 2, 31)
	
_MouseShow "DEFAULT"
MMenuVert menuItems$(), SELECTION%, Start%, SCANCODE%, FileFGColr%, FileBGColr%, HiLiteFGColr%, HiLiteBGColr%, Count%, Row%, Column%
_MouseHide

	COLOR , 0
	IF SCANCODE% = 27 THEN END
	I = SELECTION%
IF I = 1 THEN 1900
IF I = 2 THEN 2000
IF I = 3 THEN RUN "CARVIEW.EXE"
IF I = 4 THEN RUN "CAREDIT.EXE"
IF I = 5 THEN 3000
IF I = 6 THEN RUN "CARLDR.EXE"
IF I = 7 THEN GOSUB 993

17 CH = 1

18 '

21 IF CH = 1 THEN 1150

22 COLOR 12, 0: CLS : LOCATE 2, 5

30 COLOR 10

45 FOR J = 15 TO 18: LOCATE J: PRINT "                                                                    "

46 NEXT

47 COLOR 11: LOCATE 15, 5: INPUT "ENTER NAME OF CAREER STAT FILE (MAX. - 8 CHARACTERS)"; Z$:z$=left$(z$,8)+".car"
	FOR XX = 1 TO LEN(Z$)
	IF MID$(Z$, XX, 1) = " " THEN MID$(Z$, XX, 1) = "_"
	NEXT XX

48 LOCATE , 5: INPUT "ENTER NAME OF STAT FILE TO ADD (EX. - WASHINGT.60)"; Z1$
	IF LEN(Z1$)>11 THEN Z1$=LEFT$(Z1$,8)+RIGHT$(Z1$,3)

49 LOCATE , 5: INPUT "ENTER YEAR TO ADD (EX. - 1960)"; Y%

50 LOCATE , 5: PRINT "ANY CHANGE (YN)"
60 I$ = GetKeyPress$

70 IF UCASE$(I$) = "Y" THEN 45

75 VV = 1: LOCATE , 5: PRINT "IS THIS THE FINAL UPDATE FOR THE CURRENT SEASON? (Y/N)"
76 I$ = GetKeyPress$

77 IF UCASE$(I$) = "Y" THEN JX = 1

78 IF UCASE$(I$) <> "Y" THEN JX = 0

100 GOSUB 1000

200 LOCATE 20, 5: COLOR 15: PRINT "MERGING CAREER STATS AND UPDATING CAREER LEADER FILE . . . . PLEASE WAIT"
	IF NOT _FILEEXISTS(D$(1) + Z1$) THEN 900

220 OPEN D$(1) + Z1$ FOR INPUT AS #1

222 INPUT #1, A$: INPUT #1, W2%: INPUT #1, L2%

223 FOR I = 0 TO 22: INPUT #1, B$(I): INPUT #1, B1%(I): LOCATE 21, 35: TMR = TMR - 1: COLOR 9: PRINT USING "####"; TMR: NEXT I

224 FOR I = 0 TO 21: INPUT #1, P$(I): INPUT #1, P1%(I): LOCATE 21, 35: TMR = TMR - 1: COLOR 9: PRINT USING "####"; TMR: NEXT I

225 FOR I = 0 TO 22: FOR I1 = 0 TO 21: INPUT #1, B0%(I, I1): LOCATE 21, 35: TMR = TMR - 1: COLOR 9: PRINT USING "####"; TMR: NEXT I1: NEXT I

226 FOR I = 0 TO 21: FOR I1 = 0 TO 41: INPUT #1, P0%(I, I1): LOCATE 21, 35: TMR = TMR - 1: COLOR 9: PRINT USING "####"; TMR: NEXT I1: NEXT I

227 INPUT #1, D0%: INPUT #1, D1%
	FOR I = 0 TO 21: INPUT #1, T(I): NEXT I
	FOR I = 0 TO 22: INPUT #1, T1(I): NEXT I

265 CLOSE #1

400 FOR I = 0 TO 99

401 N = 1

402 IF B$(I) = "END" OR B$(I) = "XXX" OR B$(I) = "" THEN 404 ELSE 403

403 NB = NB + 1: GOTO 408

404 B$(I) = ""

408 FOR J = 0 TO 15: BRS%(N, I, J) = B0%(I, J)

409 NEXT J

410 BRS%(N, I, 16) = 1: BRS%(N, I, 17) = Y%

411 NEXT I

420 FOR I = 0 TO 79

421 IF P$(I) = "END" OR P$(I) = "XXX" OR P$(I) = "" THEN 424 ELSE 423

423 NP = NP + 1: GOTO 428

424 P$(I) = ""

428 FOR J = 0 TO 14: PRS%(N, I, J) = P0%(I, J)

429 NEXT J

430 PRS%(N, I, 15) = 1: PRS%(N, I, 16) = Y%

431 NEXT I

700 IF JX = 1 THEN 704

701 IF JX = 0 THEN 705

704 GOSUB 2080

705 GOSUB 1100

706 LOCATE 20, 5: COLOR 15: PRINT "MERGING CAREER STATS AND UPDATING CAREER LEADER FILE . . . . PLEASE WAIT"

707 OPEN D$(1) + Z$ FOR OUTPUT AS #1

708 WRITE #1, NB, NP

710 FOR I = 0 TO 99: WRITE #1, B$(I): NEXT

715 FOR I = 0 TO 79: WRITE #1, P$(I): NEXT

720 FOR J = 1 TO 15: FOR I = 0 TO 99: FOR I1 = O TO 17: WRITE #1, BRS%(J, I, I1): NEXT I1: LOCATE 21, 35: TMR = TMR - 1: COLOR 9: PRINT USING "####"; TMR: NEXT I: NEXT J

725 FOR J = 1 TO 15: FOR I = 0 TO 79: FOR I1 = 0 TO 16: WRITE #1, PRS%(J, I, I1): NEXT I1: LOCATE 21, 35: TMR = TMR - 1: COLOR 9: PRINT USING "####"; TMR: NEXT I: NEXT J

740 CLOSE #1

800 GOTO 2

900 CLS : COLOR 7: PRINT "UNABLE TO LOCATE STAT FILE . . . PLEASE RE-ENTER"

901 PRINT : LINE INPUT "HIT ENTER TO CONTINUE"; DUMMY$
	CALL GETKEY
	GOTO 2

993 RUN "HELLO.EXE"

1150 COLOR 12, 0: CLS : LOCATE 2, 5

1175 FOR J = 15 TO 18: LOCATE J: PRINT "                                                                     "

1176 NEXT

1177 COLOR 11
	LOCATE 15, 5
	INPUT "ENTER NAME OF CAREER STAT FILE (EX. - MINNESOT)"; Z$
	z$=left$(z$,8)+".car"
	FOR XX = 1 TO LEN(Z$)
	IF MID$(Z$, XX, 1) = " " THEN MID$(Z$, XX, 1) = "_"
	NEXT XX

1178 LOCATE , 5: INPUT "ENTER NAME OF FILE TO ADD (EX. - MINNESOT.61)"; Z1$
	IF LEN(Z1$)>11 THEN Z1$=LEFT$(Z1$,8)+RIGHT$(Z1$,3)

1179 LOCATE , 5: INPUT "ENTER YEAR TO ADD (EX. - 1961)"; Y%

1180 LOCATE , 5: PRINT "ANY CHANGE (YN)"
1181 I$ = GetKeyPress$

1182 IF UCASE$(I$) = "Y" THEN 1175

1185 VV = 0
	LOCATE , 5
	PRINT "IS THIS THE FINAL UPDATE FOR THE CURRENT SEASON? (Y/N)"
1186 I$ = GetKeyPress$
	JX = 0

1187 IF UCASE$(I$) = "Y" THEN JX = 1

1190 GOSUB 1100

1191 LOCATE 20, 5
	COLOR 15
	PRINT "LOADING CAREER LEADER FILE . . . . PLEASE WAIT"

1200 IF NOT EXIST (D$(1) + Z$) THEN 1300

1201 OPEN D$(1) + Z$ FOR INPUT AS #1

1208 INPUT #1, NB, NP

1210 FOR I = 0 TO 99: INPUT #1, B$(I): NEXT

1215 FOR I = 0 TO 79: INPUT #1, P$(I): NEXT

1220 FOR J = 1 TO 15: FOR I = 0 TO 99: FOR I1 = O TO 17: INPUT #1, BRS%(J, I, I1): NEXT I1: LOCATE 21, 35: TMR1 = TMR1 - 1: COLOR 9: PRINT USING "####"; TMR1: NEXT I: NEXT J

1225 FOR J = 1 TO 15: FOR I = 0 TO 79: FOR I1 = 0 TO 16: INPUT #1, PRS%(J, I, I1): NEXT I1: LOCATE 21, 35: TMR1 = TMR1 - 1: COLOR 9: PRINT USING "####"; TMR1: NEXT I: NEXT J

1265 CLOSE #1

1300 GOSUB 1000

1305 LOCATE 20, 5
	COLOR 15
	PRINT "LOADING STATS FILE . . . . PLEASE WAIT"
	IF NOT EXIST (D$(1) + Z1$) THEN 900

1320 OPEN D$(1) + Z1$ FOR INPUT AS #1

1322 INPUT #1, A$: INPUT #1, W2%: INPUT #1, L2%

1323 FOR I = 0 TO 22: INPUT #1, BR$(I): INPUT #1, B1%(I): LOCATE 21, 35: TMR = TMR - 1: COLOR 9: PRINT USING "####"; TMR: NEXT I

1324 FOR I = 0 TO 21: INPUT #1, PR$(I): INPUT #1, P1%(I): LOCATE 21, 35: TMR = TMR - 1: COLOR 9: PRINT USING "####"; TMR: NEXT I

1325 FOR I = 0 TO 22: FOR I1 = 0 TO 21: INPUT #1, B0%(I, I1): LOCATE 21, 35: TMR = TMR - 1: COLOR 9: PRINT USING "####"; TMR: NEXT I1: NEXT I

1326 FOR I = 0 TO 21: FOR I1 = 0 TO 41: INPUT #1, P0%(I, I1): LOCATE 21, 35: TMR = TMR - 1: COLOR 9: PRINT USING "####"; TMR: NEXT I1: NEXT I

1327 INPUT #1, D0%: INPUT #1, D1%
	FOR I = 0 TO 21: INPUT #1, T(I): NEXT I
	FOR I = 0 TO 22: INPUT #1, T1(I): NEXT I

1365 CLOSE #1

1400 FOR I = 0 TO 22

1408 RR = 0: CHK = 0

1409 FOR J = 0 TO 99

1410 IF UCASE$(BR$(I)) = UCASE$(B$(J)) THEN 1411 ELSE 1423

1411 FOR W = 1 TO 15: IF BRS%(W, J, 17) = Y% THEN 1412 ELSE 1413

1412 CHK = CHK + 1

1413 NEXT W

1414 IF CHK > 0 THEN 1418 ELSE 1419

1418 N = BRS%(1, J, 16) + BRS%(2, J, 16) + BRS%(3, J, 16) + BRS%(4, J, 16) + BRS%(5, J, 16) + BRS%(6, J, 16) + BRS%(7, J, 16) + BRS%(8, J, 16) + BRS%(9, J, 16) + BRS%(10, J, 16) + BRS%(11, J, 16) + BRS%(12, J, 16) + BRS%(13, J, 16) + BRS%(14, J, 16) _
+ BRS%(15, J, 16): GOTO 1420

1419 N = BRS%(1, J, 16) + BRS%(2, J, 16) + BRS%(3, J, 16) + BRS%(4, J, 16) + BRS%(5, J, 16) + BRS%(6, J, 16) + BRS%(7, J, 16) + BRS%(8, J, 16) + BRS%(9, J, 16) + BRS%(10, J, 16) + BRS%(11, J, 16) + BRS%(12, J, 16) + BRS%(13, J, 16) + BRS%(14, J, 16) _
+ BRS%(15, J, 16) + 1

1420 FOR K = 0 TO 15: BRS%(N, J, K) = B0%(I, K): NEXT K

1421 BRS%(N, J, 16) = 1: BRS%(N, J, 17) = Y%

1422 GOTO 1430

1423 RR = RR + 1

1424 IF RR = 100 THEN GOSUB 1450

1425 NEXT J

1430 NEXT I

1431 GOTO 1500

1450 IF BR$(I) = "END" OR BR$(I) = "XXX" OR BR$(I) = "" THEN 1456 ELSE 1451

1451 NB = NB + 1

1452 B$(NB) = BR$(I)

1453 N = 1

1454 FOR K = 0 TO 15: BRS%(N, NB, K) = B0%(I, K): NEXT

1455 BRS%(N, NB, 16) = 1: BRS%(N, NB, 17) = Y%

1456 RETURN

1500 FOR I = 0 TO 21

1508 RRP = 0: CHK = 0

1509 FOR J = 0 TO 79

1510 IF UCASE$(PR$(I)) = UCASE$(P$(J)) THEN 1511 ELSE 1523

1511 FOR W = 1 TO 15: IF PRS%(W, J, 16) = Y% THEN 1512 ELSE 1513

1512 CHK = CHK + 1

1513 NEXT W

1514 IF CHK > 0 THEN 1518 ELSE 1519

1518 N = PRS%(1, J, 15) + PRS%(2, J, 15) + PRS%(3, J, 15) + PRS%(4, J, 15) + PRS%(5, J, 15) + PRS%(6, J, 15) + PRS%(7, J, 15) + PRS%(8, J, 15) + PRS%(9, J, 15) + PRS%(10, J, 15) + PRS%(11, J, 15) + PRS%(12, J, 15) + PRS%(13, J, 15) + PRS%(14, J, 15) _
+ PRS%(15, J, 15): GOTO 1520

1519 N = PRS%(1, J, 15) + PRS%(2, J, 15) + PRS%(3, J, 15) + PRS%(4, J, 15) + PRS%(5, J, 15) + PRS%(6, J, 15) + PRS%(7, J, 15) + PRS%(8, J, 15) + PRS%(9, J, 15) + PRS%(10, J, 15) + PRS%(11, J, 15) + PRS%(12, J, 15) + PRS%(13, J, 15) + PRS%(14, J, 15) _
+ PRS%(15, J, 15) + 1

1520 FOR K = 0 TO 14: PRS%(N, J, K) = P0%(I, K): NEXT K

1521 PRS%(N, J, 15) = 1: PRS%(N, J, 16) = Y%

1522 GOTO 1530

1523 RRP = RRP + 1

1524 IF RRP = 80 THEN GOSUB 1550

1525 NEXT J

1530 NEXT I

1531 GOTO 1700

1550 IF PR$(I) = "END" OR PR$(I) = "XXX" OR PR$(I) = "" THEN 1556 ELSE 1551

1551 NP = NP + 1

1552 P$(NP) = PR$(I)

1553 N = 1

1554 FOR K = 0 TO 14: PRS%(N, NP, K) = P0%(I, K): NEXT

1555 PRS%(N, NP, 15) = 1: PRS%(N, NP, 16) = Y%

1556 RETURN

1700 IF JX = 1 THEN 1704

1701 IF JX = 0 THEN 1705

1704 GOSUB 2080

1705 GOSUB 1100

1706 LOCATE 20, 5: COLOR 15: PRINT "MERGING CAREER STATS AND UPDATING CAREER LEADER FILE . . . . PLEASE WAIT"

1707 OPEN D$(1) + Z$ FOR OUTPUT AS #1

1708 WRITE #1, NB, NP

1710 FOR I = 0 TO 99: WRITE #1, B$(I): NEXT

1715 FOR I = 0 TO 79: WRITE #1, P$(I): NEXT

1720 FOR J = 1 TO 15: FOR I = 0 TO 99: FOR I1 = O TO 17: WRITE #1, BRS%(J, I, I1): NEXT I1: LOCATE 21, 35: TMR1 = TMR1 - 1: COLOR 9: PRINT USING "####"; TMR1: NEXT I: NEXT J

1725 FOR J = 1 TO 15: FOR I = 0 TO 79: FOR I1 = 0 TO 16: WRITE #1, PRS%(J, I, I1): NEXT I1: LOCATE 21, 35: TMR1 = TMR1 - 1: COLOR 9: PRINT USING "####"; TMR1: NEXT I: NEXT J

1740 CLOSE #1

1800 GOTO 2

1900 CLS : COLOR 14: LOCATE 5, 27: PRINT " - - - C A U T I O N - - -"

1901 COLOR 15: LOCATE 8, 18: PRINT "THIS OPTION SHOULD ONLY BE USED WHEN CREATING"

1902 LOCATE , 18: PRINT "AND MERGING THE INITIAL STAT FILE.  IF YOU ARE"

1903 LOCATE , 18: PRINT "ADDING AN ADDITIONAL YEAR TO AN EXISTING FILE,"

1904 LOCATE , 18: PRINT "            USE OPTION #2."

1905 PRINT : PRINT : PRINT

1906 COLOR 12: LOCATE , 25: PRINT "DO YOU WISH TO CONTINUE? (Y/N)"
1907 I$ = GetKeyPress$

1908 IF UCASE$(I$) = "Y" THEN GOTO 18

1909 IF UCASE$(I$) = "N" THEN GOTO 2

1910 IF UCASE$(I$) <> "Y" OR UCASE$(I$) <> "N" THEN 1907

2000 CLS : COLOR 14: LOCATE 5, 27: PRINT "- - - C A U T I O N - - -"

2001 COLOR 15: LOCATE 8, 8: PRINT "THIS OPTION SHOULD ONLY BE USED WHEN ADDING YEARS TO AN EXISTING STAT"

2002 PRINT "FILE.  IF YOU ARE CREATING A NEW CAREER FILE, USE OPTION #1.  IF YOU ARE ADDING"

2003 PRINT "AN ADDITIONAL CAREER YEAR, MAKE SURE THAT ANY UNUSED PLAYER SLOTS (XXX, END,"

2006 PRINT "ETC.) ARE AT THE END OF THE SEASON STAT LIST BEFORE YOU MERGE."

2007 LOCATE , 8: PRINT "ALSO MAKE SURE THAT THE PLAYERS NAMES IN THE FILE YOU ARE ADDING, MATCH"

2009 PRINT "THE EXACT SPELLING OF THE NAME OF THE SAME PLAYER IN THE CAREER FILE FOR THE"

2011 PRINT "PLAYERS THAT HAD PLAYED IN PREVIOUS YEARS.  EXAMPLE - IF BILLY WILLIAMS IS"

2012 PRINT "LISTED AS 'WILLIAMS' IN THE CAREER FILE AND THE SEASON STATS HAD HIM AS"

2013 PRINT "'B.WILLIAMS', HE SHOULD BE CHANGED TO 'WILLIAMS' IN THE SEASON FILE BEFORE"

2014 PRINT "MERGING, OR YOU COULD CHANGE HIM TO 'B.WILLIAMS' IN THE CAREER FILE BY USING"

2015 PRINT "THE MODIFY REPLAY STATS OPTION FROM THE MAIN MENU."

2016 PRINT : PRINT

2017 COLOR 12: LOCATE , 25: PRINT "DO YOU WISH TO CONTINUE? (Y/N)"
2018 I$ = GetKeyPress$

2019 IF UCASE$(I$) = "Y" THEN 17

2020 GOTO 2

2080 GOSUB 5000
	IF NOT EXIST (D$(1) + LEFT$(Z$, JX) + ".CLD") THEN 2100
OPEN D$(1) + LEFT$(Z$, JX) + ".CLD" FOR INPUT AS #1
	FOR I = 0 TO 14: INPUT #1, BLYR(I), BL$(I), BLL(I): NEXT
	FOR I = 0 TO 14: INPUT #1, PLYR(I), PL$(I), PLL(I): NEXT
CLOSE #1

2100 FOR I = 0 TO 99

2101 IF B$(I) = "" OR B$(I) = "XXX" OR B$(I) = "END" THEN 2300

2102 FOR J = 1 TO 15
	IF BRS%(J, I, 17) = 0 THEN 2250 ELSE 2103

2103 IF BRS%(J, I, 0) > BLL(0) THEN 2104 ELSE 2113

2104 BLL(0) = BRS%(J, I, 0): BL$(0) = B$(I): BLYR(0) = BRS%(J, I, 17)

2113 IF BRS%(J, I, 2) > BLL(1) THEN 2114 ELSE 2123

2114 BLL(1) = BRS%(J, I, 2): BL$(1) = B$(I): BLYR(1) = BRS%(J, I, 17)

2123 IF BRS%(J, I, 1) > BLL(2) THEN 2124 ELSE 2133

2124 BLL(2) = BRS%(J, I, 1): BL$(2) = B$(I): BLYR(2) = BRS%(J, I, 17)

2133 IF BRS%(J, I, 4) > BLL(3) THEN 2134 ELSE 2143

2134 BLL(3) = BRS%(J, I, 4): BL$(3) = B$(I): BLYR(3) = BRS%(J, I, 17)

2143 IF BRS%(J, I, 5) > BLL(4) THEN 2144 ELSE 2153

2144 BLL(4) = BRS%(J, I, 5): BL$(4) = B$(I): BLYR(4) = BRS%(J, I, 17)

2153 IF BRS%(J, I, 6) > BLL(5) THEN 2154 ELSE 2163

2154 BLL(5) = BRS%(J, I, 6): BL$(5) = B$(I): BLYR(5) = BRS%(J, I, 17)

2163 IF BRS%(J, I, 3) > BLL(6) THEN 2164 ELSE 2173

2164 BLL(6) = BRS%(J, I, 3): BL$(6) = B$(I): BLYR(6) = BRS%(J, I, 17)

2173 IF BRS%(J, I, 7) > BLL(7) THEN 2174 ELSE 2183

2174 BLL(7) = BRS%(J, I, 7): BL$(7) = B$(I): BLYR(7) = BRS%(J, I, 17)

2183 IF BRS%(J, I, 8) > BLL(8) THEN 2184 ELSE 2193

2184 BLL(8) = BRS%(J, I, 8): BL$(8) = B$(I): BLYR(8) = BRS%(J, I, 17)

2193 IF BRS%(J, I, 9) > BLL(9) THEN 2194 ELSE 2203

2194 BLL(9) = BRS%(J, I, 9): BL$(9) = B$(I): BLYR(9) = BRS%(J, I, 17)

2203 IF BRS%(J, I, 10) > BLL(10) THEN 2204 ELSE 2213

2204 BLL(10) = BRS%(J, I, 10): BL$(10) = B$(I): BLYR(10) = BRS%(J, I, 17)

2213 IF BRS%(J, I, 11) > BLL(11) THEN 2214 ELSE 2223

2214 BLL(11) = BRS%(J, I, 11): BL$(11) = B$(I): BLYR(11) = BRS%(J, I, 17)

2223 IF BRS%(J, I, 0) + BRS%(J, I, 7) > 501 THEN 2224 ELSE 2233

2224 AVG = BRS%(J, I, 1) / BRS%(J, I, 0)

2225 IF AVG > BLL(12) THEN 2226 ELSE 2233

2226 BLL(12) = AVG: BL$(12) = B$(I): BLYR(12) = BRS%(J, I, 17)

2233 IF BRS%(J, I, 0) + BRS%(J, I, 7) > 501 THEN 2234 ELSE 2243

2234 SLG = (BRS%(J, I, 1) + BRS%(J, I, 4) + BRS%(J, I, 5) * 2 + BRS%(J, I, 6) * 3) / BRS%(J, I, 0)

2235 IF SLG > BLL(13) THEN 2236 ELSE 2243

2236 BLL(13) = SLG: BL$(13) = B$(I): BLYR(13) = BRS%(J, I, 17)

2243 IF BRS%(J, I, 0) + BRS%(J, I, 7) > 501 THEN 2244 ELSE 2250

2244 OBP = (BRS%(J, I, 1) + BRS%(J, I, 7)) / (BRS%(J, I, 7) + BRS%(J, I, 0))

2245 IF OBP > BLL(14) THEN 2246 ELSE 2250

2246 BLL(14) = OBP: BL$(14) = B$(I): BLYR(14) = BRS%(J, I, 17)

2250 NEXT J

2300 NEXT I

2400 FOR I = 0 TO 79

2401 IF P$(I) = "" OR P$(I) = "XXX" OR P$(I) = "END" THEN 2600

2402 FOR J = 1 TO 15
	IF PRS%(J, I, 16) = 0 THEN 2550 ELSE 2403

2403 IF PRS%(J, I, 6) > PLL(0) THEN 2404 ELSE 2413

2404 PLL(0) = PRS%(J, I, 6): PL$(0) = P$(I): PLYR(0) = PRS%(J, I, 16)

2413 IF PRS%(J, I, 7) > PLL(1) THEN 2414 ELSE 2423

2414 PLL(1) = PRS%(J, I, 7): PL$(1) = P$(I): PLYR(1) = PRS%(J, I, 16)

2423 IF PRS%(J, I, 12) > PLL(2) THEN 2424 ELSE 2433

2424 PLL(2) = PRS%(J, I, 12): PL$(2) = P$(I): PLYR(2) = PRS%(J, I, 16)

2433 IF PRS%(J, I, 0) / 3 > PLL(3) THEN 2434 ELSE 2443

2434 PLL(3) = PRS%(J, I, 0) / 3: PL$(3) = P$(I): PLYR(3) = PRS%(J, I, 16)

2443 IF PRS%(J, I, 1) > PLL(4) THEN 2444 ELSE 2453

2444 PLL(4) = PRS%(J, I, 1): PL$(4) = P$(I): PLYR(4) = PRS%(J, I, 16)

2453 IF PRS%(J, I, 4) > PLL(5) THEN 2454 ELSE 2463

2454 PLL(5) = PRS%(J, I, 4): PL$(5) = P$(I): PLYR(5) = PRS%(J, I, 16)

2463 IF PRS%(J, I, 5) > PLL(6) THEN 2464 ELSE 2473

2464 PLL(6) = PRS%(J, I, 5): PL$(6) = P$(I): PLYR(6) = PRS%(J, I, 16)

2473 IF PRS%(J, I, 0) / 3 > 162 THEN 2474 ELSE 2483

2474 EV = (PRS%(J, I, 3) * 9) / (PRS%(J, I, 0) / 3)

2475 IF PLL(7) = 0 THEN PLL(7) = 1000

2476 IF EV < PLL(7) THEN 2477 ELSE 2483

2477 PLL(7) = EV: PL$(7) = P$(I): PLYR(7) = PRS%(J, I, 16)

2483 IF PRS%(J, I, 8) > PLL(8) THEN 2484 ELSE 2493

2484 PLL(8) = PRS%(J, I, 8): PL$(8) = P$(I): PLYR(8) = PRS%(J, I, 16)

2493 IF PRS%(J, I, 10) > PLL(9) THEN 2494 ELSE 2503

2494 PLL(9) = PRS%(J, I, 10): PL$(9) = P$(I): PLYR(9) = PRS%(J, I, 16)

2503 IF PRS%(J, I, 2) > PLL(10) THEN 2504 ELSE 2513

2504 PLL(10) = PRS%(J, I, 2): PL$(10) = P$(I): PLYR(10) = PRS%(J, I, 16)

2513 IF PRS%(J, I, 3) > PLL(11) THEN 2514 ELSE 2523

2514 PLL(11) = PRS%(J, I, 3): PL$(11) = P$(I): PLYR(11) = PRS%(J, I, 16)

2523 IF PRS%(J, I, 11) > PLL(12) THEN 2524 ELSE 2533

2524 PLL(12) = PRS%(J, I, 11): PL$(12) = P$(I): PLYR(12) = PRS%(J, I, 16)

2533 IF PRS%(J, I, 14) > PLL(13) THEN 2534 ELSE 2543

2534 PLL(13) = PRS%(J, I, 14): PL$(13) = P$(I): PLYR(13) = PRS%(J, I, 16)

2543 IF PRS%(J, I, 13) > PLL(14) THEN 2544 ELSE 2550

2544 PLL(14) = PRS%(J, I, 13): PL$(14) = P$(I): PLYR(14) = PRS%(J, I, 16)

2550 NEXT J

2600 NEXT I

2800 GOSUB 5000
OPEN D$(1) + LEFT$(Z$, JX) + ".CLD" FOR OUTPUT AS #1

2811 FOR I = 0 TO 14: WRITE #1, BLYR(I), BL$(I), BLL(I): NEXT

2812 FOR I = 0 TO 14: WRITE #1, PLYR(I), PL$(I), PLL(I): NEXT

2813 CLOSE #1

2900 RETURN

3000 CLS
	Spec$ = D$(2) + "*.CLD"
	null$ = READDIR$(Spec$) 'use a file spec ONCE to find the last file name listed
	Count% = DirCount%
	IF Count% = 0 THEN 4500
	REDIM F$(0 TO Count%)
	FOR X = 1 TO Count%
	  F$(X) = SPACE$(12)
	NEXT
	F$(0) = Spec$
	CALL ReadFile(F$())
	'CALL SortStr(VARPTR(F$(1)), Count, 0)

1310 CLS
	COLOR , 1
	CLS
	LOCATE , 28
	COLOR 14
	PRINT "SELECT LEADERS TO VIEW": COLOR 15
	SELECTION% = 1
	Start% = 1
	FileFGColr% = 15:FileBGColr% = 1
	HiLiteFGColr% = 0:HiLiteBGColr% = 7
	Rows% = 20
	Columns% = 4
	Spacing% = 6
	Row% = 4
	Column% = 1
	LOCATE 25, 1
	COLOR 14
	PRINT "ENTER"; : COLOR 15
	PRINT "-SELECTS TEAM";

_MouseShow "DEFAULT"
MAMenu F$(), SELECTION%, Start%, Count%, ExitCode%, FileFGColr%, FileBGColr%, HiLiteFGColr%, HiLiteBGColr%, Rows%, Columns%, Spacing%, Row%, Column%
_MouseHide

	IF ExitCode% = 27 THEN 2
	F$ = F$(SELECTION%)
	LOCATE 2, 33: PRINT F$
LOCATE , 33: PRINT "ANY CHANGE (YN)";
	COLOR 15, 0
3910 I$ = GetKeyPress$
	IF UCASE$(I$) = "Y" THEN 1310

3911 ZZ$ = RTrim$(F$)

3100 OPEN D$(1) + ZZ$ FOR INPUT AS #1
	FOR I = 0 TO 14: INPUT #1, BLYR(I), BL$(I), BLL(I): NEXT
	FOR I = 0 TO 14: INPUT #1, PLYR(I), PL$(I), PLL(I): NEXT
CLOSE #1

3150 LOCATE 15, 10: COLOR 12: PRINT "V"; : COLOR 7: PRINT "IEW OR "; : COLOR 12: PRINT "P"; : COLOR 7: PRINT "RINT"
3151 I$ = GetKeyPress$

3153 IF UCASE$(I$) = "P" THEN 3500

3200 CLS

3250 COLOR 12: PRINT "CATEGORY           RECORD           PLAYER              YEAR"

3251 PRINT

3252 COLOR 3: PRINT "AT BATS"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(0); : PRINT TAB(37); BL$(0); : PRINT TAB(56); BLYR(0)

3253 COLOR 3: PRINT "RUNS SCORED"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(1); : PRINT TAB(37); BL$(1); : PRINT TAB(56); BLYR(1)

3254 COLOR 3: PRINT "HITS"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(2); : PRINT TAB(37); BL$(2); : PRINT TAB(56); BLYR(2)

3255 COLOR 3: PRINT "DOUBLES"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(3); : PRINT TAB(37); BL$(3); : PRINT TAB(56); BLYR(3)

3256 COLOR 3: PRINT "TRIPLES"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(4); : PRINT TAB(37); BL$(4); : PRINT TAB(56); BLYR(4)

3257 COLOR 3: PRINT "HOME RUNS"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(5); : PRINT TAB(37); BL$(5); : PRINT TAB(56); BLYR(5)

3258 COLOR 3: PRINT "RUNS BATTED IN"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(6); : PRINT TAB(37); BL$(6); : PRINT TAB(56); BLYR(6)

3259 COLOR 3: PRINT "WALKS"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(7); : PRINT TAB(37); BL$(7); : PRINT TAB(56); BLYR(7)

3260 COLOR 3: PRINT "STRIKEOUTS"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(8); : PRINT TAB(37); BL$(8); : PRINT TAB(56); BLYR(8)

3261 COLOR 3: PRINT "STEALS"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(9); : PRINT TAB(37); BL$(9); : PRINT TAB(56); BLYR(9)

3262 COLOR 3: PRINT "CAUGHT STEALING"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(10); : PRINT TAB(37); BL$(10); : PRINT TAB(56); BLYR(10)

3263 COLOR 3: PRINT "ERRORS"; : COLOR 7: PRINT TAB(23); USING "###"; BLL(11); : PRINT TAB(37); BL$(11); : PRINT TAB(56); BLYR(11)

3264 COLOR 3: PRINT "BATTING AVERAGE"; : COLOR 7: PRINT TAB(22); USING ".###"; BLL(12); : PRINT TAB(37); BL$(12); : PRINT TAB(56); BLYR(12)

3265 COLOR 3: PRINT "SLUGGING PCT."; : COLOR 7: PRINT TAB(22); USING ".###"; BLL(13); : PRINT TAB(37); BL$(13); : PRINT TAB(56); BLYR(13)

3266 COLOR 3: PRINT "ON BASE PCT."; : COLOR 7: PRINT TAB(22); USING ".###"; BLL(14); : PRINT TAB(37); BL$(14); : PRINT TAB(56); BLYR(14)

3270 COLOR 15: LOCATE 22: PRINT "HIT ANY KEY TO CONTINUE"
3271 I$ = GetKeyPress$

3300 CLS

3350 COLOR 12: PRINT "CATEGORY           RECORD           PLAYER              YEAR"

3351 PRINT

3352 COLOR 3: PRINT "WINS"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(0); : PRINT TAB(37); PL$(0); : PRINT TAB(56); PLYR(0)

3353 COLOR 3: PRINT "LOSSES"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(1); : PRINT TAB(37); PL$(1); : PRINT TAB(56); PLYR(1)

3354 COLOR 3: PRINT "SAVES"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(2); : PRINT TAB(37); PL$(2); : PRINT TAB(56); PLYR(2)

3355 COLOR 3: PRINT "INNINGS PITCHED"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(3); :
	IF PLL(3) - (INT(PLL(3) / 3) * 3) > 0 THEN PRINT "."; : PRINT USING "#"; PLL(3) - (INT(PLL(3) / 3) * 3); :
	PRINT TAB(37); PL$(3); : PRINT TAB(56); PLYR(3)

3356 COLOR 3: PRINT "HITS ALLOWED"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(4); : PRINT TAB(37); PL$(4); : PRINT TAB(56); PLYR(4)

3357 COLOR 3: PRINT "WALKS"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(5); : PRINT TAB(37); PL$(5); : PRINT TAB(56); PLYR(5)

3358 COLOR 3: PRINT "STRIKOUTS"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(6); : PRINT TAB(37); PL$(6); : PRINT TAB(56); PLYR(6)

3359 COLOR 3: PRINT "EARNED RUN AVERAGE"; : COLOR 7: PRINT TAB(22); USING "#.##"; PLL(7); : PRINT TAB(37); PL$(7); : PRINT TAB(56); PLYR(7)

3360 COLOR 3: PRINT "GAMES"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(8); : PRINT TAB(37); PL$(8); : PRINT TAB(56); PLYR(8)

3361 COLOR 3: PRINT "COMPLETE GAMES"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(9); : PRINT TAB(37); PL$(9); : PRINT TAB(56); PLYR(9)

3362 COLOR 3: PRINT "RUNS ALLOWED"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(10); : PRINT TAB(37); PL$(10); : PRINT TAB(56); PLYR(10)

3363 COLOR 3: PRINT "EARNED RUNS ALLOWED"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(11); : PRINT TAB(37); PL$(11); : PRINT TAB(56); PLYR(11)

3364 COLOR 3: PRINT "SHUTOUTS"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(12); : PRINT TAB(37); PL$(12); : PRINT TAB(56); PLYR(12)

3365 COLOR 3: PRINT "HOME RUNS ALLOWED"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(13); : PRINT TAB(37); PL$(13); : PRINT TAB(56); PLYR(13)

3366 COLOR 3: PRINT "DOUBLE PLAYS"; : COLOR 7: PRINT TAB(23); USING "###"; PLL(14); : PRINT TAB(37); PL$(14); : PRINT TAB(56); PLYR(14)

3390 COLOR 15: LOCATE 22: PRINT "VIEW AGAIN (Y/N)"
3391 I$ = GetKeyPress$

3392 IF UCASE$(I$) = "Y" THEN 3200

3393 GOTO 2

3500 LPRINT "CATEGORY           RECORD           PLAYER              YEAR"

3551 LPRINT

3552 LPRINT "AT BATS"; : LPRINT TAB(23); USING "###"; BLL(0); : LPRINT TAB(37); BL$(0); : LPRINT TAB(56); BLYR(0)

3553 LPRINT "RUNS SCORED"; : LPRINT TAB(23); USING "###"; BLL(1); : LPRINT TAB(37); BL$(1); : LPRINT TAB(56); BLYR(1)

3554 LPRINT "HITS"; : LPRINT TAB(23); USING "###"; BLL(2); : LPRINT TAB(37); BL$(2); : LPRINT TAB(56); BLYR(2)

3555 LPRINT "DOUBLES"; : LPRINT TAB(23); USING "###"; BLL(3); : LPRINT TAB(37); BL$(3); : LPRINT TAB(56); BLYR(3)

3556 LPRINT "TRIPLES"; : LPRINT TAB(23); USING "###"; BLL(4); : LPRINT TAB(37); BL$(4); : LPRINT TAB(56); BLYR(4)

3557 LPRINT "HOME RUNS"; : LPRINT TAB(23); USING "###"; BLL(5); : LPRINT TAB(37); BL$(5); : LPRINT TAB(56); BLYR(5)

3558 LPRINT "RUNS BATTED IN"; : LPRINT TAB(23); USING "###"; BLL(6); : LPRINT TAB(37); BL$(6); : LPRINT TAB(56); BLYR(6)

3559 LPRINT "WALKS"; : LPRINT TAB(23); USING "###"; BLL(7); : LPRINT TAB(37); BL$(7); : LPRINT TAB(56); BLYR(7)

3560 LPRINT "STRIKEOUTS"; : LPRINT TAB(23); USING "###"; BLL(8); : LPRINT TAB(37); BL$(8); : LPRINT TAB(56); BLYR(8)

3561 LPRINT "STEALS"; : LPRINT TAB(23); USING "###"; BLL(9); : LPRINT TAB(37); BL$(9); : LPRINT TAB(56); BLYR(9)

3562 LPRINT "CAUGHT STEALING"; : LPRINT TAB(23); USING "###"; BLL(10); : LPRINT TAB(37); BL$(10); : LPRINT TAB(56); BLYR(10)

3563 LPRINT "ERRORS"; : LPRINT TAB(23); USING "###"; BLL(11); : LPRINT TAB(37); BL$(11); : LPRINT TAB(56); BLYR(11)

3564 LPRINT "BATTING AVERAGE"; : LPRINT TAB(22); USING ".###"; BLL(12); : LPRINT TAB(37); BL$(12); : LPRINT TAB(56); BLYR(12)

3565 LPRINT "SLUGGING PCT."; : LPRINT TAB(22); USING ".###"; BLL(13); : LPRINT TAB(37); BL$(13); : LPRINT TAB(56); BLYR(13)

3566 LPRINT "ON BASE PCT."; : LPRINT TAB(22); USING ".###"; BLL(14); : LPRINT TAB(37); BL$(14); : LPRINT TAB(56); BLYR(14)

3652 LPRINT "WINS"; : LPRINT TAB(23); USING "###"; PLL(0); : LPRINT TAB(37); PL$(0); : LPRINT TAB(56); PLYR(0)

3653 LPRINT "LOSSES"; : LPRINT TAB(23); USING "###"; PLL(1); : LPRINT TAB(37); PL$(1); : LPRINT TAB(56); PLYR(1)

3654 LPRINT "SAVES"; : LPRINT TAB(23); USING "###"; PLL(2); : LPRINT TAB(37); PL$(2); : LPRINT TAB(56); PLYR(2)

3655 LPRINT "INNINGS PITCHED"; : LPRINT TAB(23); USING "###"; PLL(3); :
	IF PLL(3) - (INT(PLL(3) / 3) * 3) > 0 THEN LPRINT "."; : LPRINT USING "#"; PLL(3) - (INT(PLL(3) / 3) * 3); :
	LPRINT TAB(37); PL$(3); : LPRINT TAB(56); PLYR(3)

3656 LPRINT "HITS ALLOWED"; : LPRINT TAB(23); USING "###"; PLL(4); : LPRINT TAB(37); PL$(4); : LPRINT TAB(56); PLYR(4)

3657 LPRINT "WALKS"; : LPRINT TAB(23); USING "###"; PLL(5); : LPRINT TAB(37); PL$(5); : LPRINT TAB(56); PLYR(5)

3658 LPRINT "STRIKOUTS"; : LPRINT TAB(23); USING "###"; PLL(6); : LPRINT TAB(37); PL$(6); : LPRINT TAB(56); PLYR(6)

3659 LPRINT "EARNED RUN AVERAGE"; : LPRINT TAB(22); USING "#.##"; PLL(7); : LPRINT TAB(37); PL$(7); : LPRINT TAB(56); PLYR(7)

3660 LPRINT "GAMES"; : LPRINT TAB(23); USING "###"; PLL(8); : LPRINT TAB(37); PL$(8); : LPRINT TAB(56); PLYR(8)

3661 LPRINT "COMPLETE GAMES"; : LPRINT TAB(23); USING "###"; PLL(9); : LPRINT TAB(37); PL$(9); : LPRINT TAB(56); PLYR(9)

3662 LPRINT "RUNS ALLOWED"; : LPRINT TAB(23); USING "###"; PLL(10); : LPRINT TAB(37); PL$(10); : LPRINT TAB(56); PLYR(10)

3663 LPRINT "EARNED RUNS ALLOWED"; : LPRINT TAB(23); USING "###"; PLL(11); : LPRINT TAB(37); PL$(11); : LPRINT TAB(56); PLYR(11)

3664 LPRINT "SHUTOUTS"; : LPRINT TAB(23); USING "###"; PLL(12); : LPRINT TAB(37); PL$(12); : LPRINT TAB(56); PLYR(12)

3665 LPRINT "HOME RUNS ALLOWED"; : LPRINT TAB(23); USING "###"; PLL(13); : LPRINT TAB(37); PL$(13); : LPRINT TAB(56); PLYR(13)

3666 LPRINT "DOUBLE PLAYS"; : LPRINT TAB(23); USING "###"; PLL(14); : LPRINT TAB(37); PL$(14); : LPRINT TAB(56); PLYR(14)

3670 LPRINT CHR$(12)

3692 GOTO 2

5000 D = 0

5001 FOR J = 0 TO 8

5002 D = D + 1

5003 X$ = MID$(Z$, D, 1)

5004 IF X$ = "." THEN JX = D - 1

5005 NEXT J

5006 RETURN

4500 LOCATE 10, 8
	CALL CSMsgBox("NO CAREER LEADER FILES WERE FOUND... PRESS ANY KEY TO RETURN TO MAIN MENU", 26, Pass)
	I$ = GetKeyPress$
	CALL CSMsgBox("", 0, Pass)
	GOTO 2


'------------------------------
'      TITLE Subroutine
'------------------------------
' Displays window title / game copyright
SUB TITLE ()
COLOR , 0: KEY OFF: CLS
	COLOR , 1: LOCATE 1, 1: PRINT TAB(80); : LOCATE , 30: COLOR 12
	PRINT "FULL COUNT BASEBALL 6.0"
	LOCATE 24, 1: PRINT TAB(80); : LOCATE , 1
	PRINT "(C) LANCE HAFFNER/SHANNON LYNN 1987-1994"; TAB(70); LEFT$(TIME$, 5);
	LOCATE 3, 1: COLOR 2, 0
	COLOR 15: PRINT "        PROGRAMMED AND DEVELOPED BY LANCE HAFFNER AND SHANNON LYNN"
	  PRINT "              FOR TECHNICAL SUPPORT, CALL (615) 366-8088"
	COLOR 10
END SUB

'$INCLUDE: 'KeyInput.BM'
'$INCLUDE: 'QPProEqu.BM'
