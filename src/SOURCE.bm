'----------------------------------------
'            SOURCE Subroutine
'----------------------------------------
'This subroutine serves as the main "source"
'for the action in the Baseball game. This
'can be considered the equivalent of the
'COLHOOP / PROHOOP / FOOTBALL routines For
'other games. This name is the original one
'given, but may be changed to BASEBALL at
'some point in the near future (obviously).
Sub SOURCE ()

    'Declare all variables for the modules
    Dim F1$(10)
    Dim PH%(0 To 22, 0 To 1)

    Shared grounderDir$()

    Shared triplePlayAdj(), SU()

    VV(0)  = 1 : VV(1)  = 1
    VV1(1) = 9 : VV1(1) = 9
    Call HITTINGLINES

    Call PITSTAM(0) : Call PITSTAM(1)

    ' DumpBatters
    ' DumpPitchers
    ' DumpMgr

    If useVGA = 1 Then Call LOADSCREEN

LStart: '
    DumpAll
    Print #11, "---"
    Print #11, "LStart possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)

    '-- An error comes up every so many games
    '-- when playerX%(D, POS_P) gets a negative value
    '-- Nothing in the the code modifies playerX%()
    '-- between here and when it is corrupted.
    '-- Here, we save the non-negative value
    '-- so we can restore after it's corrupted.
    b9d1 = playerX%(D, POS_P)
    b9d2 = playerX%(D, POS_C)

    Erase nbrOuts
    Erase gameBaserunners%, B1%

    F% = 0
    runnerHeld = 0
    baseRunners% = BASE_EMPTY

    L0%(P) = L0%(P) + MO
    MO = 0

    If P = 1 Then
        INNING% = INNING% + 1
        Erase CZ%
    End If

    'Switch posession
    P = 1 - P
    D = 1 - P
    DumpAll
    Print #11, "---"
    Print #11, "Source 54 -- SWITCHED possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "Source 54 -- playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "Source 54 -- gameScore ="; gameScore(0,0); gameScore(1,0)

    If INNING% = 7 And teamRat_GAME(1, 13) = 8 And P = 1 And Val(Left$(gameTeams$(1), 2)) > 75 Then
        Call WINDEX
        Call PBP("ALL RIGHT..."): Call PBP("LEMME HEAR YA..."): Call PBP("A ONE, A TWO...")
    End If

    'Check scores / innings
    '------------------------------
    If INNING% > 9 And D = 1 And gameScore(1, 0) <> gameScore(0, 0) Or INNING% = 28 Or INNING% >= 9 And P = 1 And gameScore(P, 0) - gameScore(D, 0) > 0 Then
        'After 9th inning, score not tied, etc..
        'End of game!
        GoTo LGameOver
    End If

    If rainDelay = 1 And INNING% >= rainStart And rainStart >= 6 And (gameScore(1, 0) > gameScore(0, 0) And P = 1 Or gameScore(0, 0) > gameScore(1, 0) And P = 0) Then

        Cls

        If useVGA = 0 Then Screen 0

        Print "THIS GAME HAS BEEN CALLED ON ACCOUNT OF RAIN!!!"
        Print "ALL RECORDS ARE OFFICIAL!!"
        Locate 24, 1: Print "HIT ANY KEY TO CONTINUE";

        I$ = GetKeyPress$

        'End of game!
        GoTo LGameOver

    End If

    If rainDelay = 1 And P = 0 And INNING% = 4 Then

        Call PBP("THE RAIN IS FALLING A LITTLE MORE STEADILY")
        Call PBP("THIS GAME MAY NOT GO 9!")
        I$ = GetKeyPress$

    End If

    'Game is not over - show the field
    If useVGA = 1 Then

        '-- Here, we restore the non-negative value
        '-- of playerX%() to prevent an error
        playerX%(D, POS_P) = b9d1
        playerX%(D, POS_C) = b9d2

        Call DisplayBallField_Gfx(nbrBalls, P, nbrStrikes, D)
    Else
        Call DisplayBallField(nbrBalls, P, nbrStrikes, D)
    End If

    For IJ0% = 0 To 22
        Print #11, "*** LStart: "; IJ0%; batRating(D, IJ0%, 21)

        If batRating(D, IJ0%, 21) > 39 And batRating(D, IJ0%, 21) <= 49 Then

            I1 = IJ0%
            I2 = batRating(D, IJ0%, 21) - 40

            batRating(D, I1, 21) = 1
            playerNum%(D, I2) = I1
            playerX%(D, fldPos%(D, I2)) = I1
            gameD0%(D) = gameD0%(D) + 1
            X0%(D, 0, gameD0%(D)) = playerNum%(D, I2)
            X0%(D, 1, gameD0%(D)) = fldPos%(D, I2)
            X0%(D, 2, gameD0%(D)) = (I2 * 10) + (gameD0%(D) - 9)

            W5 = D
            W6 = D
            VV(D) = I2
            VV1(D) = I2

            For xx = 22 To 25   'Iterate over 4 possible positions'
                If fldPos%(D, I2) = batRating(D, I1, xx) Then   'Position match?'
                    batRating(D, I1, SS_B_Arm) = batRating(D, I1, 33 + (xx - 22) * 2)
                    batRating(D, I1, SS_B_Range) = batRating(D, I1, 34 + (xx - 22) * 2)
                    batRating(D, I1, 19) = batRating(D, I1, xx + 4)
                    Exit For
                End If
            Next

            '14955  ---> this is it's own routine used often
            Call HITTINGLINES

            If useVGA = 1 Then
                Call DisplayBallField_Gfx(nbrBalls, P, nbrStrikes, D)
                Call MAINSCREEN_G(D, P, nbrBalls, nbrStrikes, MO)
            Else
                Call DisplayBallField(nbrBalls, P, nbrStrikes, D)
                Call MAINSCREEN(D, P, nbrBalls, nbrStrikes, MO)
            End If

            VV(D) = 1
            VV1(D) = 9

        End If

    Next

    ourLead = gameScore(D, 0) - gameScore(P, 0)

    If Not (MG%(D, 560) <> 999 Or INNING% < 8 Or playerMode = 0 Or playerMode = 1 And P = compTeam) Then

        For IJ0% = 1 To 4
            Print #11, "*** LStart2: "; IJ0%; batRating(D, MG%(D, 564 + IJ0%), 21); MG%(D, 560 + IJ0%)

            If MG%(D, 560 + IJ0%) <> -1 And batRating(D, MG%(D, 564 + IJ0%), 21) = 0 Then

                Call d100(RN)

                If playerX%(D, MG%(D, 576 + IJ0%)) = MG%(D, 560 + IJ0%) And RN <= MG%(D, 568 + IJ0%) And ourLead >= MG%(D, 572 + IJ0%) Then

                    I1 = MG%(D, 564 + IJ0%)

                    For I2 = 1 To 9
                        If fldPos%(D, I2) = MG%(D, 576 + IJ0%) Then Exit For
                    Next

                    batRating(D, I1, 21) = 1
                    playerNum%(D, I2) = I1
                    playerX%(D, fldPos%(D, I2)) = I1

                    gameD0%(D) = gameD0%(D) + 1
                    X0%(D, 0, gameD0%(D)) = playerNum%(D, I2)
                    X0%(D, 1, gameD0%(D)) = fldPos%(D, I2)
                    X0%(D, 2, gameD0%(D)) = (I2 * 10) + (gameD0%(D) - 9)

                    W5 = D
                    W6 = D
                    VV(D) = I2
                    VV1(D) = I2

                    For xx = 22 To 25
                        If fldPos%(D, I2) = batRating(D, I1, xx) Then
                            batRating(D, I1, SS_B_Arm) = batRating(D, I1, 33 + (xx - 22) * 2)
                            batRating(D, I1, SS_B_Range) = batRating(D, I1, 34 + (xx - 22) * 2)
                            batRating(D, I1, 19) = batRating(D, I1, xx + 4)
                            Exit For
                        End If
                    Next

                    Call HITTINGLINES

                    If useVGA = 1 Then
                        Call DisplayBallField_Gfx(nbrBalls, P, nbrStrikes, D)
                        Call MAINSCREEN_G(D, P, nbrBalls, nbrStrikes, MO)
                    Else
                        Call DisplayBallField(nbrBalls, P, nbrStrikes, D)
                        Call MAINSCREEN(D, P, nbrBalls, nbrStrikes, MO)
                    End If

                    VV(D) = 1
                    VV1(D) = 9

                End If

            End If

        Next

    End If

    If playerX%(D, POS_P) = 99 And playerMode = 0 Or playerX%(D, POS_P) = 99 And playerMode = 1 And compTeam = 1 - D Then
        '----- move stuff here -----
        GoTo LStayInGame
    End If

  LNextInning: '
    DumpAll
    Print #11, "---"
    Print #11, "LNextInning possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    SH = 0
    F% = 0
    SO = 0
    currBatter!(P) = currBatter!(P) + 1
    INFPOS% = INF_NORMAL
    nbrStrikes = 0

    If currBatter!(P) = 10 Then currBatter!(P) = 1

    '--- Start of a new sub
  LNextBatter: '
    DumpAll
    Print #11, "---"
    Print #11, "LNextBatter possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Call WHOSON1ST(baseRunners%)
    Call PLAYERNAME(P)

    If useVGA = 1 Then
        Call MAINSCREEN_G(D, P, nbrBalls, nbrStrikes, MO)
    Else
        Call MAINSCREEN(D, P, nbrBalls, nbrStrikes, MO)
    End If

    P2 = 0
    D2 = 0

    ' Game over - there's a winner
    If INNING% >= 9 And P = 1 And gameScore(P, 0) - gameScore(D, 0) > 0 Then
        GoTo LGameOver
    End If

  LContinueBatter: '
    DumpAll
    Print #11, "---"
    Print #11, "LContinueBatter possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)

    Do

        If useVGA = 1 Then
            _PutImage (20 * FontColAdj, 48)-Step(44 * FontColAdj, 128), backupScreen&, imageScreen&, (20 * FontColAdj, 48)-Step(44 * FontColAdj, 128)
        Else
            Color 14, 0
        End If

        I2 = INNING%

        I0 = P

        'Move cursor to current inning if score > 0
        If inningScore(P, INNING%) > 0 Then
            If useVGA = 1 Then
                Call INNDISP_G(I2, I0)
            Else
                Call INNDISP(I2, I0)
            End If
        End If

        'Print total score
        If useVGA = 1 Then

            FORMATTED$ = FUsing$(Str$(gameScore(I0, 0)), "##", 1)
            PrintOnGfx 53, I0 + 28, FORMATTED$, imageScreen&

            FORMATTED$ = FUsing$(Str$(gameScore(D, 2)), "##", 1)
            'PrintOnGfx 59, 1 - I0 + 28, FORMATTED$, imageScreen&
            PrintOnGfx 59, D + 28, FORMATTED$, imageScreen&

        Else

            Locate I0 + 2, 40
            Print Using "##"; gameScore(I0, 0);
            Locate D + 2, 46
            Print Using "##"; gameScore(D, 2);
            Color 15, 0

        End If

        Z2% = gameBaserunners%(2, 0)
        F% = 0

      LContinueBatter2: '
        DumpAll
        Print #11, "---"
        Print #11, "LContinueBatter2 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        If (playerMode = 2 Or playerMode = 1 And P <> compTeam) Then
            GoTo LEndOfGame
        End If

        If baseRunners% = BASE_1 Or baseRunners% = BASE_1_3 Then
            runnerHeld = 1
            If useVGA = 1 Then
                Call HOLDSTATUS_G(runnerHeld)
            Else
                Call HOLDSTATUS(runnerHeld)
            End If
        End If

        '----------------------------------------
        ' DEFENSE OPTIONS MENU
        '----------------------------------------
      LDefenseOptions: '
        DumpAll
        Print #11, "---"
        Print #11, "LDefenseOptions DEFENSE possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        pbpString$ = PadRight$(Left$(gameTeams$(D), 3) + teamAbbreviatons$(D), 8)

        'Call WINDEX

        If useVGA = 1 Then

            'Printing black on background
            _PrintMode _KeepBackground , imageScreen&
            Color 4278190080

            PrintOnGfx 1, 19, pbpString$, imageScreen&

            F1$(1) = "1-PITCH       "
            F1$(2) = "2-INT WALK    "
            F1$(3) = "3-INF IN      "
            F1$(4) = "4-CORNERS IN  "
            F1$(5) = "5-INF NORMAL  "
            F1$(6) = "6-PERSONNEL   "
            F1$(7) = "8-PITCH AROUND"
            F1$(8) = "G-GUARD LINES "
            F1$(9) = "H-HOLD RUNNER "

            '-- B/P do not do anything
            '-- but could be programmed to
            '-- Presumably they are for
            '-- Batter / Pitcher stats
            F1$(10) = "S/D/B/P STATS "

            For I = 21 To 30
                PrintOnGfx 1, I - 1, F1$(I - 20), imageScreen&
            Next

        Else

            Color 14, 0: Print pbpString$

            Print " 1-PITCH          D-DETAILED STATS      "
            Print " 2-INTENTIONAL BB S-BATTER/PITCHER STATS"
            Print " 3-INFIELD IN     H-HOLD RUNNER"
            Print " 4-CORNERS IN     Q-QUIT GAME"
            Print " 5-INFIELD NORMAL W-WEATHER CONDITIONS"
            Print " 6-PERSONNEL      G-GUARD LINES"
            Print " 7-PITCH/HIT AWAY O-GAME OPTIONS"
            Print " 8-PITCH AROUND"
            Color 15, 0

        End If

        I$ = GetKeyPress$

        'Restore image where commands went
        If useVGA = 1 Then _PutImage (1 * FontColAdj, 304)-Step(14 * FontColAdj, 176), backupScreen&, imageScreen&, (1 * FontColAdj, 304)-Step(14 * FontColAdj, 176)

        If UCase$(I$) = "D" Then
            Call VIEWTEAM
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "G" Then

            INFPOS% = INF_GUARD_LINES

            If useVGA = 1 Then
                pbpString$ = "INF:GUARD LINE"
                _PutImage (52 * FontColAdj, 416)-Step(14 * FontColAdj, 16), backupScreen&, imageScreen&, (52 * FontColAdj, 416)-Step(14 * FontColAdj, 16)

                'Printing black on background
                _PrintMode _KeepBackground , imageScreen&
                Color 4278190080

                PrintOnGfx 52, 26, pbpString$, imageScreen&

                'Printing white on black
                Color &HFFFFFFFF
                _PrintMode _FillBackground , imageScreen&
            Else
                Color 15, 2
                Locate 23, 46: Print "GUARD LINE"
            End If

            GoTo LContinueBatter

        End If

        If UCase$(I$) = "L" Then
            Call PopUp_Lineup
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "O" Then
            Call OPTIONS
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "Q" Then
            If useVGA = 0 Then Cls
            Call EndOfGame
            Exit Sub
        End If

        If UCase$(I$) = "S" Then
            Call POPUPSTATS
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "B" Then
            If useVGA = 1 Then Screen 0
            Call PopUp_Batter(D, currPitcher%(D))
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "P" Then
            If useVGA = 1 Then Screen 0
            Call PopUp_Pitcher(P, currPitcher%(P))
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "W" Then
            Call WEATHER
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "H" Then

            runnerHeld = 1 - runnerHeld

            If useVGA = 1 Then
                Call HOLDSTATUS_G(runnerHeld)
            Else
                Call HOLDSTATUS(runnerHeld)
            End If

            GoTo LDefenseOptions

        End If

        If Val(I$) = 7 Then
            P2 = 1
            D2 = 1

            GoTo LWeirdPlay

        End If

        D2 = Val(I$)

    Loop Until D2 >= 1 And D2 <= 9


  LManageDefense: '
    DumpAll
    Print #11, "---"
    Print #11, "LManageDefense possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)

    Select Case D2
        Case 1
            '

        Case 2
            Call WINDEX
            Call BASEONBALLS(event%, D2, D, P)
            GoTo LHBP

        Case 3
            INFPOS% = INF_INFIELD_IN
            infStatus$ = "INF:INFIELD IN"

        Case 4
            INFPOS% = INF_CORNERS_IN
            infStatus$ = "INF:CORNERS IN"

        Case 5
            INFPOS% = INF_NORMAL
            infStatus$ = "INF:NORMAL    "

        Case 6
            P9 = D
            W5 = -1
            W6 = -1
            GoTo LPersonnelMenu

    End Select

    'We've assigned the text,
    'now we have to print it on the screen
    If D2 >= 3 And D2 <= 5 Then

        If useVGA = 1 Then
            'Restore image where options go
            _PutImage (52 * FontColAdj, 416)-Step(14 * FontColAdj, 16), backupScreen&, imageScreen&, (52 * FontColAdj, 416)-Step(14 * FontColAdj, 16)

            'Printing black on background
            _PrintMode _KeepBackground , imageScreen&
            Color 4278190080

            'Print infield status
            PrintOnGfx 52, 26, infStatus$, imageScreen&

            'Printing white on black
            Color &HFFFFFFFF
            _PrintMode _FillBackground , imageScreen&
        Else
            Color 15, 2
            Locate 23, 46: Print infStatus$
        End If

        GoTo LContinueBatter

    End If

    '----------------------------------------
    ' OFFENSE OPTIONS MENU
    '----------------------------------------
  LOffenseOptions: '
    Do
        DumpAll
        Print #11, "---"
        Print #11, "LOffenseOptions OFFENSE -- possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "Source 528 -- playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "Source 528 -- gameScore ="; gameScore(0,0); gameScore(1,0); ", flagPinchHitter ="; flagPinchHitter

        If (playerMode = 2 Or playerMode = 1 And P = compTeam) Then

            JM = playerNum%(P, currBatter!(P))

            If flagPinchHitter <> 1 Then

                ourLead = gameScore(P, 0) - gameScore(D, 0)

                If fldPos%(P, currBatter!(P)) <> 1 Then

                    If MG%(P, 847) = 999 Then

                        'PH FOR POS PLAYER CASES
                        Call d100(RN)
                        MOB% = 0

                        For I = 1 To 3
                            If gameBaserunners%(I, 0) > 0 Then MOB% = MOB% + 1
                        Next

                        If batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) = 0 Then
                            theBAvg = 0
                            theSlug = 0
                        Else
                            theBAvg = Int(  batRating(P, playerNum%(P, currBatter!(P)), SS_B_H) / batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) * 1000 + .5)
                            theSlug = Int( (batRating(P, playerNum%(P, currBatter!(P)), SS_B_H) + batRating(P, playerNum%(P, currBatter!(P)), SS_B_2B) + batRating(P, playerNum%(P, currBatter!(P)), SS_B_3B) * 2 + batRating(P, playerNum%(P, currBatter!(P)), SS_B_HR) * 3) / batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) * 1000 + .5 )
                        End If

                        For I = 0 To 2
                            If INNING% >= MG%(P, 848 + I * 6) And ourLead <= MG%(P, 849 + I * 6) * -1 And theSlug <= MG%(P, 851 + I * 6) And theBAvg <= MG%(P, 852 + I * 6) And RN <= MG%(P, 853 + I * 6) And MOB% >= MG%(P, 850 + I * 6) Then
                                Print #11, "Pinch hitting for slug scenario ="; I; ", Slug ="; theSlug; ", BAvg ="; theBAvg
                                GoTo LPhForPosition
                            End If
                        Next

                    Else

                        If batRating(P, JM, SS_B_AB) <> 0 Then
                            Print #11, "Pinch hitting for JM ="; JM; ", batRating ="; batRating(P, JM, SS_B_AB)
                            GoTo LPhForPosition
                        Else

                            If Not (batRating(P, JM, SS_B_H) / batRating(P, JM, SS_B_AB) * 1000 > 233 Or batRating(P, JM, SS_B_HR) >= 15) Then
                                If INNING% > 6 And ourLead < -2 Or ourLead <= 0 And INNING% >= 8 Or ourLead = 0 And INNING% >= 9 Then 
                                    Print #11, "Pinch hitting for 233 BA ="; batRating(P, JM, SS_B_H) / batRating(P, JM, SS_B_AB) * 1000; ", HR ="; batRating(P, JM, SS_B_HR)
                                    Goto LPhForPosition
                                End If
                            End If

                        End If

                    End If

                End If

            Else

                For I = 0 To 21

                    If pitchRating(P, I, SS_P_WP) = 0 Then

                        If MG%(P, 590) = 999 Then

                            'PH FOR PITCHER WITH PROFILE
                            Call d100(RN)

                            MOB% = 0

                            For I = 1 To 3
                                If gameBaserunners%(I, 0) > 0 Then MOB% = MOB% + 1
                            Next

                            If pitchRating(P, currPitcher%(P), SS_P_BAvg) <> 999 Then
                                I7! = pitchRating(I0, currPitcher%(I0), SS_P_BAvg)
                            Else
                                If pitchRating(P, currPitcher%(P), 20) = 0 Then
                                    I7! = 0
                                Else
                                    I7! = Int((pitchRating(P, currPitcher%(P), 22) / pitchRating(P, currPitcher%(P), 20) * 1000 + .5))
                                End If
                            End If

                            For I = 0 To 2
                                If INNING% >= MG%(P, 591 + I * 6) And ourLead <= MG%(P, 592 + I * 6) * -1 And nbrOuts(0) <= MG%(P, 594 + I * 6) And I7! <= MG%(P, 595 + I * 6) And RN <= MG%(P, 596 + I * 6) And MOB% >= MG%(P, 593 + I * 6) Then
                                    GoTo LPhForPitcher
                                End If
                            Next

                            Exit For

                        Else

                            If INNING% > 4 And INNING% < 7 And ourLead < -2 And gameScore(P, 0) > 0 Then Goto LPhForPitcher
                            If INNING% > 4 And INNING% < 7 And ourLead < -3 Then Goto LPhForPitcher
                            If INNING% > 6 And ourLead < 0 Or ourLead = 0 And INNING% > 6 And INNING% < 9 And baseRunners% > BASE_1 Then Goto LPhForPitcher
                            If ourLead = 0 And INNING% >= 9 And baseRunners% > BASE_EMPTY Or ourLead = 0 And INNING% >= 9 And nbrOuts(0) = 0 Then Goto LPhForPitcher
                            If pitchRating(P, currPitcher%(P), 6) / pitchRating(P, currPitcher%(P), SS_P_G) <= 2 And statPitcherGame%(P, currPitcher%(P), LG_P_IP3) >= 6 Then Goto LPhForPitcher

                            Exit For

                        End If

                    End If

                Next

            End If

            GoTo LPinchRunner

        Else

            Call WINDEX

            _PutImage (20 * FontColAdj, 48)-Step(44 * FontColAdj, 144), backupScreen&, imageScreen&, (20 * FontColAdj, 48)-Step(44 * FontColAdj, 144)

            pbpString$ = PadRight$(Left$(gameTeams$(P), 3) + teamAbbreviatons$(P), 8)

            If useVGA = 1 Then
                'Printing black on background
                _PrintMode _KeepBackground , imageScreen&
                Color 4278190080

                PrintOnGfx 1, 19, pbpString$, imageScreen&

                F1$(1) = "1-HIT AWAY    "
                F1$(2) = "2-HIT AND RUN "
                F1$(3) = "3-STEAL       "
                F1$(4) = "4-BUNT        "
                F1$(5) = "5-PERSONNEL   "
                F1$(6) = "O-GAME OPTIONS"
                F1$(7) = "D/S/P/B STATS "
                F1$(8) = "W-WEATHER COND"
                F1$(9) = "L-SHOW LINEUPS"
                F1$(10) = "Q-QUIT GAME   "

                For I = 21 To 30
                    PrintOnGfx 1, I - 1, F1$(I - 20), imageScreen&
                Next

                'Printing white on black
                Color &HFFFFFFFF
                _PrintMode _FillBackground , imageScreen&

            Else
                Color 14, 0
                Print gameTeams$(P); " SELECT:"
                Print " 1- HIT AWAY      D-DETAILED STATS"
                Print " 2- HIT AND RUN   S-BATTER/PITCHER STATS"
                Print " 3- STEAL         L-DISPLAY LINEUPS"
                Print " 4- BUNT          Q-QUIT GAME"
                Print " 5- PERSONNEL     W-WEATHER CONDITIONS"
                Color 15, 0

            End If

        End If

        I$ = GetKeyPress$

        If useVGA = 1 Then
            _PutImage (1 * FontColAdj, 304)-Step(14 * FontColAdj, 176), backupScreen&, imageScreen&, (1 * FontColAdj, 304)-Step(14 * FontColAdj, 176)
        End If

        If UCase$(I$) = "D" Then
            Call VIEWTEAM
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "L" Then
            Call PopUp_Lineup
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "O" Then
            Call OPTIONS
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "Q" Then
            If useVGA = 0 Then Cls
            Call EndOfGame
            Exit Sub
        End If

        If UCase$(I$) = "S" Then
            Call POPUPSTATS
            GoTo LChangeNobody
        End If

        If UCase$(I$) = "W" Then
            Call WEATHER
            GoTo LChangeNobody
        End If

        P2 = Val(I$)

    Loop Until P2 >= 1 And P2 <= 5

  LRunnerGoing: '
    DumpAll
    Print #11, "---"
    Print #11, "LRunnerGoing possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "dice1000 ="; dice1000%; "gameScore ="; gameScore(0,0); gameScore(1,0)
    Select Case P2

        Case 1, 4   'Hit away, Bunt'

            Print #11, "726: P2="; P2; ", D2="; D2
            
            If D2 <> 8 Then Goto LWeirdPlay

            Call WINDEX

            Call d100(RN)
            Print #11, "LRunnerGoing: P2="; P2; ", RN="; RN
            
            If P2 = 4 Or (P2 = 1 And RN <= 50) Then Goto LWeirdPlay

            Print #11, "Calling BASEONBALLS"
            Call BASEONBALLS(event%, D2, D, P)

            GoTo LHBP

        Case 2  'Hit and run'
            If nbrOuts(0) = 2 Or (baseRunners% <> BASE_1 And baseRunners% <> BASE_1_2 And baseRunners% <> BASE_1_3) Then Goto LNextBatter

        Case 3  'Steal'
            GoTo LSteal

        Case 5  'Personnel'
            P9 = P
            W5 = -1
            W6 = -1
            GoTo LPersonnelMenu

    End Select

  LRunnerGoing2: '
    DumpAll
    Print #11, "---"
    Print #11, "LRunnerGoing2 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "dice1000 ="; dice1000%; "gameScore ="; gameScore(0,0); gameScore(1,0)
    '-- this is related to the PICKEDOFF routine and it's immediate aftermath
    If baseRunners% = BASE_1_2 Then I = 3 Else I = 2

    Call d100(I3)

    If I3 < 6 Then

        Call PICKEDOFF(D, I)

        PO = 1
        A5%(I - 1) = 10
        nbrOuts(0) = nbrOuts(0) + 1
        nbrOuts(1) = nbrOuts(1) + 1
        currFielder% = 1

        Call CREDITASSIST(currFielder%, D)
        Call ADVANCEMENT(P, D, event%, F%, I3)
        Call CREDITPUTOUT(I3, FB2P%, AST%, D)

        Call ADDPIT(D, currPitcher%(D), 0)

        If nbrOuts(0) >= 3 Then

            currBatter!(P) = currBatter!(P) - 1
            PO = 0
            GoTo LCheckForOptionsOrQuit

        End If

    End If

    If PO = 1 Then PO = 0: GoTo LNextBatter

    Call WINDEX

    I3 = Int(Rnd(1) * 1000) + 1
    I9 = Int(Rnd(1) * 1000) + 1

    If I3 > 350 Then
        Call PBP("Runner(s) going")
    Else
        Call PBP("Count not favorable...hit away")
        P2 = 1
    End If

    Call DELAY

    If I3 <= 350 Then Goto LWeirdPlay

    If I9 <= (liveBatRating%(P, LIVE_K, currBatter!(P)) * 2 * .33) Then

        nbrStrikes = nbrStrikes + 1
        Call PBP(player$(0) + " swings and misses")
        Call DELAY

        If useVGA = 1 Then
            PrintOnGfx 63, 28, Str$(nbrStrikes), imageScreen&
        Else
            Locate 2, 58: Print nbrStrikes
        End If

        If nbrStrikes = 3 Then
            GoTo LStrikeout
        Else
            GoTo LSteal
        End If
    End If

    If I9 <= liveBatRating%(P, LIVE_K, currBatter!(P)) * 2 Then
        Call PBP(player$(0) + " fouls off the pitch...hit away")
        Call DELAY
        P2 = 1
    End If

    GoTo LWeirdPlay


    '--- end of a new sub

    '================================================================================
    ' Below are all the different GoTo branches for the gameplay
    ' These have not been worked out into a different flow
    ' yet for the game's logic.
    '================================================================================

    '----- NOODLE -----


  LRarePlays: ' BRANCH FOR RARE PLAYS
    DumpAll
    Print #11, "---"
    Print #11, "LRarePlays Rare Plays possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Call RAREPLAYS(dice1000%, dice7500%, IP%)

    If IP% = 1 Then 'pitcher is injured'
        IP% = 0
        Call RELIEVERS(flagPinchHitter, pz)
    End If

    '-- It appears the following lines get executed
    '-- almost no matter what value dice1000% is.

    '   "Call HITTING LINES...
    '   If useVGA = 1...

    '-- In original code this was a short sub
    '-- I'm not sure why it can't be run outside
    '-- of the If/Then statement.
    '-- That would simply leave the If/Then code
    '-- to determine where to GoTo

    '1 to 4
    '6 to 8
    '10 to 24
    If dice1000% <= 4 Or dice1000% > 5 And dice1000% < 9 Or dice1000% >= 10 And dice1000% <= 24 Then

        Call HITTINGLINES

        If useVGA = 1 Then
            Call DisplayBallField_Gfx(nbrBalls, P, nbrStrikes, D)
            Call MAINSCREEN_G(D, P, nbrBalls, nbrStrikes, MO)
        Else
            Call DisplayBallField(nbrBalls, P, nbrStrikes, D)
            Call MAINSCREEN(D, P, nbrBalls, nbrStrikes, MO)
        End If

        GoTo LContinueBatter

    End If

    '5
    '25 to 29
    If dice1000% = 5 Or dice1000% >= 25 And dice1000% <= 29 Then

        Call HITTINGLINES

        If useVGA = 1 Then
            Call DisplayBallField_Gfx(nbrBalls, P, nbrStrikes, D)
            Call MAINSCREEN_G(D, P, nbrBalls, nbrStrikes, MO)
        Else
            Call DisplayBallField(nbrBalls, P, nbrStrikes, D)
            Call MAINSCREEN(D, P, nbrBalls, nbrStrikes, MO)
        End If

        GoTo LCheckForOptionsOrQuit

    End If

    '9
    If dice1000% = 9 Then

        Call HITTINGLINES

        If useVGA = 1 Then
            Call DisplayBallField_Gfx(nbrBalls, P, nbrStrikes, D)
            Call MAINSCREEN_G(D, P, nbrBalls, nbrStrikes, MO)
        Else
            Call DisplayBallField(nbrBalls, P, nbrStrikes, D)
            Call MAINSCREEN(D, P, nbrBalls, nbrStrikes, MO)
        End If

        '13240 / *** base on balls ***
        Call BASEONBALLS(event%, D2, D, P)
        GoTo LHBP

    End If

    '45
    If dice1000% = 45 Then

        Call HITTINGLINES

        If useVGA = 1 Then
            Call DisplayBallField_Gfx(nbrBalls, P, nbrStrikes, D)
            Call MAINSCREEN_G(D, P, nbrBalls, nbrStrikes, MO)
        Else
            Call DisplayBallField(nbrBalls, P, nbrStrikes, D)
            Call MAINSCREEN(D, P, nbrBalls, nbrStrikes, MO)
        End If

        GoTo LHBP

    End If

    '30 to 44
    '46+ ???
    Call HITTINGLINES

    If useVGA = 1 Then
        Call DisplayBallField_Gfx(nbrBalls, P, nbrStrikes, D)
        Call MAINSCREEN_G(D, P, nbrBalls, nbrStrikes, MO)
    Else
        Call DisplayBallField(nbrBalls, P, nbrStrikes, D)
        Call MAINSCREEN(D, P, nbrBalls, nbrStrikes, MO)
    End If

    GoTo LContinueBatter

    '----- NOODLE -----


  LWeirdPlay: '
    DumpAll
    Print #11, "---"
    Print #11, "LWeirdPlay possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "dice1000 ="; dice1000%; "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Call d100(RN)

    If (((precipType = 1 Or precipType = 2 Or precipType = 3) And RN = 2) Or (rainDelay = 1 And RN <= 5)) And INNING% >= 2 And gameDelayed = 0 Then
        dice7500% = 20
        dice1000% = 21
        Print #11, "Noodle 10"
        GoTo LRarePlays
    End If

    dice1000% = Int(Rnd(1) * 1000) + 1
    If dice1000% <= 3 And useInj = 1 Then
        Print #11, "Noodle 20"
        GoTo LRarePlays
    End If

    infPosFactor = 0
    dice1000% = Int(Rnd(1) * 1000) + 1

    Print #11, "WEIRD dice1000 ="; dice1000%
    shuffle% = Int(Rnd(1) * 5) + 1
    For iBM% = 1 To shuffle%
        dice1000% = Int(Rnd(1) * 1000) + 1  ' [bm] shuffle the dice'
    Next
    Print #11, "NEW WEIRD dice1000 ="; dice1000%

    If nbrOuts(0) = 0 And baseRunners% = BASE_1_2 And INFPOS% < INF_INFIELD_IN And dice1000% = 768 _
    Or nbrOuts(0) = 0 And baseRunners% = BASE_1_2 And INFPOS% < INF_INFIELD_IN And dice1000% = 123 _
    Or nbrOuts(0) = 0 And baseRunners% = BASE_FULL And INFPOS% < INF_INFIELD_IN And dice1000% = 245 _
    Or nbrOuts(0) = 0 And baseRunners% = BASE_FULL And INFPOS% < INF_INFIELD_IN And dice1000% = 381 Then
        Call TRIPLEPLAY(D)
        Print #11, "Noodle TRIPLEPLAY"
        GoTo LCheckForOptionsOrQuit
    End If

    dice7500% = Int(Rnd(1) * 7500) + 1

    Call WINDEX

    If dice1000% <= 4 Then
        ' *** hit by pitch ***
        Print #11, "Noodle HITBYPITCH"
        Call HITBYPITCH(event%, D)

      LHBP: '
        DumpAll
        Print #11, "---"
        Print #11, "133201 HBP possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        A5%(0) = 1
        A5%(1) = 0
        A5%(2) = 0
        A5%(3) = 0

        If gameBaserunners%(1, 0) > 0 Then
            If gameBaserunners%(2, 0) > 0 Then
                If gameBaserunners%(3, 0) > 0 Then
                    A5%(3) = 1
                    If currFielder% = 2 And event% > EVENT_BB_OR_INTERFERENCE Then A5%(3) = 11
                Else
                    A5%(2) = 1
                End If
            Else
                A5%(1) = 1
            End If
        End If

        Print #11, "Noodle 10 ADVANCEMENT"
        Call ADVANCEMENT(P, D, event%, F%, I3)
        GoTo LNextInning

    End If

    If dice1000% <= 6 Then

        ' *** balk ***
        If baseRunners% = BASE_EMPTY Then
            '13100 / *** fouled out of play ***
            Print #11, "Noodle 10 FOULBALL"
            Call FOULBALL
            GoTo LContinueBatter
        Else
            event% = EVENT_BALK4

            Call WINDEX

            Call d100(RN)
            rndUmp = Int(Rnd(1) * 4) + 1

            Select Case RN
                Case Is <= 33
                    pbpString$ = "a balk has been called"
                Case 34 To 66
                    Call PBP("and a BALK is called")
                    pbpString$ = pitchers$(D, currPitcher%(D)) + " dropped the ball"
                Case 67 To 100
                    pbpString$ = gameUmpire$(rndUmp) + " calls a balk on " + pitchers$(D, currPitcher%(D))
            End Select

            Call PBP(pbpString$)

            '13223
            If gameBaserunners%(1, 0) = 0 And RN = 9 And SO = 1 Or nbrOuts(0) > 1 And RN = 9 And SO = 1 Then
                A5%(0) = 1
                A5%(1) = 1
                A5%(2) = 1
                A5%(3) = 1
                Print #11, "Noodle 20 ADVANCEMENT"
                Call ADVANCEMENT(P, D, event%, F%, I3)
                GoTo LCheckForOptionsOrQuit
            Else
                A5%(1) = 1
                A5%(2) = 1
                A5%(3) = 1
                A5%(0) = 0
                Print #11, "Noodle 30 ADVANCEMENt"
                Call ADVANCEMENT(P, D, event%, F%, I3)
                GoTo LNextBatter
            End If

        End If

    End If

    '7 to 11 OR 7 to 200 And ...
    If dice1000% <= 11 Or dice1000% <= 200 And batRating(D, playerX%(D, POS_C), 22) <> 2 And batRating(D, playerX%(D, POS_C), 23) <> 2 And batRating(D, playerX%(D, POS_C), 24) <> 2 And batRating(D, playerX%(D, POS_C), 25) <> 2 Then

      LPassedBall: ' *** passed ball ***
        DumpAll
        Print #11, "---"
        Print #11, "LPassedBall PassedBall possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        If baseRunners% = BASE_EMPTY And SO <> 1 Then
            '13100 / *** fouled out of play ***
            Print #11, "Noodle 20 ADVANCEMENT"
            Call FOULBALL
            GoTo LContinueBatter
        End If

        event% = EVENT_PB
        Call WINDEX
        Call DELIVERY(D)

        Call d100(RN2)
        If RN2 <= 50 Then
            Call PBP("pitch gets by " + batters$(D, playerX%(D, POS_C)))
        Else
            'RN > 50
            Call PBP("off " + batters$(D, playerX%(D, POS_C)) + "'s glove")
            Call PBP("it gets away from him")
        End If

        Call PBP("It's ruled a passed ball")

        If gameBaserunners%(1, 0) = 0 And RN = 9 And SO = 1 Or nbrOuts(0) > 1 And RN = 9 And SO = 1 Then
            nbrOuts(1) = nbrOuts(1) + 1
        End If

      13222 '
        DumpAll
        Print #11, "---"
        Print #11, "13222 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        RN3 = Int(Rnd(1) * 10) + 1

        If baseRunners% = BASE_1 And P2 = 2 And RN3 < batRating(P, playerNum%(P, gameBaserunners%(1, 0)), 16) Or baseRunners% = BASE_1_3 And P2 = 2 And RN3 < batRating(P, playerNum%(P, gameBaserunners%(1, 0)), 16) Then
            A5%(1) = 2
            A5%(3) = 1
            A5%(0) = 0
            A5%(2) = 2
            Print #11, "Noodle 30 H&R ADVANCEMENT"
            Call ADVANCEMENT(P, D, event%, F%, I3)
            GoTo LNextBatter
        End If

      13223 '
        DumpAll
        Print #11, "---"
        Print #11, "13223 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        If gameBaserunners%(1, 0) = 0 And RN = 9 And SO = 1 Or nbrOuts(0) > 1 And RN = 9 And SO = 1 Then
            A5%(0) = 1
            A5%(1) = 1
            A5%(2) = 1
            A5%(3) = 1
            Print #11, "Noodle 40 ADVANCEMENT"
            Call ADVANCEMENT(P, D, event%, F%, I3)
            GoTo LCheckForOptionsOrQuit
        Else
            A5%(0) = 0
            A5%(1) = 1
            A5%(2) = 1
            A5%(3) = 1
            Print #11, "Noodle 50 ADVANCEMENT"
            Call ADVANCEMENT(P, D, event%, F%, I3)
            GoTo LNextBatter
        End If

    End If

    If dice1000% <= 19 Then

        '13230 / *** wild pitch ***
        If baseRunners% = BASE_EMPTY And SO <> 1 Then
            '13100 / *** fouled out of play ***
            Call FOULBALL
            GoTo LContinueBatter
        End If

        Call WILDPITCH(event%, D)

        GoTo 13222

    End If

    If dice7500% = 27 Then

        event% = EVENT_BB_OR_INTERFERENCE
        Call WINDEX
        Call PBP(batters$(D, playerX%(D, POS_C)) + " is called for interference!!")
        Call PBP(player$(0) + " trots to first base")
        GoTo LHBP

    End If

    If dice7500% = 28 Then

        Call WINDEX
        Call PBP(player$(0) + " is out for obstruction!")

        currFielder% = 2
        Call CREDITREGPO(currFielder%, D)
        nbrOuts(0) = nbrOuts(0) + 1
        nbrOuts(1) = nbrOuts(1) + 1

        If fldPos%(P, currBatter!(P)) <> 1 Then
            Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
        Else
            Call INCPITOFF(P, currPitcher%(P), 23)
        End If

        Call ADDPIT(D, currPitcher%(D), 0)

        GoTo LCheckForOptionsOrQuit
    End If

    DumpAll
    Print #11, "BaseOnBalls: dice1000% ="; dice1000%; ", Batter BB% is:"; liveBatRating%(P, 5, currBatter!(P)); ", Batter # is"; currBatter!(P); ", Inning is:"; INNING%; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"; ", baseRunners ="; baseRunners%
    Print #11, gameTeams$(0); " at "; gameTeams$(1), "outs0 ="; nbrOuts(0); ", outs1 ="; nbrOuts(1)

    Print #11, "/\/\/\ Dice1000% = "; dice1000%; ", walkRating = "; liveBatRating%(P, 5, currBatter!(P)) + 28; _
        ", isWalk? "; dice1000% <= liveBatRating%(P, LIVE_BB, currBatter!(P)) + 28
        
    If dice1000% <= liveBatRating%(P, LIVE_BB, currBatter!(P)) + 28 Then      'ToDo [bm]: define obstruction factor constant'
        event% = EVENT_BB_OR_INTERFERENCE
        '13240 / *** base on balls ***
        Print #11, "1237 BASEONBALLS"
        Call BASEONBALLS(event%, D2, D, P)
        GoTo LHBP
    End If

    If P2 = 4 Then Goto LBunt

    '3056
    dice1000% = Int(Rnd(1) * 1000) + 1
    dice7500% = Int(Rnd(1) * 1000) + 1
    fatigue = 0

    If P2 = 2 Then fatigue = -5

    If INFPOS% = INF_INFIELD_IN Then
        infPosFactor = 70
        fatigue = fatigue + 15
    End If

    If nbrStrikes = 2 Then
        fatigue = fatigue - 15
    End If

    If INFPOS% = INF_CORNERS_IN Then
    infPosFactor = 20
    End If

    If INNING% > 5 _
        And stamina%(D, 0) <= statPitcherGame%(D, currPitcher%(D), LG_P_BB) + statPitcherGame%(D, currPitcher%(D), LG_P_H) _
        And stamina%(D, 1) <= statPitcherGame%(D, currPitcher%(D), LG_P_R) Then
        fatigue = fatigue + 40
    End If

    If P = 0 Then fatigue = fatigue - 2
    If P = 1 Then fatigue = fatigue + 2

    Print #11, "fatigue ="; fatigue

    Call WINDEX

    If dice7500% <= infPosFactor Then
        Call PBP("It gets through the drawn-in infield!")
        Call DELAY
        GoTo LDrawnInInfield
    End If

    Print #11, "/\/\/\ Dice1000% = "; dice1000%; ", BAvgRating (w/fatigue) = "; liveBatRating%(P, LIVE_BAvg, currBatter!(P)) + fatigue

    If dice1000% > liveBatRating%(P, LIVE_BAvg, currBatter!(P)) + fatigue Then   ' *** check for strikeout ***
      Z_Out: ' just a marker label for the Out section  

        '3600
        ' *** check for strikeout ***
        dice1000% = Int(Rnd(1) * 1000) + 1
        strikeoutRating = liveBatRating%(P, LIVE_K, currBatter!(P))

        Print #11, "/\/\/\ Dice1000% = "; dice1000%; ", KRating = "; strikeoutRating; ", isK? "; dice1000% <= strikeoutRating
      Z_Strikeout: ' just a marker label for the Strikeout section  
        If dice1000% > strikeoutRating Then ' NOT a strikeout

            ' *** ground ball for out ***
            Call d100(dice1000%)

            E2% = batRating(P, playerNum%(P, currBatter!(P)), SS_B_GndPct) + pitchRating(D, currPitcher%(D), SS_P_GndPct)- 52
            E3% = 23 + pitchRating(D, currPitcher%(D), SS_B_GndPct)
            E4% = 0 '[bm] 0 = groundball, 1 = flyball'

            If dice1000% > E2% And fldPos%(P, currBatter!(P)) <> 1 Then E4% = 1
            If dice1000% > E3% And fldPos%(P, currBatter!(P)) =  1 Then E4% = 1

            Print #11, "/\/\/\ Dice1000% = "; dice1000%; " fldPos: "; fldPos%(P, currBatter!(P)); _
                ", GBRating = "; E2%; " or "; E3%; ", isGB? "; dice1000% <= strikeoutRating

            DumpAll
            Print #11, "1244 (groundball) - batRating = "; batRating(P, playerNum%(P, currBatter!(P)), SS_B_GndPct); ", pitRating = "; pitchRating(D, currPitcher%(D), SS_B_GndPct)
            Print #11, "1244 (groundball) - E2% = "; E2%; ", E3% = "; E3%; ", E4% = "; E4%; ", fldPos% = "; fldPos%(P, currBatter!(P)); ", dice1000% = "; dice1000%
            
            If E4% = 1 Then

                'balls hit to the air
                Call d100(RN)
                Print #11, "/\/\/\ FLYBALL Dice100% = "; RN

                A5%(0) = 0
                A5%(1) = 0
                A5%(2) = 0
                A5%(3) = 0

                DumpAll
                Select Case RN

                    Case 1 To 73
                        ' *** FLY  OUTS ***
                        Print #11, "1260 GETOUTFIELDER: RN = "; RN
                        Call GETOUTFIELDER(currFielder%, P, I1, D)

                        If fldPos%(P, currBatter!(P)) <> 1 Then
                            Print #11, "1260 INCBATOFF: I5 = "; playerNum%(P, currBatter!(P))
                            Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
                        Else
                            Print #11, "1269 INCPITOFF: I5 = "; currPitcher%(P)
                            Call INCPITOFF(P, currPitcher%(P), 23)
                        End If

                        Call d100(RN)
                        Print #11, "/\/\/\ SHALLOW or DEEP Dice100% = "; RN

                        Select Case RN

                            Case 1 To 17
                                If RN <= 17 Then
                                    ' *** shallow fly ball ***
                                    event% = EVENT_FLY_SHALLOW
                                    Call WINDEX

                                    X$ = fieldPos$(currFielder%)
                                    If Int(Rnd(1) * 100) <= 25 And currFielder% = 7 Then X$ = "lcf"
                                    If Int(Rnd(1) * 100) <= 25 And currFielder% = 9 Then X$ = "rcf"

                                    Call DELIVERY(D)

                                    'What is this used for?
                                    'Call d100(RN)
                                    'Print #11, "/\/\/\ What for? Dice100% = "; RN

                                    Call GetPBPString(60, 1170, Y$, D)
                                    Call PBP(Y$ + " " + X$)

                                    Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                                    Print #11, "1296 shallow fly ball: F% = "; F%
                                    If F% = 1 Then Goto LCheckForOptionsOrQuit
                                    GoTo 14025

                                End If

                            Case 18 To 33
                                ' *** deep fly out ***
                                event% = EVENT_FLY_DEEP

                                Call WINDEX
                                Call LONGFLY(D, currFielder%)

                                Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                                Print #11, "1310 deep fly out: F% = "; F%
                                If F% = 1 Then Goto LCheckForOptionsOrQuit

                                Call CREDITREGPO(currFielder%, D)
                                Call CAUGHTFLY(RN, event%, D)

                                nbrOuts(0) = nbrOuts(0) + 1
                                nbrOuts(1) = nbrOuts(1) + 1

                                Call ADDPIT(D, currPitcher%(D), 0)

                                Print #11, "1323 nbrOuts(0) = "; nbrOuts(0); ", nbrOuts(1) = "; nbrOuts(1)
                                
                                If nbrOuts(0) = 3 Then Goto LCheckForOptionsOrQuit

                                If gameBaserunners%(3, 0) <> 0 Then

                                    A5%(3) = 1

                                    Call ADDPIT(D, currPitcher%(D), 16)

                                    If fldPos%(P, currBatter!(P)) = 1 Then
                                        Call PITOFF(   P, currPitcher%(P), 23)
                                        Call INCPITOFF(P, currPitcher%(P), 41)
                                    Else
                                        Call BATOFF(   P, currBatter!(P),  0)
                                        Call INCBATOFF(P, currBatter!(P), 19)

                                    End If

                                End If

                              LFlyOut: '
                                DumpAll
                                Print #11, "---"
                                Print #11, "LFlyOut possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
                                Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
                                Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
                                If gameBaserunners%(2, 0) <> 0 Then

                                    I4 = (batRating(P, playerNum%(P, gameBaserunners%(2, 0)), 16) - 5) * 25
                                    ZM = (batRating(D, playerX%(D, currFielder%), 15) - 5) * 25
                                    I4 = I4 - ZM

                                    RN = Int(Rnd(1) * 1000) + 1
                                    Print #11, "/\/\/\ LFlyOut Dice1000% = "; RN

                                    '-- These are ALL conditions for assigning the same value
                                    If currFielder% = 9 And event% = FLY_DEEP    And RN <= 800 + I4 And P2 <> 2 _
                                    Or currFielder% = 9 And event% = FLY_REGULAR And RN <= 400 + I4 And P2 <> 2 _ 
                                    Or currFielder% = 8 And event% = FLY_DEEP    And RN <= 700 + I4 And P2 <> 2 _ 
                                    Or currFielder% = 8 And event% = FLY_REGULAR And RN <= 350 + I4 And P2 <> 2 _ 
                                    Or currFielder% = 7 And event% = FLY_DEEP    And RN <= 250 + I4 And P2 <> 2 Then A5%(2) = 1

                                    If P2 = 2 And batRating(P, playerNum%(P, gameBaserunners%(2, 0)), 16) > 6 And currFielder% = 9 And event% = 17 And RN <= 400 + I4 Or P2 = 2 And batRating(P, playerNum%(P, gameBaserunners%(2, 0)), 16) > 6 And currFielder% = 8 And event% = 17 And RN <= 400 + I4 Then A5%(2) = 1

                                    If A5%(2) <> 1 And event% = FLY_REGULAR And P2 <> 2 And baseRunners% < BASE_2_3 Then

                                        If (currFielder% = 9 And RN > 800) Or (currFielder% = 8 And RN > 840) Then
                                            I8! = 3
                                            LN% = 3308
                                            If F% = 0 Then Call TRYFOREXTRABASE(LN%, event%, P2, Z2%, D, currFielder%, SAH%, SB%, I8!, I9)
                                        End If

                                        If currFielder% = 7 And P2 <> 2 And baseRunners% < BASE_2_3 And RN > 880 Then
                                            I8! = 3
                                            LN% = 3308
                                            If F% = 0 Then Call TRYFOREXTRABASE(LN%, event%, P2, Z2%, D, currFielder%, SAH%, SB%, I8!, I9)
                                        End If

                                    End If

                                End If

                                If gameBaserunners%(1, 0) <> 0 Then
                                    RN = Int(Rnd(1) * 1000) + 1
                                    A5%(1) = 0
                                    I3 = (batRating(P, playerNum%(P, gameBaserunners%(1, 0)), 16) - 5) * 25
                                    I4 = (batRating(D, playerX%(D, currFielder%), 15) - 5) * 25
                                    J5 = I3 - I4

                                    If event% = EVENT_FLY_DEEP And P2 <> 2 And baseRunners% = BASE_1 And RN <= 100 + J5 Then
                                        I8! = 2
                                        LN% = 3308
                                        If F% = 0 Then Call TRYFOREXTRABASE(LN%, event%, P2, Z2%, D, currFielder%, SAH%, SB%, I8!, I9)
                                    End If
                                    I8! = 2
                                    LN% = 3308
                                End If

                                Call ADVANCEMENT(P, D, event%, F%, I3)
                                GoTo LCheckForOptionsOrQuit

                            Case 34 To 100
                                ' *** regular fly out ***
                                event% = EVENT_FLY_REGULAR
                                Call WINDEX
                                X$ = fieldPos$(currFielder%)
                                If Int(Rnd(1) * 100) <= 25 And currFielder% = 7 Then X$ = "lcf"
                                If Int(Rnd(1) * 100) <= 25 And currFielder% = 9 Then X$ = "rcf"

                                Call DELIVERY(D)
                                Call d100(RN)

                                range = 90
                                min = 1070
                                If (currFielder% = 7 Or currFielder% = 9) And RN <= 10 Then X$ = "": range = 10: min = 1160

                                Call GetPBPString(range, min, Y$, D)
                                Call PBP(Y$ + " " + X$)

                                Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                                If F% = 1 Then Goto LCheckForOptionsOrQuit

                                '--- where does this end?
                                '--- can we turn into subroutine?
                              14025 '
                                DumpAll
                                Print #11, "---"
                                Print #11, "14025 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
                                Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
                                Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
                                Call CREDITREGPO(currFielder%, D)
                                Call CAUGHTFLY(RN, event%, D)

                                nbrOuts(0) = nbrOuts(0) + 1
                                nbrOuts(1) = nbrOuts(1) + 1

                                Call ADDPIT(D, currPitcher%(D), 0)
                                If nbrOuts(0) = 3 Then Goto LCheckForOptionsOrQuit

                                Call d100(RN)
                                Print #11, "/\/\/\ CAUGHTFLY Dice100% = "; RN

                                If event% = EVENT_FLY_SHALLOW And baseRunners% = BASE_1   And RN <= 33 And P2 = 2 _
                                Or event% = EVENT_FLY_SHALLOW And baseRunners% = BASE_1_3 And RN <= 33 Then
                                    A5%(1) = 10
                                    nbrOuts(0) = nbrOuts(0) + 1
                                    nbrOuts(1) = nbrOuts(1) + 1

                                    Call ADDPIT(D, I5, I6)

                                    D3%(D) = D3%(D) + 1
                                    DP%(D) = DP%(D) + 1

                                    Call CREDITASSIST(currFielder%, D)

                                    GoTo 14009

                                End If

                                If gameBaserunners%(3, 0) > 0 Then
                                    I8! = 4
                                    LN% = 3308
                                    If F% = 0 Then Call TRYFOREXTRABASE(LN%, event%, P2, Z2%, D, currFielder%, SAH%, SB%, I8!, I9)

                                End If

                                If I9 = 1 Then
                                    I9 = 0
                                    Call ADVANCEMENT(P, D, event%, F%, I3)
                                    GoTo LCheckForOptionsOrQuit
                                Else
                                    GoTo LFlyOut
                                End If

                        End Select

                    Case 74 To 89

                        ' infield popup
                        Call GETINFIELDER(currFielder%, P, I1, D, event%, P2)
                        event% = EVENT_INF_POPUP
                        Call WINDEX
                        Call d100(RN0)

                        If currFielder% = 1 Then currFielder% = 2: player$(4) = batters$(D, playerX%(D, currFielder%))
                        If (currFielder% = 2 Or currFielder% = 5 Or currFielder% = 3) And RN0 <= 30 Then fo% = 1

                        If fo% =  0 And (baseRunners% = BASE_1_2 Or baseRunners% = BASE_FULL) And nbrOuts(0) < 2 Then Call PBP("INFIELD FLY RULE CALLED")
                        If fo% =  1 And currFielder% = 2 Then range = 24: min = 180
                        If fo% =  1 And (currFielder% = 3 Or currFielder% = 4) Then range = 31: min = 210
                        If fo% =  1 And (currFielder% = 5 Or currFielder% = 6) Then range = 31: min = 250
                        If fo% <> 1 And currFielder% = 2 Then range = 50: min = 400
                        If fo% <> 1 And currFielder% = 3 Then range = 60: min = 450
                        If fo% <> 1 And currFielder% = 5 Then range = 60: min = 510
                        If fo% <> 1 And currFielder% = 6 Then range = 60: min = 570
                        If fo% <> 1 And currFielder% = 4 Then range = 60: min = 630

                        Call GetPBPString(range, min, Y$, D)
                        Call PBP(Y$)

                        If fo% = 1 And  currFielder% = 2 Then range = 12: min = 321
                        If fo% = 1 And (currFielder% = 3 Or currFielder% = 4) Then range = 25: min = 340
                        If fo% = 1 And (currFielder% = 5 Or currFielder% = 6) Then range = 25: min = 370
                        If fo% <> 1 Then range = 25: min = 690

                        Call GetPBPString(range, min, Y$, D)
                        Call PBP(Y$)

                        If fldPos%(P, currBatter!(P)) = 1 Then
                            Call INCPITOFF(P, currPitcher%(P), 23)
                        Else
                            Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
                        End If

                        If baseRunners% <> BASE_1_2 Then

                            Call d100(RN0)
                            If RN0 <= 25 And (teamRat_GAME(1, 13) = 11 Or teamRat_GAME(1, 13) = 8) Then Call PBP("fights the wind...")
                            If RN0 <= 15 And (teamRat_GAME(1, 13) = 2 Or teamRat_GAME(1, 13) = 4 Or teamRat_GAME(1, 13) = 13 Or teamRat_GAME(1, 13) = 24) Then Call PBP("fights the lights...")

                            If fo% <> 1 Then
                                Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                                If F% = 1 Then Goto LCheckForOptionsOrQuit
                            End If

                        End If

                        fo% = 0

                        Call PBP(player$(4) + " makes the catch")
                        Call CREDITREGPO(currFielder%, D)

                        nbrOuts(0) = nbrOuts(0) + 1
                        nbrOuts(1) = nbrOuts(1) + 1

                        Call ADDPIT(D, currPitcher%(D), 0)
                        GoTo LCheckForOptionsOrQuit

                    Case 90 To 100
                        event% = EVENT_RUNNER_DBLD

                        Call GETINFIELDER(currFielder%, P, I1, D, event%, P2)
                        Call WINDEX
                        Call DELIVERY(D)

                        Call GetPBPString(42, 70, Y$, D)
                        Call PBP(Y$)

                        Call GetPBPString(34, 120, Y$, D)
                        Call PBP(Y$)

                        If fldPos%(P, currBatter!(P)) = 1 Then
                            Call INCPITOFF(P, currPitcher%(P), 23)
                        Else
                            Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
                        End If

                        Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                        If F% = 1 Then Goto LCheckForOptionsOrQuit

                        nbrOuts(0) = nbrOuts(0) + 1
                        nbrOuts(1) = nbrOuts(1) + 1

                        Call CREDITREGPO(currFielder%, D)

                        Call ADDPIT(D, currPitcher%(D), 0)
                        If nbrOuts(0) = 3 Then Goto LCheckForOptionsOrQuit

                        Call d100(RN)

                        If (baseRunners% = BASE_1 Or baseRunners% = BASE_1_3) And RN >= 80 _
                        Or (baseRunners% = BASE_1 Or baseRunners% = BASE_1_3) And P2 = 2 Then

                            'runner doubled off of 1st
                            A5%(1) = 10
                            nbrOuts(0) = nbrOuts(0) + 1
                            nbrOuts(1) = nbrOuts(1) + 1

                            Call ADDPIT(D, I5, I6)

                            D3%(D) = D3%(D) + 1
                            DP%(D) = DP%(D) + 1

                            If currFielder% <> 3 Then
                                range = 10
                                min = 160
                            Else
                                range = 10
                                min = 170
                            End If

                            Call GetPBPString(range, min, Y$, D)
                            Call PBP(Y$)

                            I3 = 1
                            Call CREDITPUTOUT(I3, FB2P%, AST%, D)
                            Call PBP(" --- DOUBLE PLAY ---")
                            If currFielder% <> 3 Then Call CREDITASSIST(currFielder%, D)


                        Else

                            If (baseRunners% = BASE_1_2 Or baseRunners% = BASE_2) And RN >= 80 _
                            Or  baseRunners% = BASE_1_2 And P2 = 2 Then

                                'runner doubled off of 2nd
                                A5%(2) = 10
                                nbrOuts(0) = nbrOuts(0) + 1
                                nbrOuts(1) = nbrOuts(1) + 1

                                Call ADDPIT(D, I5, I6)

                                D3%(D) = D3%(D) + 1
                                DP%(D) = DP%(D) + 1
                                I3 = 2

                                Call CREDITPUTOUT(I3, FB2P%, AST%, D)
                                Call PBP(" --- DOUBLE PLAY ---")
                                Call CREDITASSIST(currFielder%, D)

                            End If

                        End If

                      14009 '
                        DumpAll
                        Print #11, "---"
                        Print #11, "14009 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
                        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
                        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
                        Call ADVANCEMENT(P, D, event%, F%, I3)
                        GoTo LCheckForOptionsOrQuit

                End Select

            End If

            event% = 13
            Call GETINFIELDER(currFielder%, P, I1, D, event%, P2)
            Call WINDEX

            event% = 13
            Call DELIVERY(D)
            Call GROUNDERPBP(currFielder%, D)

            If currFielder% <> 2 Then
                If currFielder% = 1 Then
                    pbpString$ = pbpString$ + "the pitcher"
                    Call PBP(pbpString$)
                Else
                    pbpString$ = pbpString$ + grounderDir$(currFielder%)
                    Call PBP(pbpString$)
                End If
            End If

            Call d100(RN)
            Print #11, "/\/\/\ 1764 Dice100% = "; RN

            If (baseRunners% = BASE_1 Or baseRunners% = BASE_1_2 _
                Or ((baseRunners% = BASE_FULL Or baseRunners% = BASE_1_3) _ 
                    And INFPOS% < INF_INFIELD_IN)) And nbrOuts(0) <= 1 And RN <= 50 Then
                DPC% = 1
                Call DPPBP
            End If

            If fldPos%(P, currBatter!(P)) <> 1 Then
                Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
            Else
                Call INCPITOFF(P, currPitcher%(P), 23)
            End If

            Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
            If F% = 1 Then Goto LCheckForOptionsOrQuit

            ' *** 2 outs, bases empty, runner 2nd, runner 3rd, or 2nd&3rd ***
            If nbrOuts(0) = 2 Or baseRunners% = BASE_EMPTY Or baseRunners% = BASE_2 Or baseRunners% = BASE_3 Or baseRunners% = BASE_2_3 Then Goto LGrounderToPitcher

            dice1000% = Int(Rnd(1) * 1000) + 1
            E2% = ((teamRat_GAME(D, TM_XX) - 80) * 4)
            E3% = ((5 - batRating(P, playerNum%(P, currBatter!(P)), 16)) * 9)

            If (currFielder% = 2 And dice1000% > 250 + E2% + E3%) Or (dice1000% > 490 + E2% + E3%) Or P2 = 2 Then Goto LGrounderToPitcher

            event% = 13

            If baseRunners% = BASE_1_2 Then

                If currFielder% = 5 And Int(Rnd(1) * 3) + 1 = 1 Then
                    A5%(3) = 0
                    A5%(2) = 11
                    A5%(1) = 0
                    A5%(0) = 0
                    GoTo LProcessOutAndDP
                End If

                If currFielder% = 2 Then
                    Call CREDITASSIST(currFielder%, D)
                    A5%(3) = 0
                    A5%(2) = 11
                    A5%(1) = 0
                    A5%(0) = 0
                    GoTo LProcessOutAndDP
                End If

            End If

            If baseRunners% = BASE_FULL And currFielder% = 1 Then
                Call CREDITASSIST(currFielder%, D)
                TB = 9
                currFielder% = 2
                Call PBP("He throws home")
                A5%(3) = 11
                A5%(1) = 0
                A5%(2) = 0
                A5%(0) = 0
                GoTo LProcessOutAndDP
            End If

            If baseRunners% = BASE_1_3 And gameScore(P, 0) - gameScore(D, 0) >= 0 And INNING% > 7 And nbrOuts(0) = 0 And INFPOS% > 0 And currFielder% = 5 Or baseRunners% = BASE_1_3 And gameScore(P, 0) - gameScore(D, 0) >= 0 And INNING% > 7 And nbrOuts(0) = 0 And INFPOS% > 0 And currFielder% = 3 Then
                GoTo LGrounderToPitcher
            End If

            If baseRunners% = BASE_FULL And INFPOS% > 0 And (currFielder% = 5 Or currFielder% = 3) Then
                Call CREDITASSIST(currFielder%, D)
                TB = 9
                currFielder% = 2
                Call PBP("He fires it home")
                A5%(3) = 11
                A5%(1) = 0
                A5%(2) = 0
                A5%(0) = 0
                GoTo LProcessOutAndDP
            End If

            If baseRunners% = BASE_FULL And INFPOS% = 2 And currFielder% = 4 Then
                Call CREDITASSIST(currFielder%, D)
                TB = 9
                currFielder% = 2
                Call PBP("He throws home for the force")
                A5%(3) = 11
                A5%(1) = 0
                A5%(2) = 0
                A5%(0) = 0
                GoTo LProcessOutAndDP
            End If

            If baseRunners% = BASE_FULL And INFPOS% = 2 And currFielder% = 6 Then
                Call CREDITASSIST(currFielder%, D)
                TB = 9
                currFielder% = 2
                Call PBP("He goes home with it")
                A5%(3) = 11
                A5%(1) = 0
                A5%(2) = 0
                A5%(0) = 0
                GoTo LProcessOutAndDP
            End If


            If currFielder% <= 4 Then
                Call CREDITASSIST(currFielder%, D)
                currFielder% = 6
                Call PBP("He throws to " + batters$(D, playerX%(D, POS_SS)))
            Else
                Call CREDITASSIST(currFielder%, D)
                currFielder% = 4
                Call PBP("He throws to " + batters$(D, playerX%(D, POS_2B)))
            End If

            A5%(1) = 11
            A5%(2) = 0
            A5%(3) = 0
            A5%(0) = 0

            If baseRunners% = BASE_FULL And (currFielder% = 2 Or currFielder% = 1) Then
                A5%(3) = 11
                A5%(2) = 1
                A5%(1) = 1
                A5%(0) = 1
            End If

            GoTo LProcessOutAndDP

        Else    ' A strikeout

            'Strikeout!
          LStrikeout: '
            DumpAll
            Print #11, "---"
            Print #11, "LStrikeout STRIKEOUT possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
           Call WINDEX
            ' Call pbpLog(2994)
            Call STRIKEOUT(nbrStrikes, D)

            currFielder% = 2
            Call CREDITREGPO(currFielder%, D)

            nbrOuts(0) = nbrOuts(0) + 1
            nbrOuts(1) = nbrOuts(1) + 1
            SO = 1

            If fldPos%(P, currBatter!(P)) <> 1 Then
                Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
                Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 8)
                If P2 = 2 Then nbrStrikes = 3
            End If

            Call ADDPIT(D, currPitcher%(D), LG_P_K)
            Call ADDPIT(D, currPitcher%(D), 0)

            If fldPos%(P, currBatter!(P)) = 1 Then
                Call INCPITOFF(P, currPitcher%(P), 23)
                Call INCPITOFF(P, currPitcher%(P), 31)
                If P2 = 2 Then nbrStrikes = 3
            End If

            If P2 = 2 And nbrOuts(0) < 3 Then
                SO = 7
                GoTo LSteal
            End If

            ' *** WILD PITCH OR PASSED BALL ON A STRIKEOUT
            RN = Int(Rnd(1) * 600) + 1
            Print #11, "/\/\/\ WP Dice600% = "; RN

            If gameBaserunners%(1, 0) = 0 And RN = 9 And SO = 1 Or nbrOuts(0) = 3 And RN = 9 Then

                nbrOuts(0) = nbrOuts(0) - 1
                nbrOuts(1) = nbrOuts(1) - 1
                I5 = currPitcher%(D)
                statPitcherGame%(D, I5, LG_P_IP3) = statPitcherGame%(D, I5, LG_P_IP3) - 1
                statPitcherLeague%(D, I5, 0) = statPitcherLeague%(D, I5, 0) - 1
                statBatterGame%(D, playerX%(D, POS_C), 16) = statBatterGame%(D, playerX%(D, POS_C), 16) - 1
                statBatterLeague%(D, playerX%(D, POS_C), 16) = statBatterLeague%(D, playerX%(D, POS_C), 16) - 1

                Call d100(I1)

                If I1 < 77 Then

                    '13230 / *** wild pitch ***
                    If baseRunners% = BASE_EMPTY And SO <> 1 Then
                        '13100 / *** fouled out of play ***
                        Call FOULBALL
                        GoTo LContinueBatter
                    Else
                        Call WILDPITCH(event%, D)
                        GoTo 13222
                    End If
                Else
                    GoTo LPassedBall
                End If

            End If

            '-- this should be an Else statement above?
            GoTo LCheckForOptionsOrQuit

        End If

    Else    ' base hit '
      Z_BaseHit: 'just a marker label for the base hit section

        dice1000% = Int(Rnd(1) * 1000) + 1
        Print #11, "/\/\/\ DOUBLE Dice1000% = "; dice1000%; ", 2BRating = "; liveBatRating%(P, LIVE_2B, currBatter!(P))

        If dice1000% <= liveBatRating%(P, LIVE_2B, currBatter!(P)) And P2 <> 2 _
        Or dice1000% <= liveBatRating%(P, LIVE_2B, currBatter!(P)) * .5 And P2 = 2 Then

            event% = EVENT_2B

            '3500
            ' *** double s2%=8 ***
            Call GETOUTFIELDER(currFielder%, P, I1, D)

            Call ADDPIT(D, currPitcher%(D), 1)
            Call WINDEX
            Call DELIVERY(D)

            If fldPos%(P, currBatter!(P)) <> 1 Then
                I5 = playerNum%(P, currBatter!(P))
                Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
                Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 1)
                Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 4)
            Else
                I5 = currPitcher%(P)
                Call INCPITOFF(P, currPitcher%(P), 23)
                Call INCPITOFF(P, currPitcher%(P), 24)
                Call INCPITOFF(P, currPitcher%(P), 27)
            End If

            If RN <= 40 Then

                If currFielder% = 7 Then
                    Call GetPBPString(40, 2900, Y$, D)
                    Call PBP(Y$)
                End If

                If currFielder% = 9 Then
                    Call GetPBPString(40, 2940, Y$, D)
                    Call PBP(Y$)
                End If

                If currFielder% = 8 Then
                    Call GetPBPString(40, 2980, Y$, D)
                    Call PBP(Y$)
                End If

                Call GetPBPString(30, 3020, Y$, D)
                Call PBP(Y$)

            Else
              Z_Double: 'just a marker label for the Double section
                Call d100(RN)
                Print #11, "/\/\/\ LONGFLY Dice100% = "; RN

                Select Case RN

                    Case Is <= 25
                        Call LONGFLY(D, currFielder%)
                        HW% = 1
                        Call WALLDOUBLE(HW%, currFielder%)

                    Case 26 To 50
                        Call LDRIVE(X$)
                        Call PBP(player$(0) + " " + X$ + " one to the gap in " + OUTFLDLOCATION$(currFielder%))

                    Case 51 To 60
                        Call PBP(player$(0) + " hits a sinking liner into " + OUTFLDLOCATION$(currFielder%))
                        Call PBP("It goes to the wall")

                    Case 61 To 75
                        Call PBP(player$(0) + " lines one to the alley in " + OUTFLDLOCATION$(currFielder%))

                    Case 76 To 85
                        If (currFielder% = 7 Or currFielder% = 9) Then
                            Call LDRIVE(X$)
                            Call PBP(player$(0) + " " + X$ + " one down the " + fieldPos$(currFielder%) + " line")
                            Call PBP("It rolls into the corner")
                        End If

                        If currFielder% = 8 Then
                            Call LDRIVE(X$)
                            Call PBP(player$(0) + " " + X$ + " one between the fielders")
                            Call PBP(player$(4) + " cuts it off...")
                        End If

                    Case 86 To 92
                        Call LDRIVE(X$)
                        Call PBP(player$(0) + " " + X$ + " a blue darter into " + fieldPos$(currFielder%))

                    Case 93 To 100
                        Call PBP(player$(0) + " lines one to " + OUTFLDLOCATION$(currFielder%))
                        Call PBP("It's down and to the wall!")

                End Select

            End If

            HW% = 0
            Call d100(RN0)

            If RN0 <= 80 Then
                pbpString$ = "Double!!"
            Else
                pbpString$ = "2-Bagger!!"
            End If

            Call PBP(pbpString$)

            For I = 0 To 3:
                A5%(I) = 2
            Next I

            '-- wtf?
            A5%(3) = 1

            If gameBaserunners%(1, 0) <> 0 Then

                Call d100(dice1000%)
                baserunning% = batRating(P, playerNum%(P, gameBaserunners%(1, 0)), 16)

                If fldPos%(P, gameBaserunners%(1, 0)) = 1 Then baserunning% = pitchRating(P, currPitcher%(P), 31)

                I3 = 0

                If nbrOuts(0) = 0 And currFielder% = 7 Then I3 = 18 + baserunning% * 3
                If nbrOuts(0) = 1 And currFielder% = 7 Then I3 = 16 + baserunning% * 3
                If nbrOuts(0) = 2 And currFielder% = 7 Then I3 = 34 + baserunning% * 3

                If nbrOuts(0) = 0 And currFielder% = 8 Then I3 = 37 + baserunning% * 3
                If nbrOuts(0) = 1 And currFielder% = 8 Then I3 = 44 + baserunning% * 3
                If nbrOuts(0) = 2 And currFielder% = 8 Then I3 = 65 + baserunning% * 3

                If nbrOuts(0) = 0 And currFielder% = 9 Then I3 = 12 + baserunning% * 3
                If nbrOuts(0) = 1 And currFielder% = 9 Then I3 = 18 + baserunning% * 3
                If nbrOuts(0) = 2 And currFielder% = 9 Then I3 = 40 + baserunning% * 3

                If dice1000% <= I3 Or P2 = 2 Then A5%(1) = 3

            End If

            Call ADVANCEMENT(P, D, event%, F%, I3)

            F% = 0
            Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
            If F% = 0 Then Call TRYFOREXTRABASE(LN%, event%, P2, Z2%, D, currFielder%, SAH%, SB%, I8!, I9)

            Call SCOREBOARD

            GoTo LCheckForOptionsOrQuit

        End If


      Z_Triple: 'just a marker label for the Triple section
        Print #11, "/\/\/\ TRIPLE Dice1000% = "; dice1000%; ", 3BRating = "; liveBatRating%(P, LIVE_2B, currBatter!(P)) + liveBatRating%(P, LIVE_3B, currBatter!(P))
        If dice1000% <= liveBatRating%(P, LIVE_2B, currBatter!(P)) + liveBatRating%(P, LIVE_3B, currBatter!(P)) And P2 <> 2 Or dice1000% <= liveBatRating%(P, LIVE_2B, currBatter!(P)) * .5 + liveBatRating%(P, LIVE_3B, currBatter!(P)) * .5 And P2 = 2 Then

            event% = EVENT_3B

            '3520
            ' *** TRIPLE event%=9 ***
            Call OUTFLDNAME(currFielder%, D)
            Call DELIVERY(D)
            Call WINDEX

            If fldPos%(P, currBatter!(P)) <> 1 Then
                Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
                Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 1)
                Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 5)
            Else
                Call INCPITOFF(P, currPitcher%(P), 23)
                Call INCPITOFF(P, currPitcher%(P), 24)
                Call INCPITOFF(P, currPitcher%(P), 28)
            End If

            Call ADDPIT(D, currPitcher%(D), 1)

            Call d100(RN)

            If RN <= 30 Then

                If currFielder% = 7 Then
                    Call GetPBPString(40, 2900, Y$, D)
                    Call PBP(Y$)
                End If

                If currFielder% = 9 Then
                    Call GetPBPString(40, 2940, Y$, D)
                    Call PBP(Y$)
                End If

                If currFielder% = 8 Then
                    Call GetPBPString(40, 2980, Y$, D)
                    Call PBP(Y$)
                End If

                Call GetPBPString(40, 3050, Y$, D)
                Call PBP(Y$)

                Call d100(RN)
                If RN <= 90 Then
                    pbpString$ = "Triple!!"
                Else
                    pbpString$ = "3-Bagger!"
                End If

                Call PBP(pbpString$)

            Else

                Call d100(RN)

                If RN <= 10 And currFielder% <> 8 Then

                    Call d100(RN)
                    X$ = "1st"
                    If currFielder% = 7 Then X$ = "3rd"

                    If RN <= 50 Then
                        Call PBP(player$(0) + " hits a hot smash")
                    Else
                        Call PBP(player$(0) + " lines one")
                    End If

                    Call PBP("Fair past " + X$ + "!!")
                    Call PBP("It rolls into the " + fieldPos$(currFielder%) + " corner")
                    Call PBP("It's a triple!!")

                Else

                    Call LONGFLY(D, currFielder%)
                    If currFielder% = 7 And teamRat_GAME(1, 13) = 27 Then
                        ad$ = "screen"
                    Else
                        ad$ = "wall"
                    End If

                    Call d100(BV)
                    Call d100(RN)
                    Select Case RN
                        Case 1 To 20
                            pbpString$ = "It one-hops the " + ad$ + "..."
                        Case 21 To 40
                            pbpString$ = "It's off the top of the " + ad$ + "..."
                        Case 41 To 60
                            Call PBP("It bounces fair"): pbpString$ = "down into the corner..."
                        Case 61 To 80
                            Call PBP("It's in the gap"): pbpString$ = "It rolls to the " + ad$
                        Case 81 To 99
                            pbpString$ = "It hits at the base of the " + ad$ + "..."
                        Case 100
                            pbpString$ = "The outfielders cross"
                    End Select

                    Call PBP(pbpString$)

                    Call d100(RN)
                    If RN <= 90 Then
                        pbpString$ = "Triple!!"
                    Else
                        pbpString$ = "3-Bagger!"
                    End If
                    Call PBP(pbpString$)

                End If

            End If

            A5%(0) = 3
            A5%(1) = 3
            A5%(2) = 2
            A5%(3) = 1

            Call ADVANCEMENT(P, D, event%, F%, I3)

            F% = 0
            Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
            If F% = 0 Then Call TRYFOREXTRABASE(LN%, event%, P2, Z2%, D, currFielder%, SAH%, SB%, I8!, I9)

            Call SCOREBOARD
            GoTo LCheckForOptionsOrQuit

        End If

        Call HITS2GAP(currFielder%, P, I1, D)

        DumpAll
        Print #11, "L2236 HITS2GAP: currFielder% ="; currFielder%; ", P ="; P; ", D ="; D; ", I1 ="; I1; ", dice1000% ="; dice1000%; ", E2% ="; E2%; ", P2 ="; P2; _IIF(D = 1, "Visiting", "Home") + " batting"

        I3 = liveBatRating%(P, LIVE_2B, currBatter!(P)) + liveBatRating%(P, LIVE_3B, currBatter!(P))

      Z_Hit2Gap: 'just a marker label for the Hit2Gap Run section    
        E2% = I3 + liveBatRating%(P, LIVE_HR, currBatter!(P))
        Print #11, "/\/\/\ HR Dice1000% = "; dice1000%; ", HRRating = "; E2%

        Print #11, "CF ?: E2% ="; E2%
        If currFielder% = 8 And dice1000% <= E2% And P2 <> 2 Or currFielder% = 8 And dice1000% <= E2% * .5 And P2 = 2 Then
            event% = EVENT_HR
            Print #11, "L2245 cf ?: dice1000% ="; dice1000%; ", E2% ="; E2%; ", P2 ="; P2
            GoTo LHomeRun
        End If

        E2% = I3 + liveBatRating%(P, LIVE_L_HR, currBatter!(P))
        Print #11, Using "LF ? E2 = ####  I3 = ####  HRbatRating = ####"; E2%, I3, liveBatRating%(P, LIVE_L_HR, currBatter!(P))    'righty batter or pitcher?'

        If currFielder% = 7 And dice1000% <= E2% And P2 <> 2 Or currFielder% = 7 And dice1000% <= E2% * .5 And P2 = 2 Then
            event% = EVENT_HR
            Print #11, "L2245 lf ?: dice1000% ="; dice1000%; ", E2% ="; E2%; ", P2 ="; P2
            GoTo LHomeRun
        End If

        E2% = I3 + liveBatRating%(P, LIVE_R_HR, currBatter!(P))
        Print #11, Using "RF ? E2 = ####  I3 = ####  HRbatRating = ####"; E2%, I3, liveBatRating%(P, LIVE_R_HR, currBatter!(P))    'lefty batter or pitcher?'

        If currFielder% = 9 And dice1000% <= E2% And P2 <> 2 Or currFielder% = 9 And dice1000% <= E2% * .5 And P2 = 2 Then
            event% = EVENT_HR
             Print #11, "L2245 rf ?: dice1000% ="; dice1000%; ", E2% ="; E2%; ", P2 ="; P2
           GoTo LHomeRun
        End If

      LDrawnInInfield: '
        DumpAll
        Print #11, "---"
        Print #11, "LDrawnInInfield possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)

        dice100% = 0
        Call d100(dice100%)
        event% = EVENT_1B

        Print #11, "/\/\/\ SINGLE Dice7500% = "; dice7500%; ", infPosFactor = "; infPosFactor; ", dice100 ="; dice100%; ", liveBatRating%(P, 0, currBatter!(P)) = "; "liveBA ="; liveBatRating%(P, 0, currBatter!(P))
        'If fldPos%(P, currBatter!(P)) = 1 Or dice7500% <= infPosFactor Then
        If fldPos%(P, currBatter!(P)) <> 1 And dice100% <= liveBatRating%(P, LIVE_BAvg, currBatter!(P)) And P2 <> 2 Then

          LSingle: '/ *** single ***
            DumpAll
            Print #11, "---"
            Print #11, "LSingle SINGLE possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            Call SINGLEROUTINE(currFielder%, P, I1, D, event%, P2)

            If event% = EVENT_PSBL_SINGLE Then

                Call SCOREBOARD
                GoTo LNextInning

            Else

                F% = 0
                Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                If F% = 0 Then Call TRYFOREXTRABASE(LN%, event%, P2, Z2%, D, currFielder%, SAH%, SB%, I8!, I9)

                Call SCOREBOARD
                GoTo LCheckForOptionsOrQuit

            End If

        End If

        Print #11, "/\/\/\ FLDERR Dice100% = "; dice100%; ", ErrRating = "; (batRating(P, playerNum%(P, currBatter!(1)), 16) * 2.5)
        If dice100% <= (batRating(P, playerNum%(P, currBatter!(1)), 16) * 2.5) Then
            event% = EVENT_PSBL_SINGLE
            Call GETINFIELDER(currFielder%, P, I1, D, event%, P2)
            Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
            If F% = 1 Then Goto LCheckForOptionsOrQuit
        End If

    End If


    '----- NOODLE -----

    DumpAll
    Print #11, "---"
    Print #11, "PUNTING possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Goto LProcessOutAndDP2

  LHomeRun: '
    DumpAll
    Print #11, "---"
    Print #11, "LHomeRun possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    ' *** HOME RUN event%=10 ***

    Call WINDEX

    If fldPos%(P, currBatter!(P)) <> 1 Then
        Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
        Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 1)
        Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 6)
    End If

    Call ADDPIT(D, currPitcher%(D), 1)

    If fldPos%(P, currBatter!(P)) = 1 Then
        Call INCPITOFF(P, currPitcher%(P), 23)
        Call INCPITOFF(P, currPitcher%(P), 24)
        Call INCPITOFF(P, currPitcher%(P), 29)
    End If

    Call d100(RN)

    If RN <= 80 Then

        Call LONGFLY(D, currFielder%)

        Call d100(RN)

        If RN <= 5 And teamRat_GAME(1, 13) = 8 And currFielder% = 7 Then Call PBP("THAT'S OUT OF THE PARK"): Call PBP("ON WAVELAND AVENUE!!!"): pbpString$ = "HOME RUN...HOLY COW!!!": GoTo LHomeRun2
        If RN <= 15 And teamRat_GAME(1, 13) = 8 And currFielder% = 7 Then Call PBP("IT'S GONE"): pbpString$ = "LAST SEEN BOUNCING DOWN WAVELAND AVENUE!!!": GoTo LHomeRun2
        If RN <= 25 Then

            '13580
            If teamRat_GAME(1, 13) = 21 And currFielder% = 7 Then Call PBP("IT CLEARS THE GREEN MONSTER!!"): pbpString$ = "HOME RUN!!!": GoTo LHomeRun2
            If teamRat_GAME(1, 13) = 27 And currFielder% = 7 Then Call PBP("IT CLEARS THE SCREEN!!"): pbpString$ = "HOME RUN!!!": GoTo LHomeRun2
            If teamRat_GAME(1, 13) = 33 And P = 1 Then Call PBP("ADIOS!! THAT'S A HOME RUN!!"): pbpString$ = "THE BUSCH EAGLE FLAPS ITS WINGS": GoTo LHomeRun2
            If teamRat_GAME(1, 13) = 25 And P = 1 Then Call PBP("IT'S OUT OF HERE FOR A HOMER!!!"): pbpString$ = "THERE GOES THE EXPLODING SCOREBOARD!": GoTo LHomeRun2
            If teamRat_GAME(1, 13) = 7 And currFielder% = 9 Then Call PBP("IT CLEARS THE WAGON GATE!!"): pbpString$ = "THAT'S A HOME RUN!!": GoTo LHomeRun2
            If teamRat_GAME(1, 13) = 7 And P = 1 Then Call PBP("ADIOS!! THAT'S A HOME RUN!!"): pbpString$ = "THERE GO THE CANNONS!!": GoTo LHomeRun2
            If teamRat_GAME(1, 13) = 8 Or teamRat_GAME(1, 13) = 40 Then pbpString$ = "IT CLEARS THE IVY FOR A HOME RUN!!": GoTo LHomeRun2
            If teamRat_GAME(1, 13) = 23 And (currFielder% = 7 Or currFielder% = 9) Then Call PBP("IT'S LONG, IT'S LONG, IT'S GONE!!"): pbpString$ = "THAT ONE'S IN THE UPPER DECK": GoTo LHomeRun2

            '13545
            Call d100(RN)
            Select Case RN
                Case 1 To 7
                    pbpString$ = "GOODBYE!! IT'S A HOME RUN!!"

                Case 8 To 14
                    pbpString$ = "ADIOS!! IT'S A HOME RUN !!!"

                Case 15 To 21
                    pbpString$ = "SAY GOOD-BYE TO THAT ONE!!!"

                Case 22 To 28
                    pbpString$ = "TOUCH 'EM ALL!!"

                Case 29 To 35
                    pbpString$ = "SEE YOU LATER!!"

                Case 36 To 42
                    pbpString$ = "GOOD-BYE MR. SPALDING!! HOME RUN!!!"

                Case 43 To 49
                    pbpString$ = "HOME RUN!! MY OH MY!!"

                Case 50 To 56
                    pbpString$ = "IT'S OVER THE WALL...OH DOCTOR!!!"

                Case 57 To 63
                    pbpString$ = "LONG, LONG, AND GONE!!"

                Case 64 To 70
                    pbpString$ = "HEY! HEY!...IT'S A HOME RUN !!!"

                Case 71 To 77
                    pbpString$ = "IT'S LONG, IT'S LONG, IT'S GONE!!!"

                Case 78 To 84
                    pbpString$ = "HOLY COW!! IT'S A HOME RUN!!!"

                Case 85 To 89
                    pbpString$ = "OPEN THE WINDOW AUNT MINNIE...HERE SHE COMES"

                Case 90 To 95
                    Call PBP("WAAYYY BACK..."): pbpString$ = "YOU CAN PUT IT ON THE BOARD, YYESSS!!"

                Case 96 To 100
                    Call PBP("IT'S WAY OUT OF HERE!! HOME RUN!!!"): pbpString$ = "HOW 'BOUT THAT!!!"

            End Select

        End If

    Else

        Call d100(RN)

        If RN <= 20 And (currFielder% = 7 Or currFielder% = 9) Then

            pbpString$ = player$(0) + " hits it down the " + fieldPos$(currFielder%) + " line"
            Call PBP(pbpString$)
            Call PBP("It's long enough if it's fair...")

        Else

            Call PBP(player$(0) + " swings...")

            Select Case RN
                Case 21 To 40
                    Call PBP("NO DOUBT ABOUT THAT ONE!!")
                    pbpString$ = "IT'S WAY OUT OF HERE!!"
                Case 41 To 60
                    pbpString$ = player$(4) + " CAN ONLY LOOK UP!!"
                Case 61 To 80
                    pbpString$ = pitchers$(D, currPitcher%(D)) + " WATCHES IT SAIL OUT!!"
                Case 81 To 90
                    pbpString$ = "GONE!!!"
                Case 91 To 100
                    pbpString$ = "SAINTS AND HAYRAKES, LOOK AT 'ER SAIL!!"
            End Select

            Call PBP(pbpString$)

        End If

        '3536 / modified
        pbpString$ = "HOME RUN!!"

    End If

    '---- WHERE IS HITS2GAP


  LHomeRun2: '
    DumpAll
    Print #11, "---"
    Print #11, "LHomeRun2 (POTENTIAL MYSTERY RUN???) possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Call PBP(pbpString$)
    Call DELAY

    '13544
    A5%(3) = 1
    A5%(2) = 2
    A5%(1) = 3
    A5%(0) = 4

    Call ADDPIT(D, currPitcher%(D), 14)

    Call ADVANCEMENT(P, D, event%, F%, I3)
    Call SCOREBOARD

    GoTo LCheckForOptionsOrQuit


    '----- NOODLE -----

  LProcessOutAndDP: '
    DumpAll
    Print #11, "---"
    Print #11, "LProcessOutAndDP possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)

    Call ADDPIT(D, currPitcher%(D), 0)

    nbrOuts(0) = nbrOuts(0) + 1
    nbrOuts(1) = nbrOuts(1) + 1
    player$(4) = batters$(D, playerX%(D, currFielder%))

    Call ADVANCEMENT(P, D, event%, F%, I3)
    Call CREDITREGPO(currFielder%, D)

    event% = EVENT_DP

    Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
    If F% = 1 Then Goto LCheckForOptionsOrQuit  'No double play'

    Call CREDITASSIST(currFielder%, D)

    If currFielder% = 5 And nbrOuts(0) < 2 And Int(Rnd(1) * 10) + 1 <= batRating(P, playerNum%(P, gameBaserunners%(1, 0)), 16) Then
        A5%(0) = 1
        A5%(1) = 11
        A5%(2) = 0
        A5%(3) = 0
        If nbrOuts(0) < 2 Then A5%(2) = 1: A5%(3) = 1
    Else
        A5%(0) = 11
        A5%(1) = 1
        A5%(2) = 0
        A5%(3) = 0
        If nbrOuts(0) < 2 Then A5%(2) = 1: A5%(3) = 1
    End If

    nbrOuts(0) = nbrOuts(0) + 1
    nbrOuts(1) = 2

    Call DPRELAY
    Call ADDPIT(D, currPitcher%(D), 0)
    Call ADVANCEMENT(P, D, event%, F%, I3)
    Call CREDITPUTOUT(I3, FB2P%, AST%, D)
    Call d100(RN)

    DPC% = 0
    If RN <= 80 Then
        pbpString$ = " --- DOUBLE PLAY ---"
    Else
        'RN > 80
        pbpString$ = " --- TWIN KILLING ---"
    End If
    Call PBP(pbpString$)

    DP%(D) = DP%(D) + 1
    D3%(D) = D3%(D) + 1
    TB = 0
    Call INCREMENTHIT(P, D, MO)

    GoTo LCheckForOptionsOrQuit


    '----- NOODLE -----


  LGrounderToPitcher: '
    DumpAll
    Print #11, "---"
    Print #11, "LGrounderToPitcher possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    If nbrOuts(0) >= 2 Then

        RN = Int(Rnd(1) * 10) + 1
        event% = 13

        If currFielder% = 5 Then

            If RN <= 5 And (baseRunners% = BASE_1_2 Or baseRunners% = BASE_FULL) Then

                Call PITCHERNAME(currFielder%, D)
                Call PBP(player$(4) + " gloves it and heads for 3rd")
                A5%(0) = 0
                A5%(1) = 0
                A5%(2) = 11
                A5%(3) = 0
                GoTo LProcessOutAndDP2

            Else

                Call PITCHERNAME(currFielder%, D)
                Call GROUNDERS(currFielder%, D)
                Call THROW2FIRST(D)
                A5%(0) = 11
                A5%(1) = 0
                A5%(2) = 0
                A5%(3) = 0
                '-- this may not be necessary since the next statement is looking for W = 4
                GoTo LProcessOutAndDP2

            End If

        End If

        If currFielder% = 6 Then

            If RN <= 8 And (baseRunners% = BASE_1 Or baseRunners% = BASE_1_2 Or baseRunners% = BASE_1_3 Or baseRunners% = BASE_FULL) Then
                Call PITCHERNAME(currFielder%, D)
                Call GROUNDERS(currFielder%, D)
                Call DPPIVOT(currFielder%, D)
                AST% = 6
                A5%(0) = 0
                A5%(1) = 11
                A5%(2) = 0
                A5%(3) = 0
                '-- this may not be necessary since the next statement is looking for W = 4
                GoTo LProcessOutAndDP2

            Else
                Call PITCHERNAME(currFielder%, D)
                Call GROUNDERS(currFielder%, D)
                Call THROW2FIRST(D)
                A5%(0) = 11
                A5%(1) = 0
                A5%(2) = 0
                A5%(3) = 0
                '-- this may not be necessary since the next statement is looking for W = 4
                GoTo LProcessOutAndDP2

            End If

        End If

        If currFielder% = 4 And RN <= 5 And (baseRunners% = BASE_1 Or baseRunners% = BASE_1_2 Or baseRunners% = BASE_1_3 Or baseRunners% = BASE_FULL) Then

            Call PITCHERNAME(currFielder%, D)
            Call GROUNDERS(currFielder%, D)
            Call DPPIVOT(currFielder%, D)
            AST% = 4
            A5%(0) = 0
            A5%(1) = 11
            A5%(2) = 0
            A5%(3) = 0

        Else

            Call d100(RN)

            If currFielder% = 3 Then

                If RN <= 94 Then

                    Call PITCHERNAME(currFielder%, D)
                    Call GROUNDERS(currFielder%, D)
                    Call PBP("He takes it to the bag unassisted")
                    fbun% = 1

                Else

                    Call PITCHERNAME(currFielder%, D)
                    Call GROUNDERS(currFielder%, D)
                    currFielder% = 1
                    Call PITCHERNAME(currFielder%, D)
                    Call PBP("He flips it to " + player$(4) + " covering")
                    FB2P% = 1
                    currFielder% = 3

                End If

            Else

                Call PITCHERNAME(currFielder%, D)
                Call GROUNDERS(currFielder%, D)
                Call SECOND2FIRST(D)

            End If

            Call PITCHERNAME(currFielder%, D)
            Call GROUNDERS(currFielder%, D)
            Call SECOND2FIRST(D)

            A5%(0) = 11
            A5%(1) = 0
            A5%(2) = 0
            A5%(3) = 0

        End If

      LProcessOutAndDP2: 'Call DELAY
        DumpAll
        Print #11, "LProcessOutAndDP2 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        If fbun% = 0 Then Call CREDITASSIST(currFielder%, D)
        fbun% = 0

        If DPC% = 1 And A5%(0) = 1 Then DPC% = 2

        Call ADVANCEMENT(P, D, event%, F%, I3)

        If DPC% = 2 Then
            DPC% = 0
            Call DPSAFE
        End If

        If I3 > 4 Then I3 = 1

        Call CREDITPUTOUT(I3, FB2P%, AST%, D)

        nbrOuts(0) = nbrOuts(0) + 1
        nbrOuts(1) = nbrOuts(1) + 1
        Call ADDPIT(D, currPitcher%(D), 0)

        GoTo LCheckForOptionsOrQuit

    Else

        Call d100(RN)
        If (RN <= 90 And P2 <> 2 Or baseRunners% = BASE_EMPTY) Or (RN <= 10 And P2 = 2) Then

            event% = 14

            If baseRunners% = BASE_EMPTY Or baseRunners% = BASE_2 Or baseRunners% = BASE_3 Or baseRunners% = BASE_2_3 Then
                A5%(0) = 11
                Call OUTATFIRST(currFielder%, D, fbun%, FB2P%)
                GoTo 13693
            End If

            Call d100(RN)

            A5%(0) = 1
            A5%(1) = 1
            A5%(2) = 1
            A5%(3) = 1

            If INFPOS% = 0 And currFielder% = 2 Then A5%(3) = 0
            If baseRunners% = BASE_1_3 Or baseRunners% = BASE_FULL Or baseRunners% = BASE_1_2 Then 13725

            A5%(1) = 11

            GoTo LProcessOutAndDP2

        End If

        event% = 13
        A5%(1) = 1
        A5%(2) = 1
        A5%(3) = 1
        A5%(0) = 11

        If Not (baseRunners% = BASE_1 Or baseRunners% = BASE_1_2 Or baseRunners% = BASE_1_3 Or baseRunners% = BASE_FULL) Then

            13693 '
            DumpAll
            Print #11, "13693 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            Call d100(RN)
            A5%(1) = 0
            A5%(2) = 0
            A5%(3) = 0

            If currFielder% = 5 And RN <= 25 And INFPOS% < INF_INFIELD_IN Then A5%(2) = 1
            If currFielder% = 5 And RN <= 83 And INFPOS% = INF_NORMAL Then A5%(3) = 1: ' WAS 50
            If currFielder% = 5 And RN <= 10 And INFPOS% > INF_NORMAL Then A5%(3) = 1

            If currFielder% = 5 And RN < 5 And INFPOS% < INF_INFIELD_IN And baseRunners% = BASE_2 And gameScore(P, 0) - gameScore(D, 0) > -2 Or currFielder% = 5 And RN < 5 And INFPOS% < 2 And baseRunners% = BASE_2_3 And A5%(3) = 1 And gameScore(P, 0) - gameScore(D, 0) > -2 Then
                A5%(2) = 11
                A5%(0) = 1
                Call PBP("NO, he's going to third")
            End If

            If currFielder% = 6 And RN <= 20 And INFPOS% < INF_INFIELD_IN Then A5%(2) = 1
            If currFielder% = 6 And RN <= 92 And INFPOS% < INF_INFIELD_IN Then A5%(3) = 1
            If currFielder% = 6 And RN <=  5 And INFPOS% = INF_INFIELD_IN Then A5%(3) = 1
            If currFielder% = 6 And RN <   6 And INFPOS% < INF_INFIELD_IN And baseRunners% = BASE_2 And gameScore(P, 0) - gameScore(D, 0) > -2 Or currFielder% = 6 And RN < 6 And INFPOS% < 2 And baseRunners% = BASE_2_3 And A5%(3) = 1 And gameScore(P, 0) - gameScore(D, 0) > -2 Then A5%(2) = 11: A5%(0) = 1: Call PBP("NO, he's going to third")
            If currFielder% = 4 And RN <= 90 And INFPOS% < INF_INFIELD_IN Then A5%(2) = 1
            If currFielder% = 4 And RN <= 90 And INFPOS% < INF_INFIELD_IN Then A5%(3) = 1
            If currFielder% = 4 And RN <= 65 And INFPOS% = INF_INFIELD_IN Then A5%(2) = 1
            If currFielder% = 4 And RN <=  5 And INFPOS% = INF_INFIELD_IN Then A5%(3) = 1
            If currFielder% = 3 And RN <= 95 Then A5%(2) = 1
            If currFielder% = 3 And RN <= 88 And INFPOS% = INF_NORMAL Then A5%(3) = 1: ' WAS 60
            If currFielder% = 3 And RN <= 15 And INFPOS% > INF_NORMAL Then A5%(3) = 1
            If currFielder% = 1 And RN <= 30 Then A5%(2) = 1
            If currFielder% = 1 And RN <= 50 And INFPOS% = INF_NORMAL Then A5%(3) = 1
            If currFielder% = 1 And RN <= 10 And INFPOS% > INF_NORMAL Then A5%(3) = 1
            If currFielder% = 2 And RN <= 45 Then A5%(2) = 1

        End If

        GoTo LProcessOutAndDP2

    End If

  13725 '
    DumpAll
    Print #11, "---"
    Print #11, "13725 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    If baseRunners% <> BASE_1_2 And baseRunners% <> BASE_FULL Then
        If gameScore(P, 0) - gameScore(D, 0) >= 0 And INNING% > 6 And nbrOuts(0) = 0 And INFPOS% > 0 And currFielder% = 5 Or gameScore(P, 0) - gameScore(D, 0) >= 0 And INNING% > 6 And nbrOuts(0) = 0 And INFPOS% > 0 And currFielder% = 3 Then

            A5%(3) = 11

        Else

            If INFPOS% = INF_NORMAL And currFielder% <> 2 Then A5%(1) = 11: GoTo LProcessOutAndDP2
            If INFPOS% > INF_NORMAL And currFielder% = 5 Or INFPOS% > 0 And currFielder% = 3 Then A5%(3) = 0: A5%(1) = 11: GoTo LProcessOutAndDP2
            If INFPOS% > INF_NORMAL And (currFielder% = 1 Or currFielder% = 3) Then A5%(3) = 0: A5%(1) = 1: A5%(0) = 11: GoTo LProcessOutAndDP2
            If INFPOS% = INF_INFIELD_IN And currFielder% = 4 Or INFPOS% = INF_INFIELD_IN And currFielder% = 6 And RN <= 90 Then
                A5%(3) = 0
                A5%(1) = 11
            Else
                A5%(1) = 11
            End If

        End If

    Else

        If currFielder% = 6 And RN < 6 And INFPOS% < INF_INFIELD_IN And INNING% < 9 Or currFielder% = 5 And RN < 6 And INFPOS% < INF_INFIELD_IN And INNING% < 9 Then
            A5%(2) = 11
        Else
            If baseRunners% = BASE_FULL Then

                Call d100(RN)
                A5%(1) = 11
                A5%(2) = 1
                A5%(3) = 1
                A5%(0) = 1

                If INFPOS% > INF_NORMAL And currFielder% = 5 Or INFPOS% > 0 And currFielder% = 3 Or INFPOS% = 2 And currFielder% = 4 Or INFPOS% = 2 And currFielder% = 6 Or currFielder% = 2 Or currFielder% = 1 Then
                    A5%(3) = 11
                    A5%(0) = 1
                    A5%(1) = 1
                    A5%(2) = 1
                Else
                    If currFielder% = 5 And RN <= 5 Or currFielder% = 1 Or currFielder% = 2 Then
                        A5%(3) = 11
                        A5%(2) = 1
                        A5%(1) = 1
                        A5%(0) = 1
                    End If
                End If

            Else

                RN = Int(Rnd(1) * 10) + 1

                A5%(0) = 1
                A5%(1) = 11
                A5%(2) = 1
                A5%(3) = 0

                If currFielder% = 5 And RN <= 5 Then A5%(1) = 1: A5%(2) = 11: A5%(3) = 0
                If currFielder% = 1 And RN <= 3 Then A5%(1) = 1: A5%(2) = 11: A5%(3) = 0

                If currFielder% = 2 And batRating(P, playerNum%(P, gameBaserunners%(2, 0)), 16) < 7 And batRating(P, playerNum%(P, gameBaserunners%(2, 0)), 16) > 0 Then
                    A5%(1) = 1
                    A5%(2) = 11
                    A5%(3) = 0
                Else
                    If currFielder% = 2 And batRating(P, playerNum%(P, gameBaserunners%(2, 0)), 16) > 6 Then
                        A5%(1) = 1
                        A5%(2) = 1
                        A5%(0) = 11
                    End If
                End If

            End If

        End If

    End If

    GoTo LProcessOutAndDP2


    '-----------------------------------------------------
    '--- THIS IS CRITICAL FOR PBP MOVING AUTOMATICALLY ---
    '-----------------------------------------------------
    ' Play-by-Play box
  LCheckForOptionsOrQuit: '
    DumpAll
    Print #11, "---"
    Print #11, "LCheckForOptionsOrQuit possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    If useVGA = 1 Then _PutImage (20 * FontColAdj, 48)-Step(44 * FontColAdj, 144), backupScreen&, imageScreen&, (20 * FontColAdj, 48)-Step(44 * FontColAdj, 144)

    ' essentially it allows the user to press a key
    ' during game play to activate certain functions
    ' or special menus, etc.
    I$ = InKey$

    If UCase$(I$) = "Q" Then
        Call EndOfGame
        Exit Sub
    End If

    If UCase$(I$) = "O" Then
        Call OPTIONS
    End If

    'There was some question as to whether this is needed
    'based on comparing to the original code, but the working
    'version of my code had this in it still
    If useVGA = 1 Then _PutImage (17 * FontColAdj, 128)-Step(46 * FontColAdj, 80), backupScreen&, imageScreen&, (17 * FontColAdj, 128)-Step(46 * FontColAdj, 80)

    DPC% = 0
    runnerHeld = 0
    INFPOS% = INF_NORMAL
    F% = 0
    H0%(0) = 0

    If nbrOuts(0) = 3 Then
        GoTo LStart
    Else
        GoTo LNextInning
    End If

    '----- NOODLE -----

  LBunt: ' *** BUNT ROUTINE ***
    DumpAll
    Print #11, "---"
    Print #11, "LBunt BUNT possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Call WINDEX

    Erase A5%

    SH = 2
    event% = 23

    If (baseRunners% = BASE_3 Or baseRunners% > BASE_1_2) And nbrOuts(0) < 2 Then Call SQUEEZECHOICE(SH)

    Call d100(RN)

    If fldPos%(P, currBatter!(P)) = 1 Then
        BR = pitchRating(P, currPitcher%(P), 32)
    Else
        BR = batRating(P, playerNum%(P, currBatter!(P)), 30)
    End If

    If INFPOS% > INF_NORMAL Then BR = BR - 2
    If BR <= 1 Then BR = 1

    For I = 1 To 9:
        If RN <= BT%(teamRat_GAME(1, TM_GRASS), BR, I) Then Exit For
    Next

    WW% = Int(Rnd(1) * 10)
    If WW% <= 2 Then currFielder% = 5
    If WW% > 2 And WW% <= 4 Then currFielder% = 1
    If WW% > 4 And WW% <= 7 Then currFielder% = 3
    If WW% > 7 Then currFielder% = 2
    Call GETFIELDNAME(currFielder%, D)

    Call d100(RN)

    If RN <= 52 Then 14175

    If I = 5 And SH = 1 Then I = 6

    'This I and the ones in the case statement
    'all have to do with the For-Next loop
    Select Case I

        Case 1
            'PU
            Call PBP(player$(0) + " bunts it in the air...")
            Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
            Call PBP(player$(4) + " makes the catch")
            Call ADDSTTS(P, D)

            nbrOuts(0) = nbrOuts(0) + 1
            nbrOuts(1) = nbrOuts(1) + 1
            Call CREDITREGPO(currFielder%, D)

            If nbrOuts(0) <> 3 And SH <> 2 Then
                '--- start of a new sub ???
                '--- where does 4111 end ???
              14111 '
                DumpAll
                Print #11, "---"
                Print #11, "14111 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
                Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
                Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
                If currFielder% <> 5 Then
                    Call CREDITASSIST(currFielder%, D)
                    currFielder% = 5
                    Call CREDITREGPO(currFielder%, D)
                    player$(5) = player$(4)
                    Call GETFIELDNAME(currFielder%, D)
                Else
                    Call CREDITASSIST(currFielder%, D)
                    currFielder% = 6
                    Call CREDITREGPO(currFielder%, D)
                    player$(5) = player$(4)
                    Call GETFIELDNAME(currFielder%, D)
                End If

                Call PBP(player$(5) + " throws to " + player$(4) + " at 3rd")
                A5%(3) = 10
                Call ADVANCEMENT(P, D, event%, F%, I3)
                nbrOuts(0) = nbrOuts(0) + 1
                nbrOuts(1) = nbrOuts(1) + 1

                Call ADDPIT(D, currPitcher%(D), 0)

                If SH = 1 Then
                    If nbrOuts(0) < 3 Then
                        GoTo LNextBatter
                    Else
                        'nbrOuts(0) >= 3
                        currBatter!(P) = currBatter!(P) - 1
                    End If
                End If

            End If

            GoTo LCheckForOptionsOrQuit

        Case 2
            'DP
            If baseRunners% = BASE_1 Or baseRunners% = BASE_1_2 Or baseRunners% = BASE_1_3 Or baseRunners% = BASE_FULL Then

                Call PBP(player$(0) + " lays down a good bunt")

                Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                If F% = 1 Then Goto LCheckForOptionsOrQuit

                Call PBP(player$(4) + " fields it cleanly")

                If SH = 1 And (baseRunners% = BASE_1_3 Or baseRunners% = BASE_FULL) Then

                    If currFielder% = 2 Then
                        Call PBP("and catches " + player$(3) + " heading home!")
                        Call CREDITREGPO(currFielder%, D)
                    Else
                        'currFielder% <> 2
                        Call PBP("and throws home to nail " + player$(3) + "!")
                        Call CREDITASSIST(currFielder%, D)
                        currFielder% = 2
                        Call CREDITREGPO(currFielder%, D)
                    End If

                    A5%(3) = 11

                    For I = 0 To 2: A5%(0) = 1: Next

                    '14122

                    Call ADDSTTS(P, D)
                    nbrOuts(0) = nbrOuts(0) + 1
                    nbrOuts(1) = nbrOuts(1) + 1
                    Call ADVANCEMENT(P, D, event%, F%, I3)
                    Call CREDITPUTOUT(I3, FB2P%, AST%, D)

                    GoTo LCheckForOptionsOrQuit

                End If

                If baseRunners% = BASE_FULL And nbrOuts(0) < 2 Then

                    A5%(3) = 11

                    If currFielder% = 2 Then
                        Call PBP("He steps on home for one...")
                        Call CREDITREGPO(currFielder%, D)
                        Call CREDITASSIST(currFielder%, D)
                    Else
                        'currFielder% <> 2
                        Call PBP("He throws home for the force")
                        Call CREDITASSIST(currFielder%, D)
                        currFielder% = 2
                        Call CREDITREGPO(currFielder%, D)
                        Call CREDITASSIST(currFielder%, D)
                    End If

                    Call ADVANCEMENT(P, D, event%, F%, I3)
                    Call PBP("Back to first...")

                    A5%(0) = 11

                    Call ADVANCEMENT(P, D, event%, F%, I3)
                    Call CREDITPUTOUT(I3, FB2P%, AST%, D)
                    Call PBP("DOUBLE PLAY!!")

                    nbrOuts(0) = nbrOuts(0) + 2
                    nbrOuts(1) = nbrOuts(1) + 2

                    Call ADDSTTS(P, D)

                    Call ADDPIT(D, currPitcher%(D), 0)

                    If nbrOuts(0) < 3 Then
                        A5%(2) = 1
                        A5%(1) = 1
                        Call ADVANCEMENT(P, D, event%, F%, I3)
                    End If

                    GoTo LCheckForOptionsOrQuit

                End If

                Call PBP("He throws to 2nd")
                Call CREDITASSIST(currFielder%, D)

                A5%(1) = 11

                Call ADDSTTS(P, D)

                nbrOuts(0) = nbrOuts(0) + 1
                nbrOuts(1) = nbrOuts(1) + 1
                Call ADVANCEMENT(P, D, event%, F%, I3)
                Call CREDITPUTOUT(I3, FB2P%, AST%, D)

                If nbrOuts(0) < 3 Then

                    A5%(0) = 11
                    Call CREDITASSIST(currFielder%, D)

                    A5%(2) = 1
                    Call PBP("over to first...")
                    Call ADVANCEMENT(P, D, event%, F%, I3)
                    Call PBP("DOUBLE PLAY!!")
                    Call CREDITPUTOUT(I3, FB2P%, AST%, D)

                    nbrOuts(0) = nbrOuts(0) + 1
                    nbrOuts(1) = nbrOuts(1) + 1
                    Call ADDPIT(D, currPitcher%(D), 0)
                End If

                GoTo LCheckForOptionsOrQuit

            Else
                Call PBP(player$(0) + " lays down the bunt...")
                Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                Call PBP(player$(4) + " makes a nice fielding play")
                Call CREDITASSIST(currFielder%, D): A5%(0) = 11
                If SH = 1 And (baseRunners% = BASE_3 Or baseRunners% = BASE_2_3) Then A5%(3) = 11: For I = 0 To 2: A5%(I) = 1: Next

                '14122
                Call ADDSTTS(P, D)
                nbrOuts(0) = nbrOuts(0) + 1
                nbrOuts(1) = nbrOuts(1) + 1
                Call ADVANCEMENT(P, D, event%, F%, I3)
                Call CREDITPUTOUT(I3, FB2P%, AST%, D)
                GoTo LCheckForOptionsOrQuit
            End If

        Case 3
            Call LDRNRCTDN
            GoTo LCheckForOptionsOrQuit

        Case 4
          LSacrifice: 'SHGOOD
            DumpAll
            Print #11, "---"
            Print #11, "LSacrifice SH possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            Call PBP(player$(0) + " lays down a good bunt...")
            Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
            Call PBP(player$(4) + " makes a nice play")

            If baseRunners% = BASE_EMPTY Then

                event% = -12
                Call PBP(player$(0) + " beats out an infield hit!")
                GoTo LSingle

            Else
                '-- turn this into a unique sub?
                '-- or direct other code to this loop
                '-- with a value of 4 and a 'skip' variable
              LSacrifice2: '
                DumpAll
                Print #11, "---"
                Print #11, "LSacrifice2 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"; _IIF(D = 1, "Visiting", "Home") + " batting"
                Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
                Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)

                Call ADDPIT(D, currPitcher%(D), 15)

                If fldPos%(P, currBatter!(P)) = 1 Then
                    Call INCPITOFF(P, currPitcher%(P), 40)
                Else
                    Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 18)
                End If

                Call d100(RN)

                If baseRunners% = BASE_1_3 And SH = 2 And RN > 98 Or RN > 97 Then
                    event% = -12
                    Call PBP(player$(0) + " beats it out!")
                    GoTo LSingle
                End If

                A5%(0) = 11

                Call PBP("The only play is to first")

                Call ADDPIT(D, currPitcher%(D), 0)

                nbrOuts(0) = nbrOuts(0) + 1
                nbrOuts(1) = nbrOuts(1) + 1

                Call CREDITASSIST(currFielder%, D)
                Call ADVANCEMENT(P, D, event%, F%, I3)
                Call CREDITPUTOUT(I3, FB2P%, AST%, D)

                If nbrOuts(0) < 3 Then
                    For I = 1 To 3: A5%(I) = 1: Next
                    Call ADVANCEMENT(P, D, event%, F%, I3)
                End If

            End If

            GoTo LCheckForOptionsOrQuit

        Case 5
          14150 'C@3
            DumpAll
            Print #11, "---"
            Print #11, "14150 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            Call d100(RN)
            If fldPos%(P, currBatter!(P)) = 1 Then
                RR = 2
            Else
                RR = batRating(P, playerNum%(P, currBatter!(P)), 16)
            End If

            If INFPOS% > INF_NORMAL Then RR = RR - 2
            If RR <= 2 Then RR = 2

            For I = 0 To 2
                If RN <= CF%(RR, I) Then Exit For
            Next

            'This I has to do with the above For-Next
            Select Case I + 1
                Case 1

                    If baseRunners% > BASE_EMPTY Then 14157
                    Call PBP(player$(0) + " drops it right down the line")
                    Call PBP(player$(4) + " lets it roll...")
                    Call PBP(player$(0) + " is trying for 2nd!!")
                    Call PBP(player$(4) + " fields and throws too late!!")
                    Call PBP("You won't see that play very often")

                    A5%(0) = 2
                    Call ADDPIT(D, currPitcher%(D), 1)

                    If fldPos%(P, currBatter!(P)) <> 1 Then
                        I5 = playerNum%(P, currBatter!(P))
                        Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 1)
                        Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 4)
                        Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
                    Else
                        Call INCPITOFF(P, currPitcher%(P), 23)
                        Call INCPITOFF(P, currPitcher%(P), 24)
                        Call INCPITOFF(P, currPitcher%(P), 27)
                    End If

                    Call ADVANCEMENT(P, D, event%, F%, I3)
                    Call SCOREBOARD

                    GoTo LCheckForOptionsOrQuit

                Case 2
                  14157 '
                    DumpAll
                    Print #11, "---"
                    Print #11, "14157 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
                    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
                    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
                    event% = 12
                    Call PBP(player$(0) + " lays down a great bunt...")

                    Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                    If F% = 1 Then Goto LCheckForOptionsOrQuit

                    Call PBP(player$(4) + " fields... but too late!")
                    event% = -12
                    GoTo LSingle

                Case 3
                    GoTo LSacrifice

            End Select

        Case 6
            'PLYLDBS
            If fldPos%(P, currBatter!(P)) = 1 Then RR = 2
            If fldPos%(P, currBatter!(P)) <> 1 Then RR = batRating(P, playerNum%(P, currBatter!(P)), 16)
            If INFPOS% > INF_NORMAL Then RR = RR - 2
            If RR <= 2 Then RR = 2

            If baseRunners% = BASE_EMPTY Then 14150
            If baseRunners% = BASE_1 Then I3 = 1: J3$ = "2nd"
            If baseRunners% = BASE_2 Or baseRunners% = BASE_1_2 Then I3 = 2: J3$ = "3rd"
            If baseRunners% = BASE_3 Or baseRunners% > BASE_1_2 Then I3 = 3: J3$ = "home"

            Call PBP(player$(0) + " gets the bunt down...")

            Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
            If F% = 1 Then Goto LCheckForOptionsOrQuit

            Call PBP(player$(4) + " fields it quickly...")
            Call PBP("Looks like a close play at " + J3$ + "!!")
            Call PBP("1- Throw to " + J3$ + " 2- Throw to 1st")

            If playerMode = 2 Or playerMode = 1 And P <> compTeam Then
                I$ = "1"
            Else
                Do
                    I$ = GetKeyPress$
                    I5 = Val(I$)
                Loop Until I5 >= 1 And I5 <= 2
            End If

            If I5 = 2 Then Goto LSacrifice2

            Call d100(RN)

            For I = 0 To 1
                If RN <= LB%(RR, I) Then Exit For
            Next

            'This I has to do with the above For-Next
            If I = 0 Then
                PLB = 1
                Call LDRNRCTDN
            Else
                Call PBP(player$(4) + " throws to " + J3$ + "... SAFE!!")

                If fldPos%(P, currBatter!(P)) <> 1 Then
                    Call INCBATOFF(P, playerNum%(P, currBatter!(P)), 0)
                Else
                    Call INCPITOFF(P, currPitcher%(P), 23)
                End If

                For I = 0 To 3:
                    A5%(I) = 1
                Next

                Call ADVANCEMENT(P, D, event%, F%, I3)
            End If

            GoTo LCheckForOptionsOrQuit

        Case 7
            'FLKSO
            Call d100(RN)

            If pitchRating(D, currPitcher%(D), SS_P_IP)= 0 Then
                BR = 0
            Else
                BR = pitchRating(D, currPitcher%(D), SS_P_K) / pitchRating(D, currPitcher%(D), SS_P_IP)
            End If

            If BR <= 4 Then PR = 5
            If BR > 4 And BR <= 5.4 Then PR = 4
            If BR > 5.4 And BR <= 6.9 Then PR = 3
            If BR > 6.9 And BR <= 8.4 Then PR = 2
            If BR > 8.4 And BR <= 11.9 Then PR = 1
            If BR > 11.9 Then PR = 0

            For I = 0 To 2
                If RN <= SO%(PR, I) Then Exit For
            Next

            'This I has to do with the above For-Next
            Select Case I + 1

                Case 1
                    GoTo LStrikeout

                Case 2
                    nbrStrikes = nbrStrikes + 1

                    Call WINDEX

                    Call d100(RN)
                    pbpString$ = player$(0) + " "
                    If RN <= 13 Or SH = 1 And RN <= 42 Then pbpString$ = pbpString$ + "misses the pitch"
                    If RN > 13 And RN <= 42 And SH <> 1 Then pbpString$ = pbpString$ + "takes a called strike"
                    If RN > 42 Then pbpString$ = pbpString$ + "bunts it foul"
                    Call PBP(pbpString$)

                    If useVGA = 1 Then
                        PrintOnGfx 63, 28, Str$(nbrStrikes), imageScreen&
                    Else
                        Locate 2, 58: Print nbrStrikes
                    End If

                    If nbrStrikes = 3 Then Goto LStrikeout

                    If SH = 1 And RN <= 42 Then
                        currFielder% = 2
                        Call GETFIELDNAME(currFielder%, D)
                        GoTo 14111
                    End If

                    If nbrStrikes = 1 Then
                        Call PBP("He has" + Str$(nbrStrikes) + " strike")
                    Else
                        'nbrStrikes > 1
                        Call PBP("He has" + Str$(nbrStrikes) + "strikes")
                    End If
                    Call PBP(pbpString$)

                    If baseRunners% = BASE_1_2 Or baseRunners% = BASE_2 Then INFPOS% = INF_NORMAL

                    If useVGA = 1 Then
                        _PutImage (20 * FontColAdj, 48)-Step(44 * FontColAdj, 128), backupScreen&, imageScreen&, (20 * FontColAdj, 48)-Step(44 * FontColAdj, 128)
                    End If

                    GoTo LContinueBatter2

                Case 3
                    GoTo LSacrifice

            End Select

        Case 8
            'TFPLY
            Call PBP(player$(0) + " lays down the bunt...")
            Call PBP(player$(4) + " has a tough play")

            Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
            If F% = 1 Then Goto LCheckForOptionsOrQuit

            If currFielder% = 1 Then RR = 3
            If currFielder% <> 1 Then RR = batRating(D, playerX%(D, currFielder%), 17)
            If INFPOS% > INF_NORMAL And baseRunners% <> BASE_EMPTY Then RR = RR + 1 + teamRat_GAME(1, TM_GRASS)
            If INFPOS% > INF_NORMAL And baseRunners% =  BASE_EMPTY Then RR = RR     + teamRat_GAME(1, TM_GRASS)
            If INFPOS% = INF_NORMAL And baseRunners% =  BASE_EMPTY Then RR = RR - 1
            If RR > 11 Then RR = 11
            If RR < 0 Then RR = 0

            Call d100(RN)

            For I = 0 To 2
                If RN <= triplePlayAdj(RR, I) Then Exit For
            Next

            'This I has to do with the above For-Next
            Select Case I + 1
                Case 1:
                    event% = 12
                    Call PBP("but too late...base hit!")
                    GoTo LSingle

                Case 2:
                    PLB = 1
                    Call LDRNRCTDN
                    GoTo LCheckForOptionsOrQuit

                Case 3:
                    GoTo LSacrifice2

            End Select

        Case 9
          14175 '
            DumpAll
            Print #11, "---"
            Print #11, "14175 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            nbrStrikes = nbrStrikes + 1

            Call WINDEX
            Call d100(RN)

            pbpString$ = player$(0) + " "
            If RN <= 13 Or SH = 1 And RN <= 42 Then pbpString$ = pbpString$ + "misses the pitch"
            If RN > 13 And RN <= 42 And SH <> 1 Then pbpString$ = pbpString$ + "takes a called strike"
            If RN > 42 Then pbpString$ = pbpString$ + "bunts it foul"
            Call PBP(pbpString$)

            If useVGA = 1 Then
                PrintOnGfx 63, 28, Str$(nbrStrikes), imageScreen&
            Else
                Locate 2, 58: Print nbrStrikes
            End If

            If nbrStrikes = 3 Then
                GoTo LStrikeout
            End If

            If SH = 1 And RN <= 42 Then currFielder% = 2: Call GETFIELDNAME(currFielder%, D): GoTo 14111

            If nbrStrikes = 1 Then
                Call PBP("He has" + Str$(nbrStrikes) + " strike")
            Else
                'nbrStrikes > 1
                Call PBP("He has" + Str$(nbrStrikes) + "strikes")
            End If

            If baseRunners% = BASE_1_2 Or baseRunners% = BASE_2 Then INFPOS% = INF_NORMAL

            If useVGA = 1 Then _PutImage (20 * FontColAdj, 48)-Step(44 * FontColAdj, 128), backupScreen&, imageScreen&, (20 * FontColAdj, 48)-Step(44 * FontColAdj, 128)

            GoTo LContinueBatter2

    End Select

    '-- at this point, each selection in the Case statement
    '-- should have directed the code somewhere else
    '-- in essence, this is kind of the end of this code


    '--------------------


  LSteal: '
    DumpAll
    Print #11, "---"
    Print #11, "LSteal possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    SH% = 0
    event% = 16
    currFielder% = 1
    player$(4) = pitchers$(D, currPitcher%(D))

    Select Case baseRunners%
        Case BASE_EMPTY
            GoTo LNextBatter
            'set a "skip" variable here

        Case BASE_1, BASE_1_3

            TGTBASE% = 2

            If P2 <> 2 Then

                Call WINDEX
                SB% = 1
                Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                SB% = 0

                If F% = 1 Then
                    currBatter!(P) = currBatter!(P) - 1
                    Call WHOSON1ST(baseRunners%)
                    GoTo LCheckForOptionsOrQuit
                End If

            End If

        Case BASE_2, BASE_1_2

            TGTBASE% = 3

            If P2 <> 2 Then

                Call WINDEX
                SB% = 1
                Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)
                SB% = 0

                If F% = 1 Then
                    currBatter!(P) = currBatter!(P) - 1
                    Call WHOSON1ST(baseRunners%)
                    GoTo LCheckForOptionsOrQuit
                End If

            End If

        Case BASE_3, BASE_2_3, BASE_FULL
            TGTBASE% = 4

    End Select

    I2 = playerNum%(P, gameBaserunners%(TGTBASE% - 1, 0))
    For I3 = 1 To 2
        A5%(I3) = 1
        A5%(3) = 0
    Next I3

    Call STEALCHANCE(AA, I2, TGTBASE%, CHANCE%)
    If fldPos%(P, gameBaserunners%(TGTBASE% - 1, 0)) = 1 Then CHANCE% = 0

    'Reduce chance for stealing home
    If TGTBASE% = 4 Then CHANCE% = CHANCE% * .05

    If batRating(P, I2, SS_B_CS) > 0 Then Q0 = Int((batRating(P, I2, SS_B_SB) / (batRating(P, I2, SS_B_SB) + batRating(P, I2, SS_B_CS))) * 1000): GoTo 14813
    If batRating(P, I2, SS_B_SB) > 31 Then Q0 = 700 + ((batRating(P, I2, SS_B_SB) - 30) * 2): GoTo 14813
    If batRating(P, I2, SS_B_SB) > 10 Then Q0 = 600 + ((batRating(P, I2, SS_B_SB) - 10) * 10): GoTo 14813
    If batRating(P, I2, SS_B_SB) > 0 Then Q0 = 400 + ((batRating(P, I2, SS_B_SB) * 20))
    Q0 = 100

  14813 '
    DumpAll
    Print #11, "---"
    Print #11, "14813 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    If fldPos%(P, gameBaserunners%(TGTBASE% - 1, 0)) = 1 Then Q0 = 100

    Call STEAL3RD(TGTBASE%, AA, Q0, runnerHeld, D) ' *** SUCCESS OF 3B STEAL ***

    If pitchRating(D, currPitcher%(D), SS_P_Throws)= 1 And TGTBASE% = 2 Then CHANCE% = CHANCE% + 25: Q0 = Q0 + 10
    If pitchRating(D, currPitcher%(D), SS_P_Throws)= -1 And TGTBASE% = 2 Then CHANCE% = CHANCE% - 50: Q0 = Q0 - 30
    If P2 = 2 Then

        CHANCE% = 100
        Q0 = Q0 - 200
        currFielder% = 2
        player$(4) = batters$(D, playerX%(D, POS_C))
        TGBASE% = playerNum%(P, gameBaserunners%(TGTBASE% - 1, 0))
        gameBaserunners%(TGTBASE% - 1, 2) = 18

        Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)

        If F% = 1 Then
            Call INCBATOFF(P, TGBASE%, 9)
            currBatter!(P) = currBatter!(P) - 1
            Call STRIKEOUTCS(SO)
            GoTo LCheckForOptionsOrQuit
        Else
            GoTo LDoubleSteal2
        End If

    End If

    gameBaserunners%(TGTBASE% - 1, 2) = gameBaserunners%(TGTBASE% - 1, 2) + 1

    Call d100(I4)

    If I4 <= gameBaserunners%(TGTBASE% - 1, 2) Then

        event% = 22
        currFielder% = 1
        player$(4) = pitchers$(D, currPitcher%(D))

      14820 '
        DumpAll
        Print #11, "---"
        Print #11, "14820 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        Call WINDEX
        Call PBP(player$(TGTBASE% - 1) + " caught off base in a rundown!")

        A5%(1) = 0
        A5%(2) = 0
        A5%(3) = 0
        A5%(TGTBASE% - 1) = 11

        nbrOuts(0) = nbrOuts(0) + 1
        nbrOuts(1) = nbrOuts(1) + 1
        Call PUTOUT(TGTBASE%, P)
        Call ADVANCEMENT(P, D, event%, F%, I3)
        Call CREDITPUTOUT(I3, FB2P%, AST%, D)

        Call ADDPIT(D, currPitcher%(D), 0)

        If nbrOuts(0) >= 3 Then
            currBatter!(P) = currBatter!(P) - 1
            GoTo LCheckForOptionsOrQuit
        End If

        INFPOS% = INF_NORMAL

        GoTo LNextBatter

    End If

    '----------------------------------------
    '-- this is the start a new large area of code
    '-- perhaps it could become a sub?
    '----------------------------------------

    '14825
    'RUNNER HAS A CHANCE TO STEAL
    gameBaserunners%(TGTBASE% - 1, 2) = gameBaserunners%(TGTBASE% - 1, 2) + 17
    I9 = Int(Rnd(1) * 1000) + 1

    If I9 > CHANCE% * 1.388 And D5 <> 3 Then

        Call WINDEX
        Call NOJUMP(D)

        If useVGA = 1 Then _PutImage (17 * FontColAdj, 128)-Step(46 * FontColAdj, 80), backupScreen&, imageScreen&, (17 * FontColAdj, 128)-Step(46 * FontColAdj, 80)

        GoTo LOffenseOptions

    End If

  LStealHome: '
    DumpAll
    Print #11, "---"
    Print #11, "LStealHome possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Call WINDEX
    TGBASE% = playerNum%(P, gameBaserunners%(TGTBASE% - 1, 0))

    Call GetPBPString(20, 3090, Y$, D)
    Call PBP(Y$)

    Call GetPBPString(13, 3110, Y$, D)
    Call PBP(Y$)

    Call PITCHOUT(baseRunners%, TGTBASE%, Q0)

    If baseRunners% <> BASE_1_3 Then Goto LDoubleSteal ' *** DOUBLE STEAL ***1st&3rd

    If SH% = 1 Then
        I9 = Int(Rnd(1) * 1000) + 1
    Else
        If playerMode = 2 Or playerMode = 1 And P <> compTeam Then
            I$ = "Y"
        Else
            Call PBP("Throw to 2B? (Y/N) ")
            I$ = GetKeyPress$
        End If

        If UCase$(I$) <> "Y" Then PJ = 7: GoTo 14829

      LDoubleSteal: '
        DumpAll
        Print #11, "---"
        Print #11, "LDoubleSteal possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        currFielder% = 2
        player$(4) = batters$(D, playerX%(D, POS_C))

        Call FLDERR(F%, currFielder%, D, I3, SB%, event%, P)

        If F% = 1 Then

            Call INCBATOFF(P, TGBASE%, 9)
            Call PITSWAP(TGTBASE%)
            currBatter!(P) = currBatter!(P) - 1
            GoTo LCheckForOptionsOrQuit

        End If

      LDoubleSteal2: '
        DumpAll
        Print #11, "---"
        Print #11, "LDoubleSteal2 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        Call WHICHRUNNER(TGTBASE%, baseRunners%, D5)
        I9 = Int(Rnd(1) * 1000) + 1
        Q0 = Q0 - ((batRating(D, playerX%(D, POS_C), 15) - 5) * 25)

    End If

    RN = Int(Rnd(1) * 11) + 1
    If TGTBASE% <> 4 Then
        If RN = 1 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " rifles it to " + baseName$(TGTBASE%)
        If RN = 2 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " fires it to " + baseName$(TGTBASE%)
        If RN = 3 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " unloads it"
        If RN = 4 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " is up and firing"
        If RN = 5 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " comes up firing"
        If RN = 6 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " lets it fly"
        If RN = 7 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " throws down"
        If RN = 8 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " gets it off"
        If RN = 9 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " fires a missile"
        If RN = 10 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " throws quickly"
        If RN = 11 Then pbpString$ = batters$(D, playerX%(D, POS_C)) + " throws"
        Call PBP(pbpString$)
    End If

    If Not (gameBaserunners%(TGTBASE% - 1, 2) = 18 And I9 > Q0 Or gameBaserunners%(TGTBASE% - 1, 2) > 18 And I9 > Q0 - 200) Then

        14829
        Call d100(RN)
        Select Case RN
            Case 1 To 20: pbpString$ = "He beats the throw!"
            Case 21 To 40: pbpString$ = "He's in there!"
            Case 41 To 50: pbpString$ = "Throw is off-line..."
            Case 51 To 60: pbpString$ = "Throw is high..."
            Case 61 To 80: pbpString$ = "He slides under the tag!"
            Case 81 To 100:
                If TGTBASE% <> 4 Then
                    pbpString$ = gameUmpire$(TGTBASE% + 1) + " with the call"
                Else
                    pbpString$ = gameUmpire$(1) + " with the call"
                End If
        End Select

        Call PBP(pbpString$)
        Call PBP("safe @ " + baseName$(TGTBASE%) + "!")

        gameBaserunners%(TGTBASE% - 1, 2) = 0
        INFPOS% = INF_NORMAL
        Call PITSWAP(TGTBASE%)
        Call ADVANCEMENT(P, D, event%, F%, I3)

        Call INCBATDF(D, playerX%(D, POS_C), 20)

        If SH% <> 1 Then

            If Not (baseRunners% <> BASE_1_3 Or baseRunners% = BASE_1_3 And PJ = 7) Then
                PJ = 0
                TGTBASE% = 4
                SS% = Int(Rnd(1) * 20) + 1

                If SS% = 6 Then
                    GoTo 14820
                Else
                    GoTo 14831
                End If
            Else
                GoTo 14831
            End If
        Else
            SH% = 0
            GoTo LNextBatter
        End If

    End If

    Call d100(RN)

    Select Case RN
        Case 1 To 20
            pbpString$ = batters$(D, playerX%(D, POS_C)) + " nails " + player$(TGTBASE% - 1)

        Case 21 To 40
            pbpString$ = player$(TGTBASE% - 1) + " is pegged at " + baseName$(TGTBASE%)

        Case 41 To 60
            pbpString$ = "Great throw by " + batters$(D, playerX%(D, POS_C)) + "!!"

        Case 61 To 80
            pbpString$ = player$(TGTBASE% - 1) + " slides into the tag"

        Case 81 To 100
            If TGTBASE% <> 4 Then
                pbpString$ = gameUmpire$(TGTBASE% + 1) + " with the call"
            Else
                'TGTBASE% = 4
                pbpString$ = gameUmpire$(1) + " with the call"
            End If
    End Select

    Call PBP(pbpString$)

    A5%(TGTBASE% - 1) = 11
    INFPOS% = INF_NORMAL

    Call INCBATOFF(P, playerNum%(P, gameBaserunners%(TGTBASE% - 1, 0)), 10)

    Call ADDPIT(D, currPitcher%(D), 0)

    nbrOuts(0) = nbrOuts(0) + 1
    nbrOuts(1) = nbrOuts(1) + 1
    currFielder% = 2

    Call CREDITASSIST(currFielder%, D)
    Call ADVANCEMENT(P, D, event%, F%, I3)
    Call CREDITPUTOUT(I3, FB2P%, AST%, D)

    Call INCBATDF(D, playerX%(D, POS_C), 21)

    If nbrOuts(0) >= 3 Then
        currBatter!(P) = currBatter!(P) - 1
        Call STRIKEOUTCS(SO)
        GoTo LCheckForOptionsOrQuit
    End If

  14831 '
    DumpAll
    Print #11, "---"
    Print #11, "14831 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    If nbrOuts(0) >= 3 Or P2 = 2 And nbrStrikes = 3 Then
        GoTo LCheckForOptionsOrQuit
    End If

    If SH% = 1 Then
        SH% = 0
        GoTo LNextBatter
    End If

    If AA < 20 Or baseRunners% <> BASE_1_3 Or fldPos%(P, gameBaserunners%(3, 0)) = 1 Then
        GoTo LNextBatter
    End If

    Call WINDEX

    If playerMode = 2 Or playerMode = 1 And P = compTeam Then
        I$ = "N"
    Else
        Call PBP("TRY TO STEAL HOME? (Y/N)")
        I$ = GetKeyPress$
    End If

    If UCase$(I$) = "Y" Then

        GoTo LNextBatter

    Else
        SH% = 1
        TGTBASE% = 4
        A5%(1) = 0
        A5%(2) = 0
        A5%(3) = 1
        I2 = playerNum%(P, gameBaserunners%(TGTBASE% - 1, 0))
        CHANCE% = 100
        Q0 = 700

        GoTo LStealHome ' *** STEAL HOME ***

    End If


    '----------------------------------------
    '-- this is a major area of code, but
    '-- it's also short. perhaps it could
    '-- be made into a subroutine?
    '----------------------------------------

  LStayInGame: '
    DumpAll
    Print #11, "---"
    Print #11, "LStayInGame possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Cls

    If useVGA = 0 Then Screen 0

    P9 = D
    currBatter!(P) = currBatter!(P) + 1
    nbrStrikes = 0

    If currBatter!(P) = 10 Then currBatter!(P) = 1

    Color 15
    Print "DOES "; batters$(D, playerNum%(D, playerX%(D, POS_DH))); " STAY IN THE GAME? (Y/N)"
    I$ = GetKeyPress$

    If UCase$(I$) = "N" Then

        I5 = 77

    Else

        I5 = 66

        Locate 5, 1

        For I = 1 To 9:

            Color 3, 0
            If BP(P9) = I Then Color 9
            Locate I + 4, 5: Print Using "# "; I;

            If fldPos%(P9, I) = 1 Then
                If I5 = 66 Then
                    Print batters$(P9, playerNum%(P9, I));
                Else
                    Print pitchers$(P9, playerNum%(P9, I));
                End If
            Else
                Print batters$(P9, playerNum%(P9, I));
            End If

            Print " "; fieldPos$(fldPos%(P9, I));
            Color 3

        Next I

        I5 = 0

        Do
            Color 15
            Locate 3, 1: Print "WHAT LINEUP SLOT WILL THE PITCHER BAT IN (1-9)"
            I$ = GetKeyPress$
            I2 = Val(I$)
        Loop Until I2 >= 1 And I2 <= 9

        If fldPos%(D, I2) = 10 Then fldPos%(D, I2) = 1

        INFPOS% = INF_NORMAL
        fldPos%(D, playerX%(D, POS_DH)) = fldPos%(D, I2)
        playerX%(D, fldPos%(D, playerX%(D, POS_DH))) = playerNum%(D, playerX%(D, POS_DH))
        fldPos%(D, I2) = 1

        Call REPLACEMENTS(D, playerX%(D, POS_DH), playerNum%(D, playerX%(D, POS_DH)))

        I5 = 66

    End If

    GoTo LChangePitcher


    '-----------------------------------
    '-----      PERSONNEL MENU     -----
    '-----------------------------------
    '-- make this into a subroutine?!?!

  LPersonnelMenu: '
    Print #11, "---"
    Print #11, "LPersonnelMenu possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Cls
    If useVGA = 1 Then Screen 0
    TG = 0
    PG = 0
    RG = 0
    Color 12: Print Tab(33); "PERSONNEL MENU": Print
    Color 14: Print "(0) ";
    Color 15: Print "RESUME PLAY": Print
    Color 14: Print "(1) ";
    Color 15: Print "RELIEF PITCHER": Print
    Color 14: Print "(2) ";
    Color 15: Print "CHANGE BATTER/FIELDER"

  15501 '
    DumpAll
    Print #11, "---"
    Print #11, "15501 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Do
        I$ = GetKeyPress$
        I = Val(I$)
        I5 = 0
    Loop Until I >= 0 And I <= 2

    'This I has to do with the above key loop
    Select Case I + 1

        Case 1  'Resume Play'
          LChangeNobody: '
            Print #11, "---"
            Print #11, "LChangeNobody possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            For I = 1 To 9
                If fldPos%(P9, I) <> 1 Then
                    batRating(P9, playerNum%(P9, I), 21) = 1
                End If
            Next I

            If useVGA = 1 Then
                Call LOADSCREEN
                Call DisplayBallField_Gfx(nbrBalls, P, nbrStrikes, D)
            Else
                Call DisplayBallField(nbrBalls, P, nbrStrikes, D)
            End If

            GoTo LNextBatter

        Case 2  'Relief Pitcher'
          LChangePitcher: '
            Print #11, "---"
            Print #11, "LChangePitcher possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            If P2 = 5 Then Call TIRING(P9): GoTo 15501

            Do

                Call PITDISP(P9)
                Locate 24, 1: Print "SELECT RELIEVER (Z = NO CHANGE)   ";
                If playerX%(P9, 1) <> 99 Then Call TIRING(P9)
                Print

                Do

                    I$ = GetKeyPress$
                    If UCase$(I$) = "Z" Then
                        GoTo LPersonnelMenu
                    Else
                        Call LetterToNumber(I$, I1)
                    End If

                Loop Until I1 <= 21 And pitchRating(P9, I1, SS_P_WP) <= 0

                Locate 23, 1: Print String$(78, 32)
                Locate 23, 1: Print "YOU CHOSE "; pitchers$(P9, I1); " "; handed$(pitchRating(P9, I1, SS_P_Throws) + 2); " - ";

                Print "ARE YOU SURE? (Y/N)";
                I$ = GetKeyPress$

            Loop Until UCase$(I$) = "Y"

            flagPinchHitter = 0
            flagPinchRunner% = 0

            If S1%(P9) <> -1 And gamePitcher%(P9) > 1 Then 
                Call OFFPIT(P9, currPitcher%(P9), 22)
            End If

            currPitcher%(P9) = I1
            gamePitcher%(P9) = gamePitcher%(P9) + 1
            pitchRating(P9, I1, SS_P_WP) = gamePitcher%(P9)
            Call PITSTAM(P9)
            Call CHECKSAVE(D, P, baseRunners%)

          15518 '
            Print #11, "---"
            Print #11, "15518 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            P9 = 1 - P9
            W5 = P9
            W6 = W5
            VV(P9) = 1
            VV1(P9) = 9
            Call HITTINGLINES

            P9 = 1 - P9

            If Not (desigHit = 1 Or I5 = 66 Or I5 = 77) Then

                'No Designated Hitter

                Do

                    Cls
                    Locate , 14
                    Color 14: Print "DO YOU WISH TO MAKE A FLIP FLOP OR DOUBLE SWITCH? (Y/N)";
                    Color 15

                    I$ = GetKeyPress$

                Loop Until UCase$(I$) = "Y" Or UCase$(I$) = "N"

                If UCase$(I$) = "Y" Then

                    Cls
                    Call DisplayBatter_Lineup(PG, P9)

                    Call CHANGELINEUP(P9, P)

                    Do
                        Locate 12, 30: Print "LINEUP SLOT FOR PITCHER TO BAT IN (1-9)"

                        I$ = GetKeyPress$
                        If Asc(I$) = 32 And PG = 0 Then PG = 1: Cls: Call DisplayBatter_Lineup(PG, P9): Call CHANGELINEUP(P9, P)
                        If Asc(I$) = 32 And PG = 1 Then PG = 0: Cls: Call DisplayBatter_Lineup(PG, P9): Call CHANGELINEUP(P9, P)
                        If Asc(I$) = 9 And TG = 0 Then Call DisplayFielding_Lineup(PG, P9, TG): Call CHANGELINEUP(P9, P)
                        If Asc(I$) = 9 And TG = 1 Then TG = 0: Call DisplayBatter_Lineup(PG, P9): Call CHANGELINEUP(P9, P)
                        V2 = Val(I$)
                    Loop Until V2 >= 1 And V2 <= 9


                    Do
                        Locate 13, 30
                        Print "WHO WILL REPLACE "; batters$(D, playerNum%(D, V2)); " @ "; fieldPos$(fldPos%(D, V2));

                        I$ = GetKeyPress$
                        If Asc(I$) = 32 And PG = 0 Then PG = 1: Call DisplayBatter_Lineup(PG, P9)
                        If Asc(I$) = 32 And PG = 1 Then PG = 0: Call DisplayBatter_Lineup(PG, P9)

                        If Asc(I$) = 9 And TG = 0 Then Call DisplayFielding_Lineup(PG, P9, TG)
                        If Asc(I$) = 9 And TG = 1 Then TG = 0: Call DisplayBatter_Lineup(PG, P9)

                        Call LetterToNumber(I$, V3)

                    Loop Until V3 <= 22

                    Locate 16, 29: Print batters$(D, V3)
                    Locate 17, 29: Print "ARE YOU SURE? (Y/N)";

                    I$ = GetKeyPress$

                    If UCase$(I$) = "Y" Then

                        gameD0%(D) = gameD0%(D) + 1
                        X0%(D, 0, gameD0%(D)) = V3
                        X0%(D, 1, gameD0%(D)) = fldPos%(D, V2)

                        For V0 = 1 To 9
                            If fldPos%(D, V0) = 1 Then X0%(D, 2, gameD0%(D)) = (V0 * 10) + (gameD0%(D) - 9)
                        Next V0

                        For V0 = 1 To 9
                            If fldPos%(D, V0) = 1 Then
                                fldPos%(D, V0) = fldPos%(D, V2)
                                playerNum%(D, V0) = V3
                                playerX%(D, fldPos%(D, V0)) = V3
                                P9 = D
                                W5 = D
                                W6 = D
                                VV(D) = V0
                                VV1(D) = V0
                                Call HITTINGLINES
                            End If
                            VV(D) = 1
                            VV1(D) = 9
                        Next V0

                        batRating(D, V3, 21) = 1
                        I7% = D
                        I8% = V2
                        I9% = V3

                        Call REPLACEMENTS(I7%, I8%, I9%)

                        I5 = 0

                        For V0 = 1 To 9
                            If V0 = V2 Then
                                fldPos%(D, V2) = 1
                                playerNum%(D, V2) = currPitcher%(D)
                                playerX%(D, POS_P) = currPitcher%(D)
                                VV(D) = V0
                                VV1(D) = V0
                                Call HITTINGLINES
                            End If
                        Next V0

                        VV(D) = 1
                        VV1(D) = 9

                        GoTo LPersonnelMenu 'Back to personnel menu

                    Else

                        GoTo 15518

                    End If

                End If

            End If

            I5 = 0

            For V0 = 1 To 9

                If fldPos%(D, V0) = 1 Or fldPos%(D, V0) = 10 Then

                    playerNum%(D, V0) = currPitcher%(D)
                    playerX%(D, POS_P) = currPitcher%(D)
                    fldPos%(D, V0) = 1
                    P9 = D
                    W5 = D
                    W6 = D
                    VV(D) = V0
                    VV1(D) = V0

                    Call HITTINGLINES

                    VV(D) = 1
                    VV1(D) = 9
                    GoTo LPersonnelMenu

                End If

            Next V0

            GoTo LChangeBatterFielder

        Case 3  'Change Batter/Fielder'

            '--- START OF A SHORT SUB
            '-- ChangeBatterFielder

          LChangeBatterFielder: '
            Print #11, "---"
            Print #11, "LChangeBatterFielder Change Batter/Fielder possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            Cls
            Call DisplayBatter_Lineup(PG, P9)
            Call CHANGELINEUP(P9, P)

            Locate 14, 29
            Color 12: Print "SELECT:"
            Locate , 30
            Color 14: Print " (1) ";
            Color 15: Print "SELECT A PINCH-HITTER"
            Locate , 30
            Color 14: Print " (2) ";
            Color 15: Print "SWAP POSITIONS BETWEEN PLAYERS"
            Locate , 30
            Color 14: Print " (3) ";
            Color 15: Print "SUBSTITUTE PLAYER IN LINEUP"
            Locate , 30
            Color 14: Print " (Z) ";
            Color 15: Print "RESUME PLAY"
            Locate , 30
            Color 14: Print "<SPACE> ";
            Color 15: Print "TOGGLE ROSTER";
            Color 14: Print " <TAB> ";
            Color 15: Print "TOGGLE FIELDING/BATTING"

          15547 '
            Print #11, "---"
            Print #11, "15547 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            I$ = GetKeyPress$
            If Asc(I$) = 32 And PG = 0 Then PG = 1: Call DisplayBatter_Lineup(PG, P9): GoTo 15547
            If Asc(I$) = 32 And PG = 1 Then PG = 0: Call DisplayBatter_Lineup(PG, P9): GoTo 15547
            If Asc(I$) = 9 And TG = 0 Then Call DisplayFielding_Lineup(PG, P9, TG): GoTo 15547
            If Asc(I$) = 9 And TG = 1 Then TG = 0: Call DisplayBatter_Lineup(PG, P9): GoTo 15547
            If UCase$(I$) = "Z" Then Goto LPersonnelMenu
            I1 = Val(I$)

            If I1 = 2 Then

              15567 '
                Print #11, "---"
                Print #11, "15567 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
                Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
                Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
                Do
                    Locate 20, 29: Print "B.O. #1 (1-9)"
                    I$ = GetKeyPress$
                    I1 = Val(I$)
                Loop Until I1 >= 1 And I1 <= 9 Or fldPos%(P9, I1) <> 1

                Do
                    Locate 21, 29: Print "B.O. #2 (1-9)"
                    I$ = GetKeyPress$
                    I2 = Val(I$)
                Loop Until I1 >= 1 And I1 <= 9 Or fldPos%(P9, I2) <> 1

                I3 = fldPos%(P9, I2)
                fldPos%(P9, I2) = fldPos%(P9, I1)
                fldPos%(P9, I1) = I3
                playerX%(P9, fldPos%(P9, I1)) = playerNum%(P9, I1)
                playerX%(P9, fldPos%(P9, I2)) = playerNum%(P9, I2)

                I7% = P9
                I8% = I2: I9% = playerNum%(P9, I2)
                Call REPLACEMENTS(I7%, I8%, I9%)

                I7% = P9
                I8% = I1
                I9% = playerNum%(P9, I1)
                Call REPLACEMENTS(I7%, I8%, I9%)

                GoTo LChangeBatterFielder

            End If

            If I1 = 3 Then 15550
            If D2 = 6 Then 15550
            I2 = currBatter!(P): GoTo 15555

            For I5 = 20 To 23: Locate I5, 28
                Print Space$(52)
            Next I5

            Return

            '--- END OF A SHORT SUB

    End Select

  15550 '
    DumpAll
    Print #11, "---"
    Print #11, "15550 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Do
        Locate 20, 30: Print "LINEUP SLOT TO REPLACE (1-9) (Z)=NO CHANGE"

        I$ = GetKeyPress$
        If Asc(I$) = 32 And PG = 0 Then PG = 1: Call DisplayBatter_Lineup(PG, P9): Call CHANGELINEUP(P9, P)
        If Asc(I$) = 32 And PG = 1 Then PG = 0: Call DisplayBatter_Lineup(PG, P9): Call CHANGELINEUP(P9, P)
        If Asc(I$) = 9 And TG = 0 Then Call DisplayFielding_Lineup(PG, P9, TG): Call CHANGELINEUP(P9, P)
        If Asc(I$) = 9 And TG = 1 Then TG = 0: Call DisplayBatter_Lineup(PG, P9): Call CHANGELINEUP(P9, P)
        If UCase$(I$) <> "Z" Then I2 = Val(I$)

    Loop Until I2 >= 1 And I2 <= 9 And Not (P9 = D And fldPos%(P9, I2) = 1) Or UCase$(I$) = "Z"


    If UCase$(I$) <> "Z" Then

        Locate , 30
        If fldPos%(P9, I2) = 1 Then Print pitchers$(P9, currPitcher%(P9));
        If fldPos%(P9, I2) <> 1 Then Print batters$(P9, playerNum%(P9, I2));

      15555 '
        DumpAll
        Print #11, "---"
        Print #11, "15555 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        Do
            Locate 22, 30: Print "# OF SUB"

            I$ = GetKeyPress$
            If Asc(I$) = 32 And PG = 0 Then PG = 1: Call DisplayBatter_Lineup(PG, P9): Call CHANGELINEUP(P9, P)
            If Asc(I$) = 32 And PG = 1 Then PG = 0: Call DisplayBatter_Lineup(PG, P9): Call CHANGELINEUP(P9, P)
            If Asc(I$) = 9 And TG = 0 Then Call DisplayFielding_Lineup(PG, P9, TG): Call CHANGELINEUP(P9, P)
            If Asc(I$) = 9 And TG = 1 Then TG = 0: Call DisplayBatter_Lineup(PG, P9): Call CHANGELINEUP(P9, P)
            Call LetterToNumber(I$, I1)

        Loop Until I1 <= 22 Or batRating(P9, I1, 21) <= 0

        Do
            Locate 23, 30
            Print batters$(P9, I1); "... ARE YOU SURE? (Y/N)"
            I$ = GetKeyPress$
        Loop Until UCase$(I$) = "N" Or UCase$(I$) = "Y"


        If UCase$(I$) <> "N" Then

            batRating(P9, I1, 21) = 1
            playerNum%(P9, I2) = I1
            playerX%(P9, fldPos%(P9, I2)) = I1

            If fldPos%(P9, I2) = 1 Or fldPos%(P9, I2) = 10 Then playerX%(P9, 1) = 99: playerX%(P9, 0) = I2: fldPos%(P9, I2) = 10

            gameD0%(P9) = gameD0%(P9) + 1
            X0%(P9, 0, gameD0%(P9)) = playerNum%(P9, I2)
            X0%(P9, 1, gameD0%(P9)) = fldPos%(P9, I2)
            X0%(P9, 2, gameD0%(P9)) = (I2 * 10) + (gameD0%(P9) - 9)
            W5 = P9
            W6 = P9
            VV(P9) = I2
            VV1(P9) = I2
            I7% = P9
            I8% = I2
            I9% = I1

            Call REPLACEMENTS(I7%, I8%, I9%)
            Call HITTINGLINES

            VV(P9) = 1
            VV1(P9) = 9

        End If

    End If

    GoTo LChangeBatterFielder

    '----- NOODLE -----

    '----------------------------------------
    ' Print final score and run post game
    ' routines (scoreboard, stats, etc.)
    '----------------------------------------

  LGameOver: '
    Print #11, "---"
    Print #11, "LGameOver possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)

    normalFinish = 1

    'Print winning team and score
    If gameScore(0, 0) > gameScore(1, 0) Then
        Call PBP(gameTeams$(0) + " defeats " + gameTeams$(1) + Str$(gameScore(0, 0)) + " TO" + Str$(gameScore(1, 0)) + "!")
    Else
        Call PBP(gameTeams$(1) + " defeats " + gameTeams$(0) + Str$(gameScore(1, 0)) + " TO" + Str$(gameScore(0, 0)) + "!")
    End If

    If autoPlay <> 1 Or playerMode <> 2 Then
        If pbpDelay! = 0 Then pbpDelay! = 0.1
        'Delay of 0 will not present the text
        'But we want to be sure the user sees it
        Call PBP("PRESS ANY KEY TO CONTINUE")
        I$ = GetKeyPress$
    End If

    Call EndOfGame
    Exit Sub


    '----------------------------------------
    '           END OF GAME!!!
    '----------------------------------------

    '================================================================================
    ' Below are all the different GoTo branches for the gameplay
    ' These have not yet been worked out into a different flow
    ' yet for the game's logic.
    '================================================================================

    '-- This can join the code above as there's only one branch to it
  LEndOfGame: '
    DumpAll
    Print #11, "---"
    Print #11, "LEndOfGame possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    runnerHeld = 0
    If useVGA = 1 Then
        Call HOLDSTATUS_G(runnerHeld)
    Else
        Call HOLDSTATUS(runnerHeld)
    End If

    ourLead = gameScore(D, 0) - gameScore(P, 0)

    If Not (ourLead > 1 Or baseRunners% = BASE_3 Or baseRunners% >= BASE_2_3) Then

        If baseRunners% <> BASE_1 And baseRunners% <> BASE_1_3 Then
            I2 = 2
        Else

            I2 = 1
            J = gameBaserunners%(I2, 0)

            If J <> 0 Then

                If fldPos%(P, J) <> 1 Then

                    If fldPos%(P, J) <> 1 And batRating(P, playerNum%(P, J), 13) >= 10 Then
                        runnerHeld = 1
                        If useVGA = 1 Then
                            Call HOLDSTATUS_G(runnerHeld)
                        Else
                            Call HOLDSTATUS(runnerHeld)
                        End If
                    End If

                End If

            End If

        End If

    End If

    If SU(D, 0) <> -1 And MG%(D, MGR_USE_BOTH_SETUP_CLOSER) =  0 And INNING% =  MG%(D, MGR_INN_CLOSE_STRATEGY) Then Call PITSTRAT(flagPinchHitter, pz)
    If SU(D, 1) <> -1 And MG%(D, MGR_USE_BOTH_SETUP_CLOSER) =  0 And INNING% >  MG%(D, MGR_INN_CLOSE_STRATEGY) Then Call PITSTRAT(flagPinchHitter, pz)
    If SU(D, 1) <> -1 And MG%(D, MGR_USE_BOTH_SETUP_CLOSER) <> 0 And INNING% >= MG%(D, MGR_INN_CLOSE_STRATEGY) Then Call PITSTRAT(flagPinchHitter, pz)

    If pz = 1 Then pz = 0: GoTo LManageDefense

    ourLead = gameScore(D, 0) - gameScore(P, 0)
    Call d100(RN)

    If Not (INNING% < 9 Or CZ%(D) = -1 Or MG%(D, MGR_CLOSE_STRATEGY) = 999) Then

        CZ%(D) = -1

        If ourLead <= 3 And ourLead >= 0 Then

            If gamePitcher%(D) <> 1 Then
                Call d100(RN)
                If RN <= 80 And pitchRating(D, currPitcher%(D), SS_P_Sv) < 15 Then 
                    GK%(D) = 1   'new reliever'
                    Print #11, Using "NEW RELIEVER 1 Inning: ##  ourLead: ##  gamePitcher ##  saves: ##"; _
                        INNING%, ourLead, gamePitcher%(D), pitchRating(D, currPitcher%(D), SS_P_Sv)
                    End If

            Else
                pitGS = pitchRating(D, currPitcher%(D), SS_P_GS)
                pitCG = pitchRating(D, currPitcher%(D), SS_P_CG)
                pitW  = pitchRating(D, currPitcher%(D), SS_P_W)

                If gameScore(P, 0) = 0 And pitGS > 0 And RN <= Int(pitCG / pitGS * 100 + .5) + 10 Then Goto LReliever1
                If pitGS > 0 And RN <= Int(pitCG / pitGS * 100 + .5) Then Goto LReliever1

                Call d100(RN0)

                If pitchEraOpt > 0 And INNING% > 7 And gameScore(D, 0) > gameScore(P, 0) _
                    And pitW > 0 And gamePitcher%(D) = 1 _
                    And Int(pitCG / pitW * 100 + .5) <= 100 _
                    And RN0 <= Int(pitCG / pitW * 100 + .5) Then Goto LReliever1

                If pitchEraOpt > 0 And INNING% > 7 And (gameScore(D, 0) >= gameScore(P, 0) _
                    Or gameScore(P, 0) - gameScore(D, 0) <= 2) _
                        And pitW > 0  And gamePitcher%(D) = 1 And Int(pitCG / pitW * 100 + .5) >= 100 Then Goto LReliever1

                If pitchEraOpt >= 8 Then Goto LReliever1

                GK%(D) = 1  'new reliever'
                Print #11, Using "NEW RELIEVER 2 Inning: ##  ourLead: ##  gamePitcher: ##  GS: ##  CG: ##  Wins: ##"; _
                    INNING%, ourLead, gamePitcher%(D), pitGS, pitCG, pitW

            End If

        End If

    End If

  LReliever1: '
    DumpAll
    Print #11, "---"
    Print #11, "LReliever1 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    If GK%(D) = 1 Then

        GK%(D) = 0
        Call RELIEVERS(flagPinchHitter, pz)
        If useVGA = 1 Then _PutImage (20 * FontColAdj, 48)-Step(44 * FontColAdj, 128), backupScreen&, imageScreen&, (20 * FontColAdj, 48)-Step(44 * FontColAdj, 128)
        GoTo LManageDefense

    End If

    If fldPos%(P, currBatter!(P)) = 1 Then BR = 0
    If fldPos%(P, currBatter!(P)) <> 1 Then BR = batRating(P, playerNum%(P, currBatter!(P)), 30)

    If pitchRating(P, currPitcher%(P), SS_P_BAvg) <> 999 Then
        I7! = pitchRating(I0, currPitcher%(I0), SS_P_BAvg)
    Else
        If pitchRating(P, currPitcher%(P), 20) = 0 Then
            I7! = 0
        Else
            I7! = Int((pitchRating(P, currPitcher%(P), 22) / pitchRating(P, currPitcher%(P), 20) * 1000 + .5))
        End If
    End If

    D2 = 1

    If INFPOS% <= INF_NORMAL Then

        If MG%(D, 690) = 999 Then

            If Not (baseRunners% < BASE_3 Or baseRunners% = BASE_1_2) Then

                ' PROFILE INFIELD IN WITH 3RD OCCUPIED
                Call d100(RN)
                If nbrOuts(0) = 0 And ourLead >= MG%(D, 691) * -1 And ourLead <= MG%(D, 692) * -1 And INNING% >= MG%(D, 693) And RN <= MG%(D, 694) Then INFPOS% = INF_INFIELD_IN: D2 = 3: GoTo LManageDefense
                If nbrOuts(0) = 0 And ourLead >= MG%(D, 695) * -1 And ourLead <= MG%(D, 696) * -1 And INNING% >= MG%(D, 697) And RN <= MG%(D, 698) Then INFPOS% = INF_INFIELD_IN: D2 = 3: GoTo LManageDefense
                If nbrOuts(0) = 1 And (baseRunners% = BASE_1_3 Or baseRunners% = BASE_FULL) And ourLead >= MG%(D, 699) * -1 And ourLead <= MG%(D, 700) * -1 And INNING% >= MG%(D, 701) And RN <= MG%(D, 702) Then INFPOS% = INF_INFIELD_IN: D2 = 3: GoTo LManageDefense
                If nbrOuts(0) = 1 And (baseRunners% = BASE_1_3 Or baseRunners% = BASE_FULL) And ourLead >= MG%(D, 703) * -1 And ourLead <= MG%(D, 704) * -1 And INNING% >= MG%(D, 705) And RN <= MG%(D, 706) Then INFPOS% = INF_INFIELD_IN: D2 = 3: GoTo LManageDefense

            End If

        End If

        If MG%(D, 707) = 999 Then

            If baseRunners% = BASE_EMPTY Then

                ' PROFILE CORNERS IN AGAINST A BUNT HIT
                Call d100(RN)
                If BR >= MG%(D, 708) And RN <= MG%(D, 709) Or BR >= MG%(D, 710) And RN <= MG%(D, 711) Or BR >= MG%(D, 712) And RN <= MG%(D, 713) Then
                    INFPOS% = INF_CORNERS_IN
                    D2 = 4
                    GoTo LManageDefense
                End If

            End If

        End If

        If MG%(D, 714) = 999 And fldPos%(P, currBatter!(P)) <> 1 Then

            If nbrOuts(0) = 0 Then

                If Not (baseRunners% <> BASE_1 And baseRunners% <> BASE_1_2) Then

                    ' PROFILE CORNERS IN VS HITTER IN SAC BUNT SITUATION
                    Call d100(RN)
                    If ourLead <= MG%(D, 715) And ourLead >= MG%(D, 716) * -1 And baseRunners% = BASE_1 And BR >= MG%(D, 717) And RN <= MG%(D, 718) Then
                        INFPOS% = INF_CORNERS_IN
                        D2 = 4
                        GoTo LManageDefense
                    End If
                    If ourLead <= MG%(D, 719) And ourLead >= MG%(D, 720) * -1 And baseRunners% = BASE_1 And BR >= MG%(D, 721) And RN <= MG%(D, 722) Then
                        INFPOS% = INF_CORNERS_IN
                        D2 = 4
                        GoTo LManageDefense
                    End If
                    If ourLead <= MG%(D, 723) And ourLead >= MG%(D, 724) * -1 And baseRunners% = BASE_1_2 And BR >= MG%(D, 725) And RN <= MG%(D, 726) Then
                        INFPOS% = INF_CORNERS_IN
                        D2 = 4
                        GoTo LManageDefense
                    End If
                    If ourLead <= MG%(D, 727) And ourLead >= MG%(D, 728) * -1 And baseRunners% = BASE_1_2 And BR >= MG%(D, 729) And RN <= MG%(D, 730) Then
                        INFPOS% = INF_CORNERS_IN
                        D2 = 4
                        GoTo LManageDefense
                    End If

                End If

            End If

        End If

        If Not (MG%(D, 731) <> 999 Or fldPos%(P, currBatter!(P)) <> 1 Or nbrOuts(0) = 2) Then

            If Not (baseRunners% <> BASE_1 And baseRunners% <> BASE_2 And baseRunners% <> BASE_1_2) Then

                ' PROFILE CORNERS IN VS A PITCHER IN SAC BUNT SITUATION
                Call d100(RN)

                If I7! <= MG%(D, 732) And RN <= MG%(D, 733) And baseRunners% = BASE_1 And nbrOuts(0) <= 1 Then
                    INFPOS% = INF_CORNERS_IN
                    D2 = 4
                    GoTo LManageDefense
                End If

                If I7! <= MG%(D, 734) And RN <= MG%(D, 735) And baseRunners% = BASE_1 And nbrOuts(0) <= 1 Then
                    INFPOS% = INF_CORNERS_IN
                    D2 = 4
                    GoTo LManageDefense
                End If

                If I7! <= MG%(D, 736) And RN <= MG%(D, 737) And (baseRunners% = BASE_2 Or baseRunners% = BASE_1_2) And nbrOuts(0) = 0 Then
                    INFPOS% = INF_CORNERS_IN
                    D2 = 4
                    GoTo LManageDefense
                End If

                If I7! <= MG%(D, 738) And RN <= MG%(D, 739) And (baseRunners% = BASE_2 Or baseRunners% = BASE_1_2) And nbrOuts(0) = 0 Then
                    INFPOS% = INF_CORNERS_IN
                    D2 = 4
                    GoTo LManageDefense
                End If

            End If

        End If

        If MG%(D, 740) = 999 Then

            If Not (nbrOuts(0) = 2 Or baseRunners% <> BASE_3 And baseRunners% < BASE_1_3) Then

                ' PROFILE CORNERS IN FOR A SQUEEZE
                Call d100(RN)
                If nbrOuts(0) = 0 And ourLead <= MG%(D, 741) And ourLead >= MG%(D, 742) And BR >= MG%(D, 743) And RN <= MG%(D, 744) Then
                    INFPOS% = INF_CORNERS_IN
                    D2 = 4
                    GoTo LManageDefense
                End If
                If nbrOuts(0) = 1 And ourLead <= MG%(D, 745) And ourLead >= MG%(D, 746) And BR >= MG%(D, 747) And RN <= MG%(D, 748) Then
                    INFPOS% = INF_CORNERS_IN
                    D2 = 4
                    GoTo LManageDefense
                End If


            End If

        End If

        If MG%(D, 756) = 999 Then

            If Not (baseRunners% = BASE_1 Or baseRunners% = BASE_1_2 Or baseRunners% = BASE_1_3 Or BASE_FULL) Then

                MOB% = 0

                For I = 1 To 3
                    If gameBaserunners%(I, 0) > 0 Then MOB% = MOB% + 1
                Next

                If ourLead + MOB% + 1 < 0 Then
                    ' BATTER NOT TYING OR WINNING RUN
                    Call d100(RN)

                    If batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) = 0 Then
                        I7! = 0
                        iSlug! = 0
                    Else
                        iSlug! = Int( ( batRating(P, playerNum%(P, currBatter!(P)), SS_B_H) _
                            + batRating(P, playerNum%(P, currBatter!(P)), SS_B_2B) _
                            + batRating(P, playerNum%(P, currBatter!(P)), SS_B_3B) * 2 _
                            + batRating(P, playerNum%(P, currBatter!(P)), SS_B_HR) * 3 ) _
                            / batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) * 1000 + .5 )
                        If iSlug! <= MG%(D, 757) And INNING% >= MG%(D, 758) And RN <= MG%(D, 759) Then D2 = 8: GoTo LReliever2
                        If iSlug! <= MG%(D, 760) And INNING% >= MG%(D, 761) And RN <= MG%(D, 762) Then D2 = 8: GoTo LReliever2
                        If iSlug! <= MG%(D, 763) And INNING% >= MG%(D, 764) And RN <= MG%(D, 765) Then D2 = 8: GoTo LReliever2
                    End If

                End If

            End If

        End If

        ourLead = gameScore(D, 0) - gameScore(P, 0)

        If ourLead >= -1 And ourLead <= 1 And INNING% >= 8 And (baseRunners% = BASE_3 Or baseRunners% >= BASE_1_3) And nbrOuts(0) < 2 Then
            INFPOS% = INF_INFIELD_IN
            D2 = 3

        Else

            If ourLead > 0 Or nbrOuts(0) > 0 Or baseRunners% <= BASE_2 Or baseRunners% = BASE_1_2 Or baseRunners% = BASE_1_3 And nbrOuts(0) = 1 Or INNING% <= 5 And ourLead < -2 Or INNING% > 5 And ourLead < -4 Then

                If Not (baseRunners% = BASE_EMPTY Or baseRunners% = BASE_2 Or baseRunners% = BASE_3 Or baseRunners% >= BASE_1_3 Or nbrOuts(0) = 2 Or currBatter!(P) >= 3 And currBatter!(P) <= 6 Or INNING% <= 6 And ourLead >= 3 Or INNING% <= 6 And ourLead <= -3) Then
                    If Not (INNING% > 7 And ourLead >= 1 Or INNING% > 7 And ourLead < -1) Then
                        INFPOS% = INF_CORNERS_IN
                        D2 = 4
                    End If
                End If
            Else
                INFPOS% = INF_INFIELD_IN
                D2 = 3
            End If

        End If

        GoTo LManageDefense

    End If

    If Not (ourLead <= 0 Or ourLead = 0 And baseRunners% <= BASE_1 Or ourLead = 0 And baseRunners% = BASE_1_2 Or baseRunners% = BASE_FULL Or fldPos%(P, currBatter!(P)) = 1) Then

        If INNING% >= 9 And P = 1 And nbrOuts(0) < 2 And ourLead = 0 And baseRunners% >= BASE_2 And baseRunners% <= BASE_3 Or INNING% >= 9 And P = 1 And nbrOuts(0) = 2 And ourLead = 0 And baseRunners% >= BASE_1_3 And baseRunners% <= BASE_2_3 Then
            '18835
            D2 = 2
            GoTo LManageDefense
        End If

        Ib4 = liveBatRating%(P, LIVE_BAvg, currBatter!(P))
        I1 = liveBatRating%(P, LIVE_HR, currBatter!(P))
        If currBatter!(P) = 9 Then
            I2 = liveBatRating%(P, LIVE_BAvg, 0)
            I3 = liveBatRating%(P, LIVE_HR, 0)
        Else
            I2 = liveBatRating%(P, LIVE_BAvg, currBatter!(P) + 1)
            I3 = liveBatRating%(P, LIVE_HR, currBatter!(P) + 1)
        End If

        If Not (baseRunners% <> BASE_2 And baseRunners% <> BASE_2_3) Then

            If Ib4 - I2 >= 50 And I1 - I3 >= 50 And ourLead < 1 And INNING% > 8 Or Ib4 >= 280 And I1 >= 140 And INNING% > 8 And I1 > I3 And ourLead < 1 Then
                D2 = 2
                GoTo LManageDefense
            End If

        End If

    End If

  LReliever2: '
    DumpAll
    Print #11, "---"
    Print #11, "LReliever2 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    Print #11, Using "LReliever2 staminaWH: ##  W: ##  H: ## ... staminaR: ##  R:  ##  playerX: ##  gamePitcher: ##"; _
        stamina%(D, 0), statPitcherGame%(D, currPitcher%(D), LG_P_BB), statPitcherGame%(D, currPitcher%(D), LG_P_H), _
        stamina%(D, 1), statPitcherGame%(D, currPitcher%(D), LG_P_R), playerX%(D, POS_P), gamePitcher%(D)

    If (    stamina%(D, 0) <= statPitcherGame%(D, currPitcher%(D), LG_P_BB) + statPitcherGame%(D, currPitcher%(D), LG_P_H) _
        And stamina%(D, 1) <= statPitcherGame%(D, currPitcher%(D), LG_P_R) ) Or playerX%(D, POS_P) = 99 Then
        Call RELIEVERS(flagPinchHitter, pz)
        If useVGA = 1 Then _PutImage (20 * FontColAdj, 48)-Step(44 * FontColAdj, 128), backupScreen&, imageScreen&, (20 * FontColAdj, 48)-Step(44 * FontColAdj, 128)
    End If

    GoTo LManageDefense


    '----- NOODLE -----


  LPhForPosition: 'GET A PINCH HITTER FOR A POSITION PLAYER
    DumpAll
    Print #11, "---"
    Print #11, "LPhForPosition PH for POSITION player - possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    If 0 = 1 And MG%(P, 540) = 999 Then '[bm] Todo re-enable this once it's fixed (no more -1 as array subscript)'

        'SELECT PH FOR HITTER
        For I = 0 To 22

            If batRating(P, I, 21) <= 0 And batters$(P, I) <> "XXX" Then

                If fldPos%(P, currBatter!(P)) = batRating(P, I, SS_B_Pos1) Or _
                   fldPos%(P, currBatter!(P)) = batRating(P, I, SS_B_Pos2) Or _
                   fldPos%(P, currBatter!(P)) = batRating(P, I, SS_B_Pos3) Or _
                   fldPos%(P, currBatter!(P)) = batRating(P, I, SS_B_Pos4) Then ' Is one of this player's 4 positions the same as the current batter's position?

                    I1 = 6  ' righty pitcher
                    If pitchRating(D, currPitcher%(D), SS_P_Throws) < 0 Then I1 = 1 ' lefty pitcher

                    For I = I1 To I1 + 4

                        If MG%(P, I1 + 540) <> -1 Then
                            If MG%(P, I1 + 540) <> -1 And batRating(P, MG%(P, I1 + 540), 21) = 0 Then
                                mg% = MG%(P, I1 + 540)
                                MG%(P, I1 + 540) = -1

                                Print #11, "PH for position player scenario #1, I ="; I
                                Goto LPhForPosContinue
                            End If
                        Else
                            Print #11, "WARNING!! Got -1 in LPhForPosition: "; MG%(P, 540)
                            Exit For
                        End If

                    Next

                End If

            End If

        Next

    End If

    For I = 0 To 22:

        If batRating(P, I, 21) <= 0 And batters$(P, I) <> "XXX" And batRating(P, I, SS_B_AB) <> 0 Then

            If fldPos%(P, currBatter!(P)) = batRating(P, I, SS_B_Pos1) Or _
               fldPos%(P, currBatter!(P)) = batRating(P, I, SS_B_Pos2) Or _
               fldPos%(P, currBatter!(P)) = batRating(P, I, SS_B_Pos3) Or _
               fldPos%(P, currBatter!(P)) = batRating(P, I, SS_B_Pos4) Then ' Is one of this player's 4 positions the same as the current batter's position?

                pinchBAvg = batRating(P, I,  SS_B_H) / batRating(P, I,  SS_B_AB) * 1000
                battrBAvg = batRating(P, JM, SS_B_H) / batRating(P, JM, SS_B_AB) * 1000
                abRand = Int(Rnd(1) * 500)

                ' Pitcher and PH both righty
                If pitchRating(D, currPitcher%(D), SS_P_Throws) =  1 And batRating(P, I, SS_B_Bats) > 0 And pinchBAvg > battrBAvg + 35 Then 
                    Print #11, Using "PH for position player scenario 2, batAvg = ####.#  pinchAvg = ####.#  abRand = ###.#  pinchAB = ###  rosterNum = ##"; _
                        battrBAvg, pinchBAvg, abRand, batRating(P, I,  SS_B_AB), I
                    If abRand < batRating(P, I,  SS_B_AB) Then Goto LPhForPosContinue
                End If

                ' Pitcher and PH both lefty
                If pitchRating(D, currPitcher%(D), SS_P_Throws) = -1 And batRating(P, I, SS_B_Bats) < 0 And pinchBAvg > battrBAvg + 45 Then 
                    Print #11, Using "PH for position player scenario 3, batAvg = ####.#  pinchAvg = ####.#  abRand = ###.#  pinchAB = ###  rosterNum = ##"; _
                        battrBAvg, pinchBAvg, abRand, batRating(P, I,  SS_B_AB), I
                    If abRand < batRating(P, I,  SS_B_AB) Then Goto LPhForPosContinue
                End If

                ' PH is switch hitter
                If batRating(P, I, SS_B_Bats) = 0 And pinchBAvg > battrBAvg + 30 Then 
                    Print #11, Using "PH for position player scenario 4, batAvg = ####.#  pinchAvg = ####.#  abRand = ###.#  pinchAB = ###  rosterNum = ##"; _
                        battrBAvg, pinchBAvg, abRand, batRating(P, I,  SS_B_AB), I
                    If abRand < batRating(P, I,  SS_B_AB) Then Goto LPhForPosContinue
                End If

            End If

        End If

    Next I

    GoTo LPinchRunner

  LPhForPosContinue:
    flagPinchHitter = 1
    gameD0%(P) = gameD0%(P) + 1
    X0%(P, 0, gameD0%(P)) = I
    X0%(P, 1, gameD0%(P)) = fldPos%(P, currBatter!(P))
    X0%(P, 2, gameD0%(P)) = (currBatter!(P) * 10) + (gameD0%(P) - 9)
    batRating(P, I, 21) = 1
    playerNum%(P, currBatter!(P)) = I
    playerX%(P, fldPos%(P, currBatter!(P))) = I

    If fldPos%(P, currBatter!(P)) = 1 Or fldPos%(P, currBatter!(P)) = 10 Then 
        playerX%(P, 1) = 99
        playerX%(P, 0) = currBatter!(P)
        fldPos%(P, currBatter!(P)) = 10
    End If

    Call REPLACEMENTS(P, currBatter!(P), playerNum%(P, currBatter!(P)))

    GoTo LPinchHitter

    '----- NOODLE -----

  LPhForPitcher: 'GET A PINCH HITTER FOR THE PITCHER
    DumpAll
    Print #11, "---"
    Print #11, "LPinchHitter PH for PITCHER - possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)

    callPinch = 0
    skipLoop = 0

    If MG%(P, 540) <> 999 Then

        J% = 0
        GP% = 0
        pit16 = pitchRating(P, currPitcher%(P), 16)
        pit15 = pitchRating(P, currPitcher%(P), 15)
        pitRatio = Int( pit16 / pit15 * 100 + .5 )

        Print #11, Using "LPhForPitcher DH: ## INNING: ##  pitchEraOpt: ##   ourScore: ##  theirScore: ## gamePitcher: ##  pit16: ##  pit15: ##  pitRatio: ##.###  RN0: ##.###"; _
          desigHit, INNING%, pitchEraOpt, gameScore(P, 0), gameScore(D, 0), gamePitcher%(P), pit16, pit15, pitRatio, RN0

          'ToDo:  Move the check for DH (desigHit) earlier (upstream) -- we shouldn't even be reaching here when using DH'
        If desigHit = 1 Or ( (  pitchEraOpt > 1 And INNING% < 4) _
          Or (pitchEraOpt > 2 And INNING% < 7) _
          Or (pitchEraOpt > 3 And INNING% < 9) _
          Or (pitchEraOpt >= 8) _
          Or ( pitchEraOpt > 0 _
            And INNING% > 7 _
            And gameScore(P, 0) > gameScore(D, 0) _
            And pit15 > 0 _
            And gamePitcher%(P) = 1 _
            And pitRatio <= 100 _
            And RN0 <= pitRatio ) _
          Or (pitchEraOpt > 0 _
            And INNING% > 7 _
            And (gameScore(P, 0) >= gameScore(D, 0) _
          Or gameScore(D, 0) - gameScore(P, 0) <= 2) _
            And pit15 > 0 _
            And gamePitcher%(P) = 1 _
            And pitRatio >= 100) )_
        Then skipLoop = 1

        If skipLoop = 0 Then

            For Idx = 0 To 22

                If Not (batters$(P, Idx) = "XXX" Or batRating(P, Idx, 21) > 0 Or batRating(P, Idx, SS_B_AB) = 0) Then

                    If batRating(P, Idx, SS_B_Bats) > 0 And pitchRating(D, currPitcher%(D), SS_P_Throws) = 1 Or _
                       batRating(P, Idx, SS_B_Bats) < 0 And pitchRating(D, currPitcher%(D), SS_P_Throws)= -1 Then
                        PH%(J%, 0) = Int( batRating(P, Idx, SS_B_G) / 4 + .5 )
                    Else
                        PH%(J%, 0) = batRating(P, Idx, SS_B_G)
                    End If

                    PH%(J%, 1) = Idx
                    GP% = GP% + PH%(J%, 0)
                    J% = J% + 1

                End If

            Next

            If J% <> 0 Then

                RN = Int(Rnd(1) * GP%) + 1

                For I = 0 To J% - 1

                    If RN <= PH%(I, 0) Then
                        PH% = PH%(I, 1)
                        callPinch = 1
                        Exit For
                    Else
                        PH%(I + 1, 0) = PH%(I, 0) + PH%(I + 1, 0)
                    End If

                Next

            End If

        End If 'Done checking of we should skip the loop


        If callPinch = 1 Then

            flagPinchHitter = 1
            gameD0%(P) = gameD0%(P) + 1
            X0%(P, 0, gameD0%(P)) = PH%
            X0%(P, 1, gameD0%(P)) = 10
            X0%(P, 2, gameD0%(P)) = 81 + gameD0%(P)
            batRating(P, PH%, 21) = 1
            playerNum%(P, currBatter!(P)) = PH%

            If fldPos%(P, currBatter!(P)) = 1 Or fldPos%(P, currBatter!(P)) = 10 Then playerX%(P, 1) = 99: playerX%(P, 0) = currBatter!(P): fldPos%(P, currBatter!(P)) = 10

          LPinchHitter: '
            DumpAll
            Print #11, "---"
            Print #11, "LPinchHitter possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
            Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
            Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
            P9 = P
            W5 = P9
            W6 = P9
            VV(P9) = currBatter!(P)
            VV1(P9) = currBatter!(P)
            Call HITTINGLINES

            If useVGA = 1 Then
                Call DisplayBallField_Gfx(nbrBalls, P, nbrStrikes, D)
                Call MAINSCREEN_G(D, P, nbrBalls, nbrStrikes, MO)
            Else
                Call DisplayBallField(nbrBalls, P, nbrStrikes, D)
                Call MAINSCREEN(D, P, nbrBalls, nbrStrikes, MO)
            End If

            VV(P9) = 1
            VV1(P9) = 9

            player$(0) = batters$(P, playerNum%(P, currBatter!(P)))

            If fldPos%(P, currBatter!(P)) = 1 Then player$(0) = pitchers$(P, currPitcher%(D))
            Call WINDEX
            Call PBP(gameManagers$(P) + " is sending up a pinch hitter")
            flagPinchHitter = 1

            GoTo LContinueBatter

        End If

      LPinchRunner: '
        DumpAll
        Print #11, "---"
        Print #11, "LPinchRunner possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        If flagPinchRunner% <> 1 Then
            Call PINCHRUNNER(MS%, ourLead, baseRunners%, I2, P, flagPinchRunner%, nbrBalls, nbrStrikes, D, MO)
        End If

        If MS% = 1 Then
            MS% = 0
            GoTo LContinueBatter
        End If

        If fldPos%(P, currBatter!(P)) = 1 Then
            BR = 0
        Else
            BR = batRating(P, playerNum%(P, currBatter!(P)), 30)
        End If


        Call d100(RN)
        If baseRunners% = BASE_EMPTY And (INFPOS% > INF_NORMAL And RN <= 5 Or INFPOS% = INF_NORMAL And RN <= 5) And BR > 8 Then
            P2 = 4
            GoTo LBunt
        End If

        ' MANAGER PROFILE TO HIT AND RUN
        Call d100(RN)
        If Not (baseRunners% = BASE_EMPTY Or MG%(P, 671) <> 999 Or fldPos%(P, currBatter!(P)) = 1) Then
            If batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) = 0 Then I7! = 0 Else I7! = Int((batRating(P, playerNum%(P, currBatter!(P)), SS_B_H) + batRating(P, playerNum%(P, currBatter!(P)), 7) + batRating(P, playerNum%(P, currBatter!(P)), 8) * 2 + batRating(P, playerNum%(P, currBatter!(P)), 9) * 3) / batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) * 1000 + .5)
            If batRating(P, playerNum%(P, currBatter!(P)), 12) = 0 Then I6! = 0 Else I6! = Int(batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) / batRating(P, playerNum%(P, currBatter!(P)), 12) + .5)

            If baseRunners% = BASE_1 And nbrOuts(0) = 0 And ourLead <= MG%(P, 672) And ourLead >= MG%(P, 673) * -1 And RN <= MG%(P, 674) And I7! <= MG%(P, 872) And I6! >= MG%(P, 866) Then P2 = 2: GoTo LRunnerGoing2
            If baseRunners% = BASE_1 And nbrOuts(0) = 1 And ourLead <= MG%(P, 675) And ourLead >= MG%(P, 676) * -1 And RN <= MG%(P, 677) And I7! <= MG%(P, 873) And I6! >= MG%(P, 867) Then P2 = 2: GoTo LRunnerGoing2

            If baseRunners% = BASE_1_3 And nbrOuts(0) = 0 And ourLead <= MG%(P, 678) And ourLead >= MG%(P, 679) * -1 And RN <= MG%(P, 680) And I7! <= MG%(P, 874) And I6! >= MG%(P, 868) Then P2 = 2: GoTo LRunnerGoing2
            If baseRunners% = BASE_1_3 And nbrOuts(0) = 1 And ourLead <= MG%(P, 681) And ourLead >= MG%(P, 682) * -1 And RN <= MG%(P, 683) And I7! <= MG%(P, 875) And I6! >= MG%(P, 869) Then P2 = 2: GoTo LRunnerGoing2

            If baseRunners% = BASE_1_2 And nbrOuts(0) = 0 And ourLead <= MG%(P, 684) And ourLead >= MG%(P, 685) * -1 And RN <= MG%(P, 686) And I7! <= MG%(P, 876) And I6! >= MG%(P, 870) Then P2 = 2: GoTo LRunnerGoing2
            If baseRunners% = BASE_1_2 And nbrOuts(0) = 1 And ourLead <= MG%(P, 687) And ourLead >= MG%(P, 688) * -1 And RN <= MG%(P, 689) And I7! <= MG%(P, 877) And I6! >= MG%(P, 871) Then P2 = 2: GoTo LRunnerGoing2
        End If

        If Not (MG%(P, 609) <> 999 Or fldPos%(P, currBatter!(P)) <> 1) Then

            If Not (baseRunners% <> BASE_1 And baseRunners% <> BASE_2 And baseRunners% <> BASE_1_2) Then

                Call d100(RN)

                If baseRunners% = BASE_1   And INNING% <= 7 And MG%(P, 610) >= nbrOuts(0) And ourLead <= MG%(P, 611) And ourLead >= MG%(P, 612) * -1 And RN <= MG%(P, 613) Then Goto LBunt0
                If baseRunners% = BASE_1   And INNING% >  7 And MG%(P, 614) >= nbrOuts(0) And ourLead <= MG%(P, 615) And ourLead >= MG%(P, 616) * -1 And RN <= MG%(P, 617) Then Goto LBunt0

                If baseRunners% = BASE_2   And INNING% <= 7 And MG%(P, 618) >= nbrOuts(0) And ourLead <= MG%(P, 619) And ourLead >= MG%(P, 620) * -1 And RN <= MG%(P, 621) Then Goto LBunt0
                If baseRunners% = BASE_2   And INNING% >  7 And MG%(P, 622) >= nbrOuts(0) And ourLead <= MG%(P, 623) And ourLead >= MG%(P, 624) * -1 And RN <= MG%(P, 625) Then Goto LBunt0

                If baseRunners% = BASE_1_2 And INNING% <= 7 And MG%(P, 626) >= nbrOuts(0) And ourLead <= MG%(P, 627) And ourLead >= MG%(P, 628) * -1 And RN <= MG%(P, 629) Then Goto LBunt0
                If baseRunners% = BASE_1_2 And INNING% >  7 And MG%(P, 630) >= nbrOuts(0) And ourLead <= MG%(P, 631) And ourLead >= MG%(P, 632) * -1 And RN <= MG%(P, 633) Then Goto LBunt0

            End If

        End If

        If MG%(P, 634) = 999 And fldPos%(P, currBatter!(P)) <> 1 And nbrOuts(0) = 0 Or (baseRunners% <> BASE_1 And baseRunners% <> BASE_2 And baseRunners% <> BASE_1_2) Then

            If batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) = 0 Then
                I7! = 0
                I6! = 0
            Else
                I7! = Int(batRating(P, playerNum%(P, currBatter!(P)), SS_B_H) / batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) * 1000 + .5)
                I6! = Int((batRating(P, playerNum%(P, currBatter!(P)), SS_B_H) + batRating(P, playerNum%(P, currBatter!(P)), 7) + batRating(P, playerNum%(P, currBatter!(P)), 8) * 2 + batRating(P, playerNum%(P, currBatter!(P)), 9) * 3) / batRating(P, playerNum%(P, currBatter!(P)), SS_B_AB) * 1000 + .5)
            End If

            Call d100(RN)
            If baseRunners% = BASE_1   And INNING% <= 7 And ourLead <= MG%(P, 635) And ourLead >= MG%(P, 636) * -1 And I7! <= MG%(P, 637) And I6! <= MG%(P, 638) And pitchRating(D, currPitcher%(D), SS_P_ERA100) <= MG%(P, 639) And RN <= MG%(P, 640) Then Goto LBunt0
            If baseRunners% = BASE_2   And INNING% <= 7 And ourLead <= MG%(P, 641) And ourLead >= MG%(P, 642) * -1 And I7! <= MG%(P, 643) And I6! <= MG%(P, 644) And pitchRating(D, currPitcher%(D), SS_P_ERA100) <= MG%(P, 645) And RN <= MG%(P, 646) Then Goto LBunt0
            If baseRunners% = BASE_1_2 And INNING% <= 7 And ourLead <= MG%(P, 647) And ourLead >= MG%(P, 648) * -1 And I7! <= MG%(P, 649) And I6! <= MG%(P, 650) And pitchRating(D, currPitcher%(D), SS_P_ERA100) <= MG%(P, 651) And RN <= MG%(P, 652) Then Goto LBunt0

            If baseRunners% = BASE_1   And INNING% >  7 And ourLead <= MG%(P, 653) And ourLead >= MG%(P, 654) * -1 And I7! <= MG%(P, 655) And I6! <= MG%(P, 656) And pitchRating(D, currPitcher%(D), SS_P_ERA100) <= MG%(P, 657) And RN <= MG%(P, 658) Then Goto LBunt0
            If baseRunners% = BASE_2   And INNING% >  7 And ourLead <= MG%(P, 659) And ourLead >= MG%(P, 660) * -1 And I7! <= MG%(P, 661) And I6! <= MG%(P, 662) And pitchRating(D, currPitcher%(D), SS_P_ERA100) <= MG%(P, 663) And RN <= MG%(P, 664) Then Goto LBunt0
            If baseRunners% = BASE_1_2 And INNING% >  7 And ourLead <= MG%(P, 665) And ourLead >= MG%(P, 666) * -1 And I7! <= MG%(P, 667) And I6! <= MG%(P, 668) And pitchRating(D, currPitcher%(D), SS_P_ERA100) <= MG%(P, 669) And RN <= MG%(P, 670) Then Goto LBunt0

        End If

        P2 = 1

        If baseRunners% = BASE_1 Or baseRunners% = BASE_1_3 Then

            If ourLead <= -1 And batRating(P, playerNum%(P, gameBaserunners%(1, 0)), 13) < 10 Or gameBaserunners%(1, 2) > 1 Then Goto LNoSteal 'CHANGED FROM <10
            If ourLead >= -1 And baseRunners% = BASE_1_3 Then Goto LNoSteal
            If ourLead <  -5 Or fldPos%(P, gameBaserunners%(1, 0)) = 1 And baseRunners% = BASE_1 Or fldPos%(P, gameBaserunners%(2, 0)) = 1 And baseRunners% = BASE_2 Then Goto LNoSteal
            If ourLead <   0 And INNING% >= 7 Then Goto LNoSteal
            P2 = 3

            GoTo LSteal

        End If

        If baseRunners% = BASE_2 Or baseRunners% = BASE_1_2 Then
            If Not (batRating(P, playerNum%(P, gameBaserunners%(2, 0)), 13) < 40 Or fldPos%(P, currBatter!(P)) = 1 Or nbrOuts(0) = 2) Then
                If gameBaserunners%(2, 2) <= 1 Then
                    P2 = 3
                    GoTo LSteal
                End If
            End If
        End If

      LNoSteal:
        DumpAll
        Print #11, "---"
        Print #11, "LNoSteal possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        If Not (baseRunners% = BASE_EMPTY Or nbrOuts(0) > 0 Or baseRunners% = BASE_FULL Or baseRunners% = BASE_2_3 Or baseRunners% = BASE_3 Or baseRunners% = BASE_1_3 Or nbrStrikes = 2 Or P = 0 And INNING% > 7) Then

            If fldPos%(P, currBatter!(P)) = 1 And baseRunners% = BASE_1   And nbrOuts(0) < 2 Or _
               fldPos%(P, currBatter!(P)) = 1 And baseRunners% = BASE_2   And nbrOuts(0) = 0 Or _
               fldPos%(P, currBatter!(P)) = 1 And baseRunners% = BASE_1_2 And nbrOuts(0) = 0 Then Goto LPinchRunner1
            If currBatter!(P) > 2 And currBatter!(P) < 6 Or liveBatRating%(P, LIVE_BAvg, currBatter!(P)) > 290 And fldPos%(P, currBatter!(P)) <> 1 Or fldPos%(P, currBatter!(P)) <> 1 And liveBatRating%(P, LIVE_HR, currBatter!(P)) > 70 Then Goto LPinchRunner0
            If INNING% > 7 And ourLead = -1 And nbrOuts(0) = 0 And baseRunners% = BASE_1 Then Goto LPinchRunner1

        End If

    End If

  LPinchRunner0:
    DumpAll
    Print #11, "---"
    Print #11, "LPinchRunner0 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
    flagPinchHitter = 0
    flagPinchRunner% = 0

    Call d100(RN0)

    If nbrOuts(0) = 2 Or liveBatRating%(P, LIVE_K, currBatter!(P)) > 100 _
        Or baseRunners% = BASE_EMPTY Or BASE_FULL Or baseRunners% = BASE_2_3 Or baseRunners% = BASE_3 Or baseRunners% = BASE_2 _
        Or ourLead < -3 Or RN0 > 20 Then
        GoTo LRunnerGoing
    Else
        P2 = 2
        GoTo LRunnerGoing2
    End If

    '----- NOODLE -----

  LPinchRunner1:
    DumpAll
    Print #11, "---"
    Print #11, "LPinchRunner1 possession: D ="; D; ", P ="; P; _IIF(D = 1, "Visiting", "Home") + " batting"
    Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
    Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)

    If nbrOuts(0) >= 1 And INNING% >= 7 Then
        GoTo LPinchRunner0
    Else
      LBunt0:
        Print #11, "---"
        Print #11, "Goto LBunt0 possession: D ="; D; ", P ="; P
        Print #11, "playerMode ="; playerMode; ", compTeam ="; compTeam
        Print #11, "gameScore ="; gameScore(0,0); gameScore(1,0)
        P2 = 4
        GoTo LBunt
    End If


End Sub

