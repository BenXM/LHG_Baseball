DECLARE FUNCTION EXIST%(FILENAME$)
DECLARE FUNCTION GetDrive% ()
DRIVE = GetDrive%
4 CLS
5 CLS:COLOR 12:PRINT"STATISTICS MERGE/ALIGN MENU":PRINT
6 COLOR 14:PRINT "(1) ";:COLOR 15:PRINT "MERGE STAT FILES":PRINT
7 COLOR 14:PRINT "(2) ";:COLOR 15:PRINT "ALIGN STAT FILES":PRINT
8 COLOR 14:PRINT "(3) ";:COLOR 15:PRINT "RETURN TO UTILITIES MENU"
9 I$=INKEY$:IF I$="" THEN 9
10 I = VAL(I$):IF I<1 OR I>3 THEN 9
11 IF I = 1 THEN GOTO 16
12 IF I = 2 THEN GOSUB 910:RUN "ALIGN.EXE"
13 IF I = 3 THEN GOTO 990
14 DIM B$(22),P$(21),B0%(22,22),P0%(21,41),T(22),T1(22)
15 DIM H1$(40),P%(21),B%(22),H%(162),H$(162),V%(162),PL$(162),W$(162),L$(162),D$(2),I%(162)
16 DIM BR$(22),PR$(21),B0R%(22,22),P0R%(21,41),TR(22),TR1(22)
17 DIM H1R$(40),PR%(21),BR%(22),HR%(162),HR$(162),VR%(162),PLR$(162),WR$(162),LR$(162),DR$(2),IR%(162)
   DIM S0%(22,6),SR%(22,6)
22 COLOR 12,0:CLS:LOCATE 2,5:PRINT "ENTER COMPLETE PATH FOR TEAM STATS TO MERGE"
23 COLOR 15:LOCATE 4,5:PRINT "EXAMPLE - A:"
24 LOCATE ,5:PRINT "          C:\HAFFNER"
25 LOCATE ,5:PRINT "          C:\HAFFNER\1960"
26 LOCATE ,5:PRINT "          D:\BASEBALL"
27 FOR J=10 TO 13:LOCATE J
28 PRINT"                                                            ":NEXT
35 COLOR 10:LOCATE 10,5:LINE INPUT "ROAD STATS:     ";PR$
36 LOCATE ,5:LOCATE ,5:LINE INPUT "CURRENT STATS:  ";PC$
37 COLOR 14:LOCATE 13,5:PRINT "ANY CHANGE (Y/N)"
38 I$=INKEY$:IF I$="" THEN 38
39 IF UCASE$(I$)="Y" THEN 27
45 LOCATE 15,5:PRINT"                                                       "
46 LOCATE 16,5:PRINT"                                                       "
47 COLOR 11:LOCATE 15,5:INPUT "ENTER NAME OF STAT FILE (EX.- MINNESOT.61)";Z$
50 LOCATE ,5:PRINT"ANY CHANGE (YN)"
60 I$=INKEY$:IF I$="" THEN 60
70 IF UCASE$(I$)="Y" THEN 45
   IF LEN(Z$)>11 THEN Z$=LEFT$(Z$,8)+RIGHT$(Z$,3)
100 GOSUB 1000
110 IF NOT EXIST (PR$+"\"+Z$) THEN 900
120 OPEN PR$+"\"+Z$ FOR INPUT AS #1
121 INPUT #1,A$: INPUT #1,WR2%: INPUT #1,LR2%
122 FOR I=0 TO 22:INPUT #1,BR$(I):INPUT #1,BR%(I):NEXT I
123 FOR I=0 TO 21:INPUT #1,PR$(I):INPUT #1,PR%(I):NEXT I
124 FOR I=0 TO 22:FOR I1=0 TO 21:INPUT #1,B0R%(I,I1):NEXT I1:NEXT I
125 FOR I=0 TO 21:FOR I1=0 TO 41:INPUT #1,P0R%(I,I1):NEXT I1:NEXT I
126 INPUT #1,D0R%:INPUT #1,D1R%
    FOR I=0 TO 21:INPUT #1,TR(I):NEXT I
    FOR I=0 TO 22:INPUT #1,TR1(I):NEXT I
160 CLOSE #1
    IF NOT EXIST (PR$+"\"+Z$+"R") THEN 165
    OPEN PR$+"\"+Z$+"R" FOR INPUT AS #1
    FOR I=0 TO 22
    FOR I1 = 0 TO 6
    INPUT #1,SR%(I,I1)
    NEXT:NEXT
    CLOSE 1
165 OPEN PR$+"\"+Z$+"S" FOR INPUT AS #1
    INPUT #1,YR%
    FOR I=1 TO 162:INPUT #1,HR%(I):NEXT I
    FOR I=1 TO 162:INPUT #1,HR$(I):NEXT I
    FOR I=1 TO 162:INPUT #1,VR%(I):NEXT I
    FOR I=1 TO 162:INPUT #1,PLR$(I):NEXT I
    FOR I=1 TO 162:INPUT #1,WR$(I):NEXT I
    FOR I=1 TO 162:INPUT #1,LR$(I):NEXT I
    FOR I=1 TO 162:INPUT #1,IR%(I):NEXT I
    CLOSE #1
    GOSUB 1100
210 IF NOT EXIST (PC$+"\"+Z$) THEN 900
220 OPEN PC$+"\"+Z$ FOR INPUT AS #1
221 INPUT #1,A$: INPUT #1,W2%: INPUT #1,L2%
222 FOR I=0 TO 22:INPUT #1,B$(I):INPUT #1,B%(I):NEXT I
223 FOR I=0 TO 21:INPUT #1,P$(I):INPUT #1,P%(I):NEXT I
224 FOR I=0 TO 22:FOR I1=0 TO 21:INPUT #1,B0%(I,I1):NEXT I1:NEXT I
225 FOR I=0 TO 21:FOR I1=0 TO 41:INPUT #1,P0%(I,I1):NEXT I1:NEXT I
226 INPUT #1,D0%:INPUT #1,D1%
    FOR I=0 TO 21:INPUT #1,T(I):NEXT I
    FOR I=0 TO 22:INPUT #1,T1(I):NEXT I
260 CLOSE #1
    IF NOT EXIST (PC$+"\"+Z$+"R") THEN 265
    OPEN PC$+"\"+Z$+"R" FOR INPUT AS #1
    FOR I=0 TO 22
    FOR I1 = 0 TO 6
    INPUT #1,S0%(I,I1)
    NEXT:NEXT
    CLOSE 1
265 OPEN PC$+"\"+Z$+"S" FOR INPUT AS #1
    INPUT #1,Y%
    FOR I=1 TO 162:INPUT #1,H%(I):NEXT I
    FOR I=1 TO 162:INPUT #1,H$(I):NEXT I
    FOR I=1 TO 162:INPUT #1,V%(I):NEXT I
    FOR I=1 TO 162:INPUT #1,PL$(I):NEXT I
    FOR I=1 TO 162:INPUT #1,W$(I):NEXT I
    FOR I=1 TO 162:INPUT #1,L$(I):NEXT I
    FOR I=1 TO 162:INPUT #1,I%(I):NEXT I
    CLOSE #1
    GOTO 1200

319 W2%=W2%+WR2%:L2%=L2%+LR2%
320 LOCATE 18,20:COLOR 12:PRINT "MERGING STAT FILE AND SCHEDULE RESULTS . . . ."
324 FOR I = 0 TO 22
    FOR I1 = 0 TO 6
    S0%(I,I1) = S0%(I,I1)+ SR%(I,I1)
    NEXT
325 FOR I1=0 TO 11:B0%(I,I1)=B0%(I,I1)+B0R%(I,I1):NEXT I1
326 FOR I1=14 TO 21:B0%(I,I1)=B0%(I,I1)+B0R%(I,I1):NEXT I1:NEXT I
327 FOR I = 0 TO 21
328 FOR I1 = 0 TO 34:P0%(I,I1)=P0%(I,I1)+P0R%(I,I1):NEXT I1
329 FOR I1 = 37 TO 41:P0%(I,I1)=P0%(I,I1)+P0R%(I,I1):NEXT I1:NEXT I
330 D0%=D0%+DR0%:D1%=D1%+DR1%
350 FOR I = 0 TO 21:T(I)=T(I)+TR(I):NEXT
355 FOR I = 0 TO 22:T1(I)=T1(I)+TR1(I):NEXT
400 CLS:COLOR 15:PRINT "MAKE SURE NEW CURRENT STATS DISK IS IN DRIVE "PC$:LOCATE 23,1
401 PRINT "PRESS ANY KEY TO CONTINUE"
405 I$=INKEY$:IF I$="" THEN 405
420 OPEN PC$+"\"+Z$ FOR OUTPUT AS #1
421 WRITE #1,A$: WRITE #1,W2%: WRITE #1,L2%
422 FOR I=0 TO 22:WRITE #1,B$(I):WRITE #1,B%(I):NEXT I
423 FOR I=0 TO 21:WRITE #1,P$(I):WRITE #1,P%(I):NEXT I
424 FOR I=0 TO 22:FOR I1=0 TO 21:WRITE #1,B0%(I,I1):NEXT I1:NEXT I
425 FOR I=0 TO 21:FOR I1=0 TO 41:WRITE #1,P0%(I,I1):NEXT I1:NEXT I
426 WRITE #1,D0%:WRITE #1,D1%
    FOR I=0 TO 21:WRITE #1,T(I):NEXT I
    FOR I=0 TO 22:WRITE #1,T1(I):NEXT I
460 CLOSE #1
    OPEN PC$+"\"+Z$+"R" FOR OUTPUT AS #1
    FOR I=0 TO 22
    FOR I1=0 TO 6
    WRITE #1, S0%(I,I1)
    NEXT:NEXT
    CLOSE 1
495 GOTO 800
700 FOR K = 1 TO YR%
701 Y%=Y%+1
705 H%(Y%)=HR%(K)
710 H$(Y%)=HR$(K)
715 V%(Y%)=VR%(K)
720 PL$(Y%)=PLR$(K)
725 W$(Y%)=WR$(K)
730 L$(Y%)=LR$(K)
735 I%(Y%)=IR%(K)
750 NEXT
790 GOTO 319
800 OPEN PC$+"\"+Z$+"S" FOR OUTPUT AS #1
804 WRITE #1,Y%
805 FOR I=1 TO 162:WRITE #1,H%(I):NEXT I
806 FOR I=1 TO 162:WRITE #1,H$(I):NEXT I
807 FOR I=1 TO 162:WRITE #1,V%(I):NEXT I
808 FOR I=1 TO 162:WRITE #1,PL$(I):NEXT I
809 FOR I=1 TO 162:WRITE #1,W$(I):NEXT I
810 FOR I=1 TO 162:WRITE #1,L$(I):NEXT I
811 FOR I=1 TO 162:WRITE #1,I%(I):NEXT I
812 CLOSE #1
850 Y=0
860 LOCATE 20,20:COLOR 12:PRINT "RESULTS SUCCESSFULLY MERGED!!"
861 FOR J = 1 TO 5000:NEXT J
875 GOTO 4
900 CLS
    LOCATE 2,10
    COLOR 7
    PRINT"NON-EXISTANT PATH OR INCORRECT FILE NAME"
951 PRINT
    LOCATE ,10
    PRINT "TRY AGAIN (YN) ";
952 I$=INKEY$:IF I$="" THEN 952
    IF UCASE$(I$)<>"Y" THEN 990
    PRINT "HIT ENTER TO RE-ENTER INFORMATION"
955 I$=INKEY$:IF I$="" THEN 955
     GOTO 12
910 IF DRIVE>=67 THEN RETURN
    CLS
    PRINT "MAKE SURE PROGRAM DISK #6 IS IN DRIVE":LOCATE 23,1
    PRINT "PRESS ANY KEY TO CONTINUE";
915 I$=INKEY$:IF I$="" THEN 915
    RETURN
990 IF DRIVE >=67 THEN 996
    CLS
    PRINT "MAKE SURE GAME DISK IS IN DRIVE"
    LOCATE 23,1
991 PRINT "PRESS ANY KEY TO CONTINUE";
995 I$=INKEY$:IF I$="" THEN 995
996 COLOR 15:RUN "HELLO.EXE"
1000 LOCATE 21,5:COLOR 3:PRINT"MAKE SURE ROAD STATS ARE IN DRIVE ";:COLOR 14:PRINT PR$
1001 COLOR 3:LOCATE 23,5:LINE INPUT "HIT ENTER TO CONTINUE ......";DUMMY$
1002 FOR J = 21 TO 23
1003 LOCATE J
1004 PRINT"                                                                "
1005 NEXT
1006 RETURN
1100 LOCATE 21,5:COLOR 3:PRINT"MAKE SURE CURRENT STATS ARE IN DRIVE ";:COLOR 14:PRINT PC$
1101 COLOR 3:LOCATE 23,5:LINE INPUT "HIT ENTER TO CONTINUE ......";DUMMY$
1102 FOR J = 21 TO 23
1103 LOCATE J
1104 PRINT"                                                                "
1105 NEXT
1106 RETURN
1200 SEQ=0
1201 FOR K = 0 TO 22
1202 IF UCASE$(BR$(K))=UCASE$(B$(K)) THEN 1220 ELSE 1210
1210 SEQ=SEQ + 1
1220 NEXT
1230 FOR K = 0 TO 21
1231 IF UCASE$(PR$(K))=UCASE$(P$(K)) THEN 1250 ELSE 1240
1240 SEQ=SEQ+1
1250 NEXT
1260 IF SEQ = 0 THEN 700 ELSE 1270
1270 CLS:COLOR 14:LOCATE 5,27:PRINT"PLAYERS NOT IN SEQUENCE !!";DUMMY$
1275 COLOR 15:LOCATE 7,20:PRINT"STATS WILL BE DISTORTED UNLESS THE ROAD"
1276 LOCATE ,19:PRINT"FILE LISTS THE PLAYERS IN THE SAME SEQUENCE"
1277 LOCATE ,24:PRINT"AS YOUR CURRENT PLAYER STAT FILE."
1278 LOCATE 11,24:COLOR 12:PRINT"YOU MUST REALIGN ROAD STAT FILE OR"
1279 LOCATE ,31:PRINT"ENTER STATS MANUALLY."
1280 LOCATE 15,29:COLOR 13:LINE INPUT"HIT ENTER TO GO TO MENU";DUMMY$
1290 GOTO 5
